var Qs=Object.defineProperty;var Kr=r=>{throw TypeError(r)};var Hs=(r,e,t)=>e in r?Qs(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var J=(r,e,t)=>Hs(r,typeof e!="symbol"?e+"":e,t),Ws=(r,e,t)=>e.has(r)||Kr("Cannot "+t);var Nr=(r,e,t)=>e.has(r)?Kr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);var Jt=(r,e,t)=>(Ws(r,e,"access private method"),t);import{w as es,d as An,g as Ye,n as Vs,S as fe,i as he,s as de,a as I,t as A,b as P,c as se,e as le,f as T,h as Ie,j as Le,L as Gs,k as z,m as U,l as Q,o as yr,u as _r,p as wr,q as vr,r as y,v as ee,x as v,y as b,z as R,A as H,B as G,C as K,D as Xe,E as St,F as W,G as Ke,H as ve,I as rt,J as Zs,K as bn,M as ts,N as ns,O as qr,P as yn,Q as Mr,R as zr,T as rs,U as Ys,V as Ur,W as Qr,X as Hr,Y as Wr,Z as Xt}from"./vendor-D28fRZfs.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();function Js(){const{subscribe:r,set:e,update:t}=es(JSON.parse(localStorage.getItem("user")||"null"));return{subscribe:r,user:{subscribe:r},isAuthenticated:An({subscribe:r},n=>!!n),login:async n=>{const i={id:`user-${n}`,slug:n,title:n};e(i),localStorage.setItem("user",JSON.stringify(i))},logout:()=>{e(null),localStorage.removeItem("user")}}}const xt=Js(),st={appTitle:"Social Appliance",header:{enabled:!0,links:[{label:"Home",href:"/"},{label:"Admin",href:"/admin"},{label:"Login",href:"/login"}],customHtml:null,className:"border-b border-white/20 mb-8 pb-4"},api:{baseUrl:"/api",serverless:!1,enableCache:!1,cacheDuration:5*60*1e3,loadStaticData:!0,flushCacheOnStartup:!1,serverRetryInterval:3e4},features:{authentication:!0,allowCreate:!0,allowEdit:!0,allowDelete:!0},routing:{mode:"query",basePath:""},methods:{onInit:()=>{},renderHeader:()=>null}},mt=window.APP_CONFIG||st,Qn={...st,...mt,header:{...st.header,...mt.header},api:{...st.api,...mt.api},features:{...st.features,...mt.features},routing:{...st.routing,...mt.routing},methods:{...st.methods,...mt.methods}},De=es(Qn),Xs=An(De,r=>r.header),Tt=An(De,r=>r.api);An(De,r=>r.features);var Xi;(Xi=Qn.methods)!=null&&Xi.onInit&&Qn.methods.onInit();function _n(r){const e=Ye(De).routing;if(e.mode==="query"){const t=e.basePath||"";if(r==="/"){const n=t+"/";window.history.pushState({},"",n)}else{const n=t+"/?path="+r;window.history.pushState({},"",n)}window.dispatchEvent(new CustomEvent("navigate",{detail:{path:r}})),window.dispatchEvent(new PopStateEvent("popstate"))}else Vs(e.basePath+r)}function Vr(r){const e=Ye(De).routing;return e.mode==="query"?r==="/"?e.basePath+"/":`${e.basePath}/?path=${r}`:e.basePath+r}function Gr(){const r=Ye(De).routing;if(r.mode==="query"){const t=new URLSearchParams(window.location.search).get("path");if(t)return t;const n=window.location.pathname;return n!=="/"&&n!=="/index.html"?`__INVALID__${n}`:"/"}else{const e=window.location.pathname,t=r.basePath;return t&&e.startsWith(t)?e.slice(t.length)||"/":e}}function el(r){let e,t,n,i,l;const s=r[5].default,a=yr(s,r,r[6],null);return{c(){e=v("a"),a&&a.c(),y(e,"href",t=Vr(r[0])),y(e,"class",r[1])},m(o,c){T(o,e,c),a&&a.m(e,null),n=!0,i||(l=ee(e,"click",r[3]),i=!0)},p(o,c){a&&a.p&&(!n||c&64)&&_r(a,s,o,o[6],n?vr(s,o[6],c,null):wr(o[6]),null),(!n||c&1&&t!==(t=Vr(o[0])))&&y(e,"href",t),(!n||c&2)&&y(e,"class",o[1])},i(o){n||(P(a,o),n=!0)},o(o){A(a,o),n=!1},d(o){o&&I(e),a&&a.d(o),i=!1,l()}}}function tl(r){let e,t;return e=new Gs({props:{to:r[0],class:r[1],$$slots:{default:[nl]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1&&(l.to=n[0]),i&2&&(l.class=n[1]),i&64&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function nl(r){let e;const t=r[5].default,n=yr(t,r,r[6],null);return{c(){n&&n.c()},m(i,l){n&&n.m(i,l),e=!0},p(i,l){n&&n.p&&(!e||l&64)&&_r(n,t,i,i[6],e?vr(t,i[6],l,null):wr(i[6]),null)},i(i){e||(P(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function rl(r){let e,t,n,i;const l=[tl,el],s=[];function a(o,c){return o[2]==="path"?0:1}return e=a(r),t=s[e]=l[e](r),{c(){t.c(),n=Ie()},m(o,c){s[e].m(o,c),T(o,n,c),i=!0},p(o,[c]){let u=e;e=a(o),e===u?s[e].p(o,c):(se(),A(s[u],1,1,()=>{s[u]=null}),le(),t=s[e],t?t.p(o,c):(t=s[e]=l[e](o),t.c()),P(t,1),t.m(n.parentNode,n))},i(o){i||(P(t),i=!0)},o(o){A(t),i=!1},d(o){o&&I(n),s[e].d(o)}}}function il(r,e,t){let n,i;Le(r,De,u=>t(4,i=u));let{$$slots:l={},$$scope:s}=e,{to:a}=e,{className:o=""}=e;function c(u){u.preventDefault(),_n(a)}return r.$$set=u=>{"to"in u&&t(0,a=u.to),"className"in u&&t(1,o=u.className),"$$scope"in u&&t(6,s=u.$$scope)},r.$$.update=()=>{r.$$.dirty&16&&t(2,n=i.routing.mode)},[a,o,n,c,i,l,s]}class Re extends fe{constructor(e){super(),he(this,e,il,rl,de,{to:0,className:1})}}function Zr(r){let e,t,n,i;const l=[ll,sl],s=[];function a(o,c){return o[1]?0:1}return e=a(r),t=s[e]=l[e](r),{c(){t.c(),n=Ie()},m(o,c){s[e].m(o,c),T(o,n,c),i=!0},p(o,c){let u=e;e=a(o),e===u?s[e].p(o,c):(se(),A(s[u],1,1,()=>{s[u]=null}),le(),t=s[e],t?t.p(o,c):(t=s[e]=l[e](o),t.c()),P(t,1),t.m(n.parentNode,n))},i(o){i||(P(t),i=!0)},o(o){A(t),i=!1},d(o){o&&I(n),s[e].d(o)}}}function sl(r){let e,t,n,i,l,s,a,o,c,u;n=new Re({props:{to:"/",className:"text-xs uppercase tracking-wider hover:underline",$$slots:{default:[ol]},$$scope:{ctx:r}}});const f=[ul,al],h=[];function d(p,m){return p[0].features.authentication&&p[3]?0:p[0].features.authentication?1:-1}return~(s=d(r))&&(a=h[s]=f[s](r)),{c(){e=v("header"),t=v("div"),Q(n.$$.fragment),i=R(),l=v("nav"),a&&a.c(),o=R(),c=v("span"),c.textContent=`${r[4]}`,y(c,"class","text-white/40 text-xs"),y(l,"class","flex items-center gap-4 text-xs"),y(t,"class","max-w-6xl mx-auto flex items-center justify-between"),y(e,"class","border-b border-white/20 px-4 py-2")},m(p,m){T(p,e,m),b(e,t),U(n,t,null),b(t,i),b(t,l),~s&&h[s].m(l,null),b(l,o),b(l,c),u=!0},p(p,m){const _={};m&129&&(_.$$scope={dirty:m,ctx:p}),n.$set(_);let g=s;s=d(p),s===g?~s&&h[s].p(p,m):(a&&(se(),A(h[g],1,1,()=>{h[g]=null}),le()),~s?(a=h[s],a?a.p(p,m):(a=h[s]=f[s](p),a.c()),P(a,1),a.m(l,o)):a=null)},i(p){u||(P(n.$$.fragment,p),P(a),u=!0)},o(p){A(n.$$.fragment,p),A(a),u=!1},d(p){p&&I(e),z(n),~s&&h[s].d()}}}function ll(r){let e,t,n;return{c(){e=v("header"),t=v("div"),y(t,"class","max-w-6xl mx-auto px-4 py-2"),y(e,"class",n=r[2].className)},m(i,l){T(i,e,l),b(e,t),t.innerHTML=r[1]},p(i,l){l&2&&(t.innerHTML=i[1]),l&4&&n!==(n=i[2].className)&&y(e,"class",n)},i:H,o:H,d(i){i&&I(e)}}}function ol(r){let e=r[0].appTitle+"",t;return{c(){t=K(e)},m(n,i){T(n,t,i)},p(n,i){i&1&&e!==(e=n[0].appTitle+"")&&G(t,e)},d(n){n&&I(t)}}}function al(r){let e,t;return e=new Re({props:{to:"/login",className:"hover:underline",$$slots:{default:[cl]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&128&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function ul(r){let e,t,n,i,l=r[3].slug+"",s,a,o,c,u,f,h;return e=new Re({props:{to:"/admin",className:"hover:underline",$$slots:{default:[fl]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment),t=R(),n=v("span"),i=K("["),s=K(l),a=K("]"),o=R(),c=v("button"),c.textContent="logout",y(n,"class","text-white/60"),y(c,"class","hover:underline")},m(d,p){U(e,d,p),T(d,t,p),T(d,n,p),b(n,i),b(n,s),b(n,a),T(d,o,p),T(d,c,p),u=!0,f||(h=ee(c,"click",r[5]),f=!0)},p(d,p){const m={};p&128&&(m.$$scope={dirty:p,ctx:d}),e.$set(m),(!u||p&8)&&l!==(l=d[3].slug+"")&&G(s,l)},i(d){u||(P(e.$$.fragment,d),u=!0)},o(d){A(e.$$.fragment,d),u=!1},d(d){d&&(I(t),I(n),I(o),I(c)),z(e,d),f=!1,h()}}}function cl(r){let e;return{c(){e=K("login")},m(t,n){T(t,e,n)},d(t){t&&I(e)}}}function fl(r){let e;return{c(){e=K("admin")},m(t,n){T(t,e,n)},d(t){t&&I(e)}}}function hl(r){let e,t,n,i,l,s=r[2].enabled&&Zr(r);const a=r[6].default,o=yr(a,r,r[7],null);return{c(){e=v("div"),s&&s.c(),t=R(),n=v("main"),i=v("div"),o&&o.c(),y(i,"class","max-w-6xl mx-auto"),y(n,"class","flex-1 px-4 py-8"),y(e,"class","min-h-screen flex flex-col")},m(c,u){T(c,e,u),s&&s.m(e,null),b(e,t),b(e,n),b(n,i),o&&o.m(i,null),l=!0},p(c,[u]){c[2].enabled?s?(s.p(c,u),u&4&&P(s,1)):(s=Zr(c),s.c(),P(s,1),s.m(e,t)):s&&(se(),A(s,1,1,()=>{s=null}),le()),o&&o.p&&(!l||u&128)&&_r(o,a,c,c[7],l?vr(a,c[7],u,null):wr(c[7]),null)},i(c){l||(P(s),P(o,c),l=!0)},o(c){A(s),A(o,c),l=!1},d(c){c&&I(e),s&&s.d(),o&&o.d(c)}}}function dl(r,e,t){let n,i,l,s;Le(r,De,f=>t(0,i=f)),Le(r,Xs,f=>t(2,l=f)),Le(r,xt,f=>t(3,s=f));let{$$slots:a={},$$scope:o}=e;const c="mgbzfm89";function u(){xt.logout(),_n("/")}return r.$$set=f=>{"$$scope"in f&&t(7,o=f.$$scope)},r.$$.update=()=>{var f,h;r.$$.dirty&1&&t(1,n=(h=(f=i.methods)==null?void 0:f.renderHeader)==null?void 0:h.call(f,i))},[i,n,l,s,c,u,a,o]}class is extends fe{constructor(e){super(),he(this,e,dl,hl,de,{})}}const oe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pe=Object.keys,we=Array.isArray;function xe(r,e){return typeof e!="object"||pe(e).forEach(function(t){r[t]=e[t]}),r}typeof Promise>"u"||oe.Promise||(oe.Promise=Promise);const qt=Object.getPrototypeOf,pl={}.hasOwnProperty;function Pe(r,e){return pl.call(r,e)}function $t(r,e){typeof e=="function"&&(e=e(qt(r))),(typeof Reflect>"u"?pe:Reflect.ownKeys)(e).forEach(t=>{Qe(r,t,e[t])})}const ss=Object.defineProperty;function Qe(r,e,t,n){ss(r,e,xe(t&&Pe(t,"get")&&typeof t.get=="function"?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},n))}function wt(r){return{from:function(e){return r.prototype=Object.create(e.prototype),Qe(r.prototype,"constructor",r),{extend:$t.bind(null,r.prototype)}}}}const gl=Object.getOwnPropertyDescriptor;function kr(r,e){let t;return gl(r,e)||(t=qt(r))&&kr(t,e)}const ml=[].slice;function wn(r,e,t){return ml.call(r,e,t)}function ls(r,e){return e(r)}function Dt(r){if(!r)throw new Error("Assertion Failed")}function os(r){oe.setImmediate?setImmediate(r):setTimeout(r,0)}function as(r,e){return r.reduce((t,n,i)=>{var l=e(n,i);return l&&(t[l[0]]=l[1]),t},{})}function He(r,e){if(typeof e=="string"&&Pe(r,e))return r[e];if(!e)return r;if(typeof e!="string"){for(var t=[],n=0,i=e.length;n<i;++n){var l=He(r,e[n]);t.push(l)}return t}var s=e.indexOf(".");if(s!==-1){var a=r[e.substr(0,s)];return a==null?void 0:He(a,e.substr(s+1))}}function Ae(r,e,t){if(r&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(r)))if(typeof e!="string"&&"length"in e){Dt(typeof t!="string"&&"length"in t);for(var n=0,i=e.length;n<i;++n)Ae(r,e[n],t[n])}else{var l=e.indexOf(".");if(l!==-1){var s=e.substr(0,l),a=e.substr(l+1);if(a==="")t===void 0?we(r)&&!isNaN(parseInt(s))?r.splice(s,1):delete r[s]:r[s]=t;else{var o=r[s];o&&Pe(r,s)||(o=r[s]={}),Ae(o,a,t)}}else t===void 0?we(r)&&!isNaN(parseInt(e))?r.splice(e,1):delete r[e]:r[e]=t}}function us(r){var e={};for(var t in r)Pe(r,t)&&(e[t]=r[t]);return e}const bl=[].concat;function cs(r){return bl.apply([],r)}const fs="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(cs([8,16,32,64].map(r=>["Int","Uint","Float"].map(e=>e+r+"Array")))).filter(r=>oe[r]),yl=fs.map(r=>oe[r]);as(fs,r=>[r,!0]);let Ze=null;function Vt(r){Ze=typeof WeakMap<"u"&&new WeakMap;const e=Hn(r);return Ze=null,e}function Hn(r){if(!r||typeof r!="object")return r;let e=Ze&&Ze.get(r);if(e)return e;if(we(r)){e=[],Ze&&Ze.set(r,e);for(var t=0,n=r.length;t<n;++t)e.push(Hn(r[t]))}else if(yl.indexOf(r.constructor)>=0)e=r;else{const l=qt(r);for(var i in e=l===Object.prototype?{}:Object.create(l),Ze&&Ze.set(r,e),r)Pe(r,i)&&(e[i]=Hn(r[i]))}return e}const{toString:_l}={};function Wn(r){return _l.call(r).slice(8,-1)}const Vn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",wl=typeof Vn=="symbol"?function(r){var e;return r!=null&&(e=r[Vn])&&e.apply(r)}:function(){return null},_t={};function ze(r){var e,t,n,i;if(arguments.length===1){if(we(r))return r.slice();if(this===_t&&typeof r=="string")return[r];if(i=wl(r)){for(t=[];!(n=i.next()).done;)t.push(n.value);return t}if(r==null)return[r];if(typeof(e=r.length)=="number"){for(t=new Array(e);e--;)t[e]=r[e];return t}return[r]}for(e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return t}const xr=typeof Symbol<"u"?r=>r[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Ne=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function hs(r,e){Ne=r,ds=e}var ds=()=>!0;const vl=!new Error("").stack;function pt(){if(vl)try{throw pt.arguments,new Error}catch(r){return r}return new Error}function Gn(r,e){var t=r.stack;return t?(e=e||0,t.indexOf(r.name)===0&&(e+=(r.name+r.message).split(`
`).length),t.split(`
`).slice(e).filter(ds).map(n=>`
`+n).join("")):""}var ps=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],$r=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ps),kl={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function vt(r,e){this._e=pt(),this.name=r,this.message=e}function gs(r,e){return r+". Errors: "+Object.keys(e).map(t=>e[t].toString()).filter((t,n,i)=>i.indexOf(t)===n).join(`
`)}function vn(r,e,t,n){this._e=pt(),this.failures=e,this.failedKeys=n,this.successCount=t,this.message=gs(r,e)}function Ot(r,e){this._e=pt(),this.name="BulkError",this.failures=Object.keys(e).map(t=>e[t]),this.failuresByPos=e,this.message=gs(r,e)}wt(vt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Gn(this._e,2))}},toString:function(){return this.name+": "+this.message}}),wt(vn).from(vt),wt(Ot).from(vt);var Er=$r.reduce((r,e)=>(r[e]=e+"Error",r),{});const xl=vt;var q=$r.reduce((r,e)=>{var t=e+"Error";function n(i,l){this._e=pt(),this.name=t,i?typeof i=="string"?(this.message=`${i}${l?`
 `+l:""}`,this.inner=l||null):typeof i=="object"&&(this.message=`${i.name} ${i.message}`,this.inner=i):(this.message=kl[e]||t,this.inner=null)}return wt(n).from(xl),r[e]=n,r},{});q.Syntax=SyntaxError,q.Type=TypeError,q.Range=RangeError;var Yr=ps.reduce((r,e)=>(r[e+"Error"]=q[e],r),{}),cn=$r.reduce((r,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(r[e+"Error"]=q[e]),r),{});function ie(){}function Mt(r){return r}function $l(r,e){return r==null||r===Mt?e:function(t){return e(r(t))}}function ct(r,e){return function(){r.apply(this,arguments),e.apply(this,arguments)}}function El(r,e){return r===ie?e:function(){var t=r.apply(this,arguments);t!==void 0&&(arguments[0]=t);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var l=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?ct(n,this.onsuccess):n),i&&(this.onerror=this.onerror?ct(i,this.onerror):i),l!==void 0?l:t}}function Sl(r,e){return r===ie?e:function(){r.apply(this,arguments);var t=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?ct(t,this.onsuccess):t),n&&(this.onerror=this.onerror?ct(n,this.onerror):n)}}function Cl(r,e){return r===ie?e:function(t){var n=r.apply(this,arguments);xe(t,n);var i=this.onsuccess,l=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ct(i,this.onsuccess):i),l&&(this.onerror=this.onerror?ct(l,this.onerror):l),n===void 0?s===void 0?void 0:s:xe(n,s)}}function Pl(r,e){return r===ie?e:function(){return e.apply(this,arguments)!==!1&&r.apply(this,arguments)}}function Sr(r,e){return r===ie?e:function(){var t=r.apply(this,arguments);if(t&&typeof t.then=="function"){for(var n=this,i=arguments.length,l=new Array(i);i--;)l[i]=arguments[i];return t.then(function(){return e.apply(n,l)})}return e.apply(this,arguments)}}cn.ModifyError=vn,cn.DexieError=vt,cn.BulkError=Ot;var zt={};const ms=100,[Zn,kn,Yn]=typeof Promise>"u"?[]:(()=>{let r=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[r,qt(r),r];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,qt(e),r]})(),bs=kn&&kn.then,fn=Zn&&Zn.constructor,Cr=!!Yn;var Jn=!1,Il=Yn?()=>{Yn.then(en)}:oe.setImmediate?setImmediate.bind(null,en):oe.MutationObserver?()=>{var r=document.createElement("div");new MutationObserver(()=>{en(),r=null}).observe(r,{attributes:!0}),r.setAttribute("i","1")}:()=>{setTimeout(en,0)},jt=function(r,e){Rt.push([r,e]),xn&&(Il(),xn=!1)},Xn=!0,xn=!0,ot=[],hn=[],er=null,tr=Mt,kt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ei,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(r=>{try{ei(r[0],r[1])}catch{}})}},N=kt,Rt=[],at=0,dn=[];function F(r){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ie,this._lib=!1;var e=this._PSD=N;if(Ne&&(this._stackHolder=pt(),this._prev=null,this._numPrev=0),typeof r!="function"){if(r!==zt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&rr(this,this._value))}this._state=null,this._value=null,++e.ref,_s(this,r)}const nr={get:function(){var r=N,e=$n;function t(n,i){var l=!r.global&&(r!==N||e!==$n);const s=l&&!We();var a=new F((o,c)=>{Pr(this,new ys(En(n,r,l,s),En(i,r,l,s),o,c,r))});return Ne&&ks(a,this),a}return t.prototype=zt,t},set:function(r){Qe(this,"then",r&&r.prototype===zt?nr:{get:function(){return r},set:nr.set})}};function ys(r,e,t,n,i){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof e=="function"?e:null,this.resolve=t,this.reject=n,this.psd=i}function _s(r,e){try{e(t=>{if(r._state===null){if(t===r)throw new TypeError("A promise cannot be resolved with itself.");var n=r._lib&&Gt();t&&typeof t.then=="function"?_s(r,(i,l)=>{t instanceof F?t._then(i,l):t.then(i,l)}):(r._state=!0,r._value=t,ws(r)),n&&Zt()}},rr.bind(null,r))}catch(t){rr(r,t)}}function rr(r,e){if(hn.push(e),r._state===null){var t=r._lib&&Gt();e=tr(e),r._state=!1,r._value=e,Ne&&e!==null&&typeof e=="object"&&!e._promise&&function(n,i,l){try{n.apply(null,l)}catch{}}(()=>{var n=kr(e,"stack");e._promise=r,Qe(e,"stack",{get:()=>Jn?n&&(n.get?n.get.apply(e):n.value):r.stack})}),function(n){ot.some(i=>i._value===n._value)||ot.push(n)}(r),ws(r),t&&Zt()}}function ws(r){var e=r._listeners;r._listeners=[];for(var t=0,n=e.length;t<n;++t)Pr(r,e[t]);var i=r._PSD;--i.ref||i.finalize(),at===0&&(++at,jt(()=>{--at==0&&Ir()},[]))}function Pr(r,e){if(r._state!==null){var t=r._state?e.onFulfilled:e.onRejected;if(t===null)return(r._state?e.resolve:e.reject)(r._value);++e.psd.ref,++at,jt(Tl,[t,r,e])}else r._listeners.push(e)}function Tl(r,e,t){try{er=e;var n,i=e._value;e._state?n=r(i):(hn.length&&(hn=[]),n=r(i),hn.indexOf(i)===-1&&function(l){for(var s=ot.length;s;)if(ot[--s]._value===l._value)return void ot.splice(s,1)}(e)),t.resolve(n)}catch(l){t.reject(l)}finally{er=null,--at==0&&Ir(),--t.psd.ref||t.psd.finalize()}}function vs(r,e,t){if(e.length===t)return e;var n="";if(r._state===!1){var i,l,s=r._value;s!=null?(i=s.name||"Error",l=s.message||s,n=Gn(s,0)):(i=s,l=""),e.push(i+(l?": "+l:"")+n)}return Ne&&((n=Gn(r._stackHolder,2))&&e.indexOf(n)===-1&&e.push(n),r._prev&&vs(r._prev,e,t)),e}function ks(r,e){var t=e?e._numPrev+1:0;t<100&&(r._prev=e,r._numPrev=t)}function en(){Gt()&&Zt()}function Gt(){var r=Xn;return Xn=!1,xn=!1,r}function Zt(){var r,e,t;do for(;Rt.length>0;)for(r=Rt,Rt=[],t=r.length,e=0;e<t;++e){var n=r[e];n[0].apply(null,n[1])}while(Rt.length>0);Xn=!0,xn=!0}function Ir(){var r=ot;ot=[],r.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var e=dn.slice(0),t=e.length;t;)e[--t]()}function tn(r){return new F(zt,!1,r)}function ue(r,e){var t=N;return function(){var n=Gt(),i=N;try{return tt(t,!0),r.apply(this,arguments)}catch(l){e&&e(l)}finally{tt(i,!1),n&&Zt()}}}$t(F.prototype,{then:nr,_then:function(r,e){Pr(this,new ys(null,null,r,e,N))},catch:function(r){if(arguments.length===1)return this.then(null,r);var e=arguments[0],t=arguments[1];return typeof e=="function"?this.then(null,n=>n instanceof e?t(n):tn(n)):this.then(null,n=>n&&n.name===e?t(n):tn(n))},finally:function(r){return this.then(e=>(r(),e),e=>(r(),tn(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Jn=!0;var r=vs(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=r),r}finally{Jn=!1}}},timeout:function(r,e){return r<1/0?new F((t,n)=>{var i=setTimeout(()=>n(new q.Timeout(e)),r);this.then(t,n).finally(clearTimeout.bind(null,i))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Qe(F.prototype,Symbol.toStringTag,"Dexie.Promise"),kt.env=xs(),$t(F,{all:function(){var r=ze.apply(null,arguments).map(nn);return new F(function(e,t){r.length===0&&e([]);var n=r.length;r.forEach((i,l)=>F.resolve(i).then(s=>{r[l]=s,--n||e(r)},t))})},resolve:r=>{if(r instanceof F)return r;if(r&&typeof r.then=="function")return new F((t,n)=>{r.then(t,n)});var e=new F(zt,!0,r);return ks(e,er),e},reject:tn,race:function(){var r=ze.apply(null,arguments).map(nn);return new F((e,t)=>{r.map(n=>F.resolve(n).then(e,t))})},PSD:{get:()=>N,set:r=>N=r},totalEchoes:{get:()=>$n},newPSD:et,usePSD:Pt,scheduler:{get:()=>jt,set:r=>{jt=r}},rejectionMapper:{get:()=>tr,set:r=>{tr=r}},follow:(r,e)=>new F((t,n)=>et((i,l)=>{var s=N;s.unhandleds=[],s.onunhandled=l,s.finalize=ct(function(){(function(a){function o(){a(),dn.splice(dn.indexOf(o),1)}dn.push(o),++at,jt(()=>{--at==0&&Ir()},[])})(()=>{this.unhandleds.length===0?i():l(this.unhandleds[0])})},s.finalize),r()},e,t,n))}),fn&&(fn.allSettled&&Qe(F,"allSettled",function(){const r=ze.apply(null,arguments).map(nn);return new F(e=>{r.length===0&&e([]);let t=r.length;const n=new Array(t);r.forEach((i,l)=>F.resolve(i).then(s=>n[l]={status:"fulfilled",value:s},s=>n[l]={status:"rejected",reason:s}).then(()=>--t||e(n)))})}),fn.any&&typeof AggregateError<"u"&&Qe(F,"any",function(){const r=ze.apply(null,arguments).map(nn);return new F((e,t)=>{r.length===0&&t(new AggregateError([]));let n=r.length;const i=new Array(n);r.forEach((l,s)=>F.resolve(l).then(a=>e(a),a=>{i[s]=a,--n||t(new AggregateError(i))}))})}));const _e={awaits:0,echoes:0,id:0};var Al=0,pn=[],Fn=0,$n=0,Dl=0;function et(r,e,t,n){var i=N,l=Object.create(i);l.parent=i,l.ref=0,l.global=!1,l.id=++Dl;var s=kt.env;l.env=Cr?{Promise:F,PromiseProp:{value:F,configurable:!0,writable:!0},all:F.all,race:F.race,allSettled:F.allSettled,any:F.any,resolve:F.resolve,reject:F.reject,nthen:Jr(s.nthen,l),gthen:Jr(s.gthen,l)}:{},e&&xe(l,e),++i.ref,l.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Pt(l,r,t,n);return l.ref===0&&l.finalize(),a}function Ct(){return _e.id||(_e.id=++Al),++_e.awaits,_e.echoes+=ms,_e.id}function We(){return!!_e.awaits&&(--_e.awaits==0&&(_e.id=0),_e.echoes=_e.awaits*ms,!0)}function nn(r){return _e.echoes&&r&&r.constructor===fn?(Ct(),r.then(e=>(We(),e),e=>(We(),ge(e)))):r}function Rl(r){++$n,_e.echoes&&--_e.echoes!=0||(_e.echoes=_e.id=0),pn.push(N),tt(r,!0)}function Ol(){var r=pn[pn.length-1];pn.pop(),tt(r,!1)}function tt(r,e){var t=N;if((e?!_e.echoes||Fn++&&r===N:!Fn||--Fn&&r===N)||$s(e?Rl.bind(null,r):Ol),r!==N&&(N=r,t===kt&&(kt.env=xs()),Cr)){var n=kt.env.Promise,i=r.env;kn.then=i.nthen,n.prototype.then=i.gthen,(t.global||r.global)&&(Object.defineProperty(oe,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function xs(){var r=oe.Promise;return Cr?{Promise:r,PromiseProp:Object.getOwnPropertyDescriptor(oe,"Promise"),all:r.all,race:r.race,allSettled:r.allSettled,any:r.any,resolve:r.resolve,reject:r.reject,nthen:kn.then,gthen:r.prototype.then}:{}}function Pt(r,e,t,n,i){var l=N;try{return tt(r,!0),e(t,n,i)}finally{tt(l,!1)}}function $s(r){bs.call(Zn,r)}function En(r,e,t,n){return typeof r!="function"?r:function(){var i=N;t&&Ct(),tt(e,!0);try{return r.apply(this,arguments)}finally{tt(i,!1),n&&$s(We)}}}function Jr(r,e){return function(t,n){return r.call(this,En(t,e),En(n,e))}}(""+bs).indexOf("[native code]")===-1&&(Ct=We=ie);const Xr="unhandledrejection";function ei(r,e){var t;try{t=e.onuncatched(r)}catch{}if(t!==!1)try{var n,i={promise:e,reason:r};if(oe.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(Xr,!0,!0),xe(n,i)):oe.CustomEvent&&xe(n=new CustomEvent(Xr,{detail:i}),i),n&&oe.dispatchEvent&&(dispatchEvent(n),!oe.PromiseRejectionEvent&&oe.onunhandledrejection))try{oe.onunhandledrejection(n)}catch{}Ne&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${r.stack||r}`)}catch{}}var ge=F.reject;function ir(r,e,t,n){if(r.idbdb&&(r._state.openComplete||N.letThrough||r._vip)){var i=r._createTransaction(e,t,r._dbSchema);try{i.create(),r._state.PR1398_maxLoop=3}catch(l){return l.name===Er.InvalidState&&r.isOpen()&&--r._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),r._close(),r.open().then(()=>ir(r,e,t,n))):ge(l)}return i._promise(e,(l,s)=>et(()=>(N.trans=i,n(l,s,i)))).then(l=>i._completion.then(()=>l))}if(r._state.openComplete)return ge(new q.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._options.autoOpen)return ge(new q.DatabaseClosed);r.open().catch(ie)}return r._state.dbReadyPromise.then(()=>ir(r,e,t,n))}const ti="3.2.7",lt="￿",sr=-1/0,qe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Es="String expected.",Ft=[],Dn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),jl=Dn,Fl=Dn,Ss=r=>!/(dexie\.js|dexie\.min\.js)/.test(r),Rn="__dbnames",Ln="readonly",Bn="readwrite";function ft(r,e){return r?e?function(){return r.apply(this,arguments)&&e.apply(this,arguments)}:r:e}const Cs={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function rn(r){return typeof r!="string"||/\./.test(r)?e=>e:e=>(e[r]===void 0&&r in e&&delete(e=Vt(e))[r],e)}class Ll{_trans(e,t,n){const i=this._tx||N.trans,l=this.name;function s(o,c,u){if(!u.schema[l])throw new q.NotFound("Table "+l+" not part of transaction");return t(u.idbtrans,u)}const a=Gt();try{return i&&i.db===this.db?i===N.trans?i._promise(e,s,n):et(()=>i._promise(e,s,n),{trans:i,transless:N.transless||N}):ir(this.db,e,[this.name],s)}finally{a&&Zt()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",n=>this.core.get({trans:n,key:e}).then(i=>this.hook.reading.fire(i))).then(t)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(we(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const t=pe(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(c=>{if(c.compound&&t.every(u=>c.keyPath.indexOf(u)>=0)){for(let u=0;u<t.length;++u)if(t.indexOf(c.keyPath[u])===-1)return!1;return!0}return!1}).sort((c,u)=>c.keyPath.length-u.keyPath.length)[0];if(n&&this.db._maxKey!==lt){const c=n.keyPath.slice(0,t.length);return this.where(c).equals(c.map(u=>e[u]))}!n&&Ne&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${t.join("+")}]`);const{idxByName:i}=this.schema,l=this.db._deps.indexedDB;function s(c,u){try{return l.cmp(c,u)===0}catch{return!1}}const[a,o]=t.reduce(([c,u],f)=>{const h=i[f],d=e[f];return[c||h,c||!h?ft(u,h&&h.multi?p=>{const m=He(p,f);return we(m)&&m.some(_=>s(d,_))}:p=>s(d,He(p,f))):u]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(o):n?this.filter(o):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,we(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const t=n=>{if(!n)return n;const i=Object.create(e.prototype);for(var l in n)if(Pe(n,l))try{i[l]=n[l]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e}defineClass(){return this.mapToClass(function(e){xe(this,e)})}add(e,t){const{auto:n,keyPath:i}=this.schema.primKey;let l=e;return i&&n&&(l=rn(i)(e)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"add",keys:t!=null?[t]:null,values:[l]})).then(s=>s.numFailures?F.reject(s.failures[0]):s.lastResult).then(s=>{if(i)try{Ae(e,i,s)}catch{}return s})}update(e,t){if(typeof e!="object"||we(e))return this.where(":id").equals(e).modify(t);{const n=He(e,this.schema.primKey.keyPath);if(n===void 0)return ge(new q.InvalidArgument("Given object does not contain its primary key"));try{typeof t!="function"?pe(t).forEach(i=>{Ae(e,i,t[i])}):t(e,{value:e,primKey:n})}catch{}return this.where(":id").equals(n).modify(t)}}put(e,t){const{auto:n,keyPath:i}=this.schema.primKey;let l=e;return i&&n&&(l=rn(i)(e)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"put",values:[l],keys:t!=null?[t]:null})).then(s=>s.numFailures?F.reject(s.failures[0]):s.lastResult).then(s=>{if(i)try{Ae(e,i,s)}catch{}return s})}delete(e){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"delete",keys:[e]})).then(t=>t.numFailures?F.reject(t.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Cs})).then(e=>e.numFailures?F.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",t=>this.core.getMany({keys:e,trans:t}).then(n=>n.map(i=>this.hook.reading.fire(i))))}bulkAdd(e,t,n){const i=Array.isArray(t)?t:void 0,l=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",s=>{const{auto:a,keyPath:o}=this.schema.primKey;if(o&&i)throw new q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=o&&a?e.map(rn(o)):e;return this.core.mutate({trans:s,type:"add",keys:i,values:u,wantResults:l}).then(({numFailures:f,results:h,lastResult:d,failures:p})=>{if(f===0)return l?h:d;throw new Ot(`${this.name}.bulkAdd(): ${f} of ${c} operations failed`,p)})})}bulkPut(e,t,n){const i=Array.isArray(t)?t:void 0,l=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",s=>{const{auto:a,keyPath:o}=this.schema.primKey;if(o&&i)throw new q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=o&&a?e.map(rn(o)):e;return this.core.mutate({trans:s,type:"put",keys:i,values:u,wantResults:l}).then(({numFailures:f,results:h,lastResult:d,failures:p})=>{if(f===0)return l?h:d;throw new Ot(`${this.name}.bulkPut(): ${f} of ${c} operations failed`,p)})})}bulkDelete(e){const t=e.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:e})).then(({numFailures:n,lastResult:i,failures:l})=>{if(n===0)return i;throw new Ot(`${this.name}.bulkDelete(): ${n} of ${t} operations failed`,l)})}}function Lt(r){var e={},t=function(s,a){if(a){for(var o=arguments.length,c=new Array(o-1);--o;)c[o-1]=arguments[o];return e[s].subscribe.apply(null,c),r}if(typeof s=="string")return e[s]};t.addEventType=l;for(var n=1,i=arguments.length;n<i;++n)l(arguments[n]);return t;function l(s,a,o){if(typeof s!="object"){var c;a||(a=Pl),o||(o=ie);var u={subscribers:[],fire:o,subscribe:function(f){u.subscribers.indexOf(f)===-1&&(u.subscribers.push(f),u.fire=a(u.fire,f))},unsubscribe:function(f){u.subscribers=u.subscribers.filter(function(h){return h!==f}),u.fire=u.subscribers.reduce(a,o)}};return e[s]=t[s]=u,u}pe(c=s).forEach(function(f){var h=c[f];if(we(h))l(f,c[f][0],c[f][1]);else{if(h!=="asap")throw new q.InvalidArgument("Invalid event config");var d=l(f,Mt,function(){for(var p=arguments.length,m=new Array(p);p--;)m[p]=arguments[p];d.subscribers.forEach(function(_){os(function(){_.apply(null,m)})})})}})}}function At(r,e){return wt(e).from({prototype:r}),e}function bt(r,e){return!(r.filter||r.algorithm||r.or)&&(e?r.justLimit:!r.replayFilter)}function Kn(r,e){r.filter=ft(r.filter,e)}function Nn(r,e,t){var n=r.replayFilter;r.replayFilter=n?()=>ft(n(),e()):e,r.justLimit=t&&!n}function gn(r,e){if(r.isPrimKey)return e.primaryKey;const t=e.getIndexByKeyPath(r.index);if(!t)throw new q.Schema("KeyPath "+r.index+" on object store "+e.name+" is not indexed");return t}function ni(r,e,t){const n=gn(r,e.schema);return e.openCursor({trans:t,values:!r.keysOnly,reverse:r.dir==="prev",unique:!!r.unique,query:{index:n,range:r.range}})}function sn(r,e,t,n){const i=r.replayFilter?ft(r.filter,r.replayFilter()):r.filter;if(r.or){const l={},s=(a,o,c)=>{if(!i||i(o,c,h=>o.stop(h),h=>o.fail(h))){var u=o.primaryKey,f=""+u;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(u)),Pe(l,f)||(l[f]=!0,e(a,o,c))}};return Promise.all([r.or._iterate(s,t),ri(ni(r,n,t),r.algorithm,s,!r.keysOnly&&r.valueMapper)])}return ri(ni(r,n,t),ft(r.algorithm,i),e,!r.keysOnly&&r.valueMapper)}function ri(r,e,t,n){var i=ue(n?(l,s,a)=>t(n(l),s,a):t);return r.then(l=>{if(l)return l.start(()=>{var s=()=>l.continue();e&&!e(l,a=>s=a,a=>{l.stop(a),s=ie},a=>{l.fail(a),s=ie})||i(l.value,l,a=>s=a),s()})})}function ke(r,e){try{const t=ii(r),n=ii(e);if(t!==n)return t==="Array"?1:n==="Array"?-1:t==="binary"?1:n==="binary"?-1:t==="string"?1:n==="string"?-1:t==="Date"?1:n!=="Date"?NaN:-1;switch(t){case"number":case"Date":case"string":return r>e?1:r<e?-1:0;case"binary":return function(i,l){const s=i.length,a=l.length,o=s<a?s:a;for(let c=0;c<o;++c)if(i[c]!==l[c])return i[c]<l[c]?-1:1;return s===a?0:s<a?-1:1}(si(r),si(e));case"Array":return function(i,l){const s=i.length,a=l.length,o=s<a?s:a;for(let c=0;c<o;++c){const u=ke(i[c],l[c]);if(u!==0)return u}return s===a?0:s<a?-1:1}(r,e)}}catch{}return NaN}function ii(r){const e=typeof r;if(e!=="object")return e;if(ArrayBuffer.isView(r))return"binary";const t=Wn(r);return t==="ArrayBuffer"?"binary":t}function si(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r)}class Bl{_read(e,t){var n=this._ctx;return n.error?n.table._trans(null,ge.bind(null,n.error)):n.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,ge.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=ft(t.algorithm,e)}_iterate(e,t){return sn(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&xe(n,e),t._ctx=n,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read(n=>sn(t,e,n,t.table.core))}count(e){return this._read(t=>{const n=this._ctx,i=n.table.core;if(bt(n,!0))return i.count({trans:t,query:{index:gn(n,i.schema),range:n.range}}).then(s=>Math.min(s,n.limit));var l=0;return sn(n,()=>(++l,!1),t,i).then(()=>l)}).then(e)}sortBy(e,t){const n=e.split(".").reverse(),i=n[0],l=n.length-1;function s(c,u){return u?s(c[n[u]],u-1):c[i]}var a=this._ctx.dir==="next"?1:-1;function o(c,u){var f=s(c,l),h=s(u,l);return f<h?-a:f>h?a:0}return this.toArray(function(c){return c.sort(o)}).then(t)}toArray(e){return this._read(t=>{var n=this._ctx;if(n.dir==="next"&&bt(n,!0)&&n.limit>0){const{valueMapper:i}=n,l=gn(n,n.table.core.schema);return n.table.core.query({trans:t,limit:n.limit,values:!0,query:{index:l,range:n.range}}).then(({result:s})=>i?s.map(i):s)}{const i=[];return sn(n,l=>i.push(l),t,n.table.core).then(()=>i)}},e)}offset(e){var t=this._ctx;return e<=0||(t.offset+=e,bt(t)?Nn(t,()=>{var n=e;return(i,l)=>n===0||(n===1?(--n,!1):(l(()=>{i.advance(n),n=0}),!1))}):Nn(t,()=>{var n=e;return()=>--n<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Nn(this._ctx,()=>{var t=e;return function(n,i,l){return--t<=0&&i(l),t>=0}},!0),this}until(e,t){return Kn(this._ctx,function(n,i,l){return!e(n.value)||(i(l),t)}),this}first(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var t,n;return Kn(this._ctx,function(i){return e(i.value)}),t=this._ctx,n=e,t.isMatch=ft(t.isMatch,n),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.key,i)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.primaryKey,i)})}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,l){n.push(l.key)}).then(function(){return n}).then(e)}primaryKeys(e){var t=this._ctx;if(t.dir==="next"&&bt(t,!0)&&t.limit>0)return this._read(i=>{var l=gn(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:l,range:t.range}})}).then(({result:i})=>i).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,l){n.push(l.primaryKey)}).then(function(){return n}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(t){return t[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Kn(this._ctx,function(i){var l=i.primaryKey.toString(),s=Pe(n,l);return n[l]=!0,!s}),this}modify(e){var t=this._ctx;return this._write(n=>{var i;if(typeof e=="function")i=e;else{var l=pe(e),s=l.length;i=function(m){for(var _=!1,g=0;g<s;++g){var w=l[g],x=e[w];He(m,w)!==x&&(Ae(m,w,x),_=!0)}return _}}const a=t.table.core,{outbound:o,extractKey:c}=a.schema.primaryKey,u=this.db._options.modifyChunkSize||200,f=[];let h=0;const d=[],p=(m,_)=>{const{failures:g,numFailures:w}=_;h+=m-w;for(let x of pe(g))f.push(g[x])};return this.clone().primaryKeys().then(m=>{const _=g=>{const w=Math.min(u,m.length-g);return a.getMany({trans:n,keys:m.slice(g,g+w),cache:"immutable"}).then(x=>{const k=[],$=[],C=o?[]:null,E=[];for(let S=0;S<w;++S){const L=x[S],O={value:Vt(L),primKey:m[g+S]};i.call(O,O.value,O)!==!1&&(O.value==null?E.push(m[g+S]):o||ke(c(L),c(O.value))===0?($.push(O.value),o&&C.push(m[g+S])):(E.push(m[g+S]),k.push(O.value)))}const D=bt(t)&&t.limit===1/0&&(typeof e!="function"||e===qn)&&{index:t.index,range:t.range};return Promise.resolve(k.length>0&&a.mutate({trans:n,type:"add",values:k}).then(S=>{for(let L in S.failures)E.splice(parseInt(L),1);p(k.length,S)})).then(()=>($.length>0||D&&typeof e=="object")&&a.mutate({trans:n,type:"put",keys:C,values:$,criteria:D,changeSpec:typeof e!="function"&&e}).then(S=>p($.length,S))).then(()=>(E.length>0||D&&e===qn)&&a.mutate({trans:n,type:"delete",keys:E,criteria:D}).then(S=>p(E.length,S))).then(()=>m.length>g+w&&_(g+u))})};return _(0).then(()=>{if(f.length>0)throw new vn("Error modifying one or more objects",f,h,d);return m.length})})})}delete(){var e=this._ctx,t=e.range;return bt(e)&&(e.isPrimKey&&!Fl||t.type===3)?this._write(n=>{const{primaryKey:i}=e.table.core.schema,l=t;return e.table.core.count({trans:n,query:{index:i,range:l}}).then(s=>e.table.core.mutate({trans:n,type:"deleteRange",range:l}).then(({failures:a,lastResult:o,results:c,numFailures:u})=>{if(u)throw new vn("Could not delete some values",Object.keys(a).map(f=>a[f]),s-u);return s-u}))}):this.modify(qn)}}const qn=(r,e)=>e.value=null;function Kl(r,e){return r<e?-1:r===e?0:1}function Nl(r,e){return r>e?-1:r===e?0:1}function Se(r,e,t){var n=r instanceof Is?new r.Collection(r):r;return n._ctx.error=t?new t(e):new TypeError(e),n}function yt(r){return new r.Collection(r,()=>Ps("")).limit(0)}function ql(r,e,t,n,i,l){for(var s=Math.min(r.length,n.length),a=-1,o=0;o<s;++o){var c=e[o];if(c!==n[o])return i(r[o],t[o])<0?r.substr(0,o)+t[o]+t.substr(o+1):i(r[o],n[o])<0?r.substr(0,o)+n[o]+t.substr(o+1):a>=0?r.substr(0,a)+e[a]+t.substr(a+1):null;i(r[o],c)<0&&(a=o)}return s<n.length&&l==="next"?r+t.substr(r.length):s<r.length&&l==="prev"?r.substr(0,t.length):a<0?null:r.substr(0,a)+n[a]+t.substr(a+1)}function ln(r,e,t,n){var i,l,s,a,o,c,u,f=t.length;if(!t.every(m=>typeof m=="string"))return Se(r,Es);function h(m){i=function(g){return g==="next"?w=>w.toUpperCase():w=>w.toLowerCase()}(m),l=function(g){return g==="next"?w=>w.toLowerCase():w=>w.toUpperCase()}(m),s=m==="next"?Kl:Nl;var _=t.map(function(g){return{lower:l(g),upper:i(g)}}).sort(function(g,w){return s(g.lower,w.lower)});a=_.map(function(g){return g.upper}),o=_.map(function(g){return g.lower}),c=m,u=m==="next"?"":n}h("next");var d=new r.Collection(r,()=>Ge(a[0],o[f-1]+n));d._ondirectionchange=function(m){h(m)};var p=0;return d._addAlgorithm(function(m,_,g){var w=m.key;if(typeof w!="string")return!1;var x=l(w);if(e(x,o,p))return!0;for(var k=null,$=p;$<f;++$){var C=ql(w,x,a[$],o[$],s,c);C===null&&k===null?p=$+1:(k===null||s(k,C)>0)&&(k=C)}return _(k!==null?function(){m.continue(k+u)}:g),!1}),d}function Ge(r,e,t,n){return{type:2,lower:r,upper:e,lowerOpen:t,upperOpen:n}}function Ps(r){return{type:1,lower:r,upper:r}}class Is{get Collection(){return this._ctx.table.db.Collection}between(e,t,n,i){n=n!==!1,i=i===!0;try{return this._cmp(e,t)>0||this._cmp(e,t)===0&&(n||i)&&(!n||!i)?yt(this):new this.Collection(this,()=>Ge(e,t,!n,!i))}catch{return Se(this,qe)}}equals(e){return e==null?Se(this,qe):new this.Collection(this,()=>Ps(e))}above(e){return e==null?Se(this,qe):new this.Collection(this,()=>Ge(e,void 0,!0))}aboveOrEqual(e){return e==null?Se(this,qe):new this.Collection(this,()=>Ge(e,void 0,!1))}below(e){return e==null?Se(this,qe):new this.Collection(this,()=>Ge(void 0,e,!1,!0))}belowOrEqual(e){return e==null?Se(this,qe):new this.Collection(this,()=>Ge(void 0,e))}startsWith(e){return typeof e!="string"?Se(this,Es):this.between(e,e+lt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):ln(this,(t,n)=>t.indexOf(n[0])===0,[e],lt)}equalsIgnoreCase(e){return ln(this,(t,n)=>t===n[0],[e],"")}anyOfIgnoreCase(){var e=ze.apply(_t,arguments);return e.length===0?yt(this):ln(this,(t,n)=>n.indexOf(t)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=ze.apply(_t,arguments);return e.length===0?yt(this):ln(this,(t,n)=>n.some(i=>t.indexOf(i)===0),e,lt)}anyOf(){const e=ze.apply(_t,arguments);let t=this._cmp;try{e.sort(t)}catch{return Se(this,qe)}if(e.length===0)return yt(this);const n=new this.Collection(this,()=>Ge(e[0],e[e.length-1]));n._ondirectionchange=l=>{t=l==="next"?this._ascending:this._descending,e.sort(t)};let i=0;return n._addAlgorithm((l,s,a)=>{const o=l.key;for(;t(o,e[i])>0;)if(++i,i===e.length)return s(a),!1;return t(o,e[i])===0||(s(()=>{l.continue(e[i])}),!1)}),n}notEqual(e){return this.inAnyRange([[sr,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=ze.apply(_t,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Se(this,qe)}const t=e.reduce((n,i)=>n?n.concat([[n[n.length-1][1],i]]):[[sr,i]],null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){const n=this._cmp,i=this._ascending,l=this._descending,s=this._min,a=this._max;if(e.length===0)return yt(this);if(!e.every(w=>w[0]!==void 0&&w[1]!==void 0&&i(w[0],w[1])<=0))return Se(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",q.InvalidArgument);const o=!t||t.includeLowers!==!1,c=t&&t.includeUppers===!0;let u,f=i;function h(w,x){return f(w[0],x[0])}try{u=e.reduce(function(w,x){let k=0,$=w.length;for(;k<$;++k){const C=w[k];if(n(x[0],C[1])<0&&n(x[1],C[0])>0){C[0]=s(C[0],x[0]),C[1]=a(C[1],x[1]);break}}return k===$&&w.push(x),w},[]),u.sort(h)}catch{return Se(this,qe)}let d=0;const p=c?w=>i(w,u[d][1])>0:w=>i(w,u[d][1])>=0,m=o?w=>l(w,u[d][0])>0:w=>l(w,u[d][0])>=0;let _=p;const g=new this.Collection(this,()=>Ge(u[0][0],u[u.length-1][1],!o,!c));return g._ondirectionchange=w=>{w==="next"?(_=p,f=i):(_=m,f=l),u.sort(h)},g._addAlgorithm((w,x,k)=>{for(var $=w.key;_($);)if(++d,d===u.length)return x(k),!1;return!!function(C){return!p(C)&&!m(C)}($)||(this._cmp($,u[d][1])===0||this._cmp($,u[d][0])===0||x(()=>{f===i?w.continue(u[d][0]):w.continue(u[d][1])}),!1)}),g}startsWithAnyOf(){const e=ze.apply(_t,arguments);return e.every(t=>typeof t=="string")?e.length===0?yt(this):this.inAnyRange(e.map(t=>[t,t+lt])):Se(this,"startsWithAnyOf() only works with strings")}}function Oe(r){return ue(function(e){return Ut(e),r(e.target.error),!1})}function Ut(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault()}const Qt="storagemutated",Je="x-storagemutated-1",nt=Lt(null,Qt);class Ml{_lock(){return Dt(!N.global),++this._reculock,this._reculock!==1||N.global||(N.lockOwnerFor=this),this}_unlock(){if(Dt(!N.global),--this._reculock==0)for(N.global||(N.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Pt(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&N.lockOwnerFor!==this}create(e){if(!this.mode)return this;const t=this.db.idbdb,n=this.db._state.dbOpenError;if(Dt(!this.idbtrans),!e&&!t)switch(n&&n.name){case"DatabaseClosedError":throw new q.DatabaseClosed(n);case"MissingAPIError":throw new q.MissingAPI(n.message,n);default:throw new q.OpenFailed(n)}if(!this.active)throw new q.TransactionInactive;return Dt(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=ue(i=>{Ut(i),this._reject(e.error)}),e.onabort=ue(i=>{Ut(i),this.active&&this._reject(new q.Abort(e.error)),this.active=!1,this.on("abort").fire(i)}),e.oncomplete=ue(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&nt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,t,n){if(e==="readwrite"&&this.mode!=="readwrite")return ge(new q.ReadOnly("Transaction is readonly"));if(!this.active)return ge(new q.TransactionInactive);if(this._locked())return new F((l,s)=>{this._blockedFuncs.push([()=>{this._promise(e,t,n).then(l,s)},N])});if(n)return et(()=>{var l=new F((s,a)=>{this._lock();const o=t(s,a,this);o&&o.then&&o.then(s,a)});return l.finally(()=>this._unlock()),l._lib=!0,l});var i=new F((l,s)=>{var a=t(l,s,this);a&&a.then&&a.then(l,s)});return i._lib=!0,i}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();const n=F.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then(()=>n);else{t._waitingFor=n,t._waitingQueue=[];var i=t.idbtrans.objectStore(t.storeNames[0]);(function s(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(i.get(-1/0).onsuccess=s)})()}var l=t._waitingFor;return new F((s,a)=>{n.then(o=>t._waitingQueue.push(ue(s.bind(null,o))),o=>t._waitingQueue.push(ue(a.bind(null,o)))).finally(()=>{t._waitingFor===l&&(t._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new q.Abort))}table(e){const t=this._memoizedTables||(this._memoizedTables={});if(Pe(t,e))return t[e];const n=this.schema[e];if(!n)throw new q.NotFound("Table "+e+" not part of transaction");const i=new this.db.Table(e,n,this);return i.core=this.db.core.table(e),t[e]=i,i}}function lr(r,e,t,n,i,l,s){return{name:r,keyPath:e,unique:t,multi:n,auto:i,compound:l,src:(t&&!s?"&":"")+(n?"*":"")+(i?"++":"")+Ts(e)}}function Ts(r){return typeof r=="string"?r:r?"["+[].join.call(r,"+")+"]":""}function As(r,e,t){return{name:r,primKey:e,indexes:t,mappedClass:null,idxByName:as(t,n=>[n.name,n])}}let Ht=r=>{try{return r.only([[]]),Ht=()=>[[]],[[]]}catch{return Ht=()=>lt,lt}};function or(r){return r==null?()=>{}:typeof r=="string"?function(e){return e.split(".").length===1?n=>n[e]:n=>He(n,e)}(r):e=>He(e,r)}function li(r){return[].slice.call(r)}let zl=0;function Bt(r){return r==null?":id":typeof r=="string"?r:`[${r.join("+")}]`}function Ul(r,e,t){function n(o){if(o.type===3)return null;if(o.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:c,upper:u,lowerOpen:f,upperOpen:h}=o;return c===void 0?u===void 0?null:e.upperBound(u,!!h):u===void 0?e.lowerBound(c,!!f):e.bound(c,u,!!f,!!h)}const{schema:i,hasGetAll:l}=function(o,c){const u=li(o.objectStoreNames);return{schema:{name:o.name,tables:u.map(f=>c.objectStore(f)).map(f=>{const{keyPath:h,autoIncrement:d}=f,p=we(h),m=h==null,_={},g={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:m,compound:p,keyPath:h,autoIncrement:d,unique:!0,extractKey:or(h)},indexes:li(f.indexNames).map(w=>f.index(w)).map(w=>{const{name:x,unique:k,multiEntry:$,keyPath:C}=w,E={name:x,compound:we(C),keyPath:C,unique:k,multiEntry:$,extractKey:or(C)};return _[Bt(C)]=E,E}),getIndexByKeyPath:w=>_[Bt(w)]};return _[":id"]=g.primaryKey,h!=null&&(_[Bt(h)]=g.primaryKey),g})},hasGetAll:u.length>0&&"getAll"in c.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(r,t),s=i.tables.map(o=>function(c){const u=c.name;return{name:u,schema:c,mutate:function({trans:f,type:h,keys:d,values:p,range:m}){return new Promise((_,g)=>{_=ue(_);const w=f.objectStore(u),x=w.keyPath==null,k=h==="put"||h==="add";if(!k&&h!=="delete"&&h!=="deleteRange")throw new Error("Invalid operation type: "+h);const{length:$}=d||p||{length:1};if(d&&p&&d.length!==p.length)throw new Error("Given keys array must have same length as given values array.");if($===0)return _({numFailures:0,failures:{},results:[],lastResult:void 0});let C;const E=[],D=[];let S=0;const L=M=>{++S,Ut(M)};if(h==="deleteRange"){if(m.type===4)return _({numFailures:S,failures:D,results:[],lastResult:void 0});m.type===3?E.push(C=w.clear()):E.push(C=w.delete(n(m)))}else{const[M,Z]=k?x?[p,d]:[p,null]:[d,null];if(k)for(let Y=0;Y<$;++Y)E.push(C=Z&&Z[Y]!==void 0?w[h](M[Y],Z[Y]):w[h](M[Y])),C.onerror=L;else for(let Y=0;Y<$;++Y)E.push(C=w[h](M[Y])),C.onerror=L}const O=M=>{const Z=M.target.result;E.forEach((Y,ce)=>Y.error!=null&&(D[ce]=Y.error)),_({numFailures:S,failures:D,results:h==="delete"?d:E.map(Y=>Y.result),lastResult:Z})};C.onerror=M=>{L(M),O(M)},C.onsuccess=O})},getMany:({trans:f,keys:h})=>new Promise((d,p)=>{d=ue(d);const m=f.objectStore(u),_=h.length,g=new Array(_);let w,x=0,k=0;const $=E=>{const D=E.target;g[D._pos]=D.result,++k===x&&d(g)},C=Oe(p);for(let E=0;E<_;++E)h[E]!=null&&(w=m.get(h[E]),w._pos=E,w.onsuccess=$,w.onerror=C,++x);x===0&&d(g)}),get:({trans:f,key:h})=>new Promise((d,p)=>{d=ue(d);const m=f.objectStore(u).get(h);m.onsuccess=_=>d(_.target.result),m.onerror=Oe(p)}),query:function(f){return h=>new Promise((d,p)=>{d=ue(d);const{trans:m,values:_,limit:g,query:w}=h,x=g===1/0?void 0:g,{index:k,range:$}=w,C=m.objectStore(u),E=k.isPrimaryKey?C:C.index(k.name),D=n($);if(g===0)return d({result:[]});if(f){const S=_?E.getAll(D,x):E.getAllKeys(D,x);S.onsuccess=L=>d({result:L.target.result}),S.onerror=Oe(p)}else{let S=0;const L=_||!("openKeyCursor"in E)?E.openCursor(D):E.openKeyCursor(D),O=[];L.onsuccess=M=>{const Z=L.result;return Z?(O.push(_?Z.value:Z.primaryKey),++S===g?d({result:O}):void Z.continue()):d({result:O})},L.onerror=Oe(p)}})}(l),openCursor:function({trans:f,values:h,query:d,reverse:p,unique:m}){return new Promise((_,g)=>{_=ue(_);const{index:w,range:x}=d,k=f.objectStore(u),$=w.isPrimaryKey?k:k.index(w.name),C=p?m?"prevunique":"prev":m?"nextunique":"next",E=h||!("openKeyCursor"in $)?$.openCursor(n(x),C):$.openKeyCursor(n(x),C);E.onerror=Oe(g),E.onsuccess=ue(D=>{const S=E.result;if(!S)return void _(null);S.___id=++zl,S.done=!1;const L=S.continue.bind(S);let O=S.continuePrimaryKey;O&&(O=O.bind(S));const M=S.advance.bind(S),Z=()=>{throw new Error("Cursor not stopped")};S.trans=f,S.stop=S.continue=S.continuePrimaryKey=S.advance=()=>{throw new Error("Cursor not started")},S.fail=ue(g),S.next=function(){let Y=1;return this.start(()=>Y--?this.continue():this.stop()).then(()=>this)},S.start=Y=>{const ce=new Promise((V,X)=>{V=ue(V),E.onerror=Oe(X),S.fail=X,S.stop=me=>{S.stop=S.continue=S.continuePrimaryKey=S.advance=Z,V(me)}}),ae=()=>{if(E.result)try{Y()}catch(V){S.fail(V)}else S.done=!0,S.start=()=>{throw new Error("Cursor behind last entry")},S.stop()};return E.onsuccess=ue(V=>{E.onsuccess=ae,ae()}),S.continue=L,S.continuePrimaryKey=O,S.advance=M,ae(),ce},_(S)},g)})},count({query:f,trans:h}){const{index:d,range:p}=f;return new Promise((m,_)=>{const g=h.objectStore(u),w=d.isPrimaryKey?g:g.index(d.name),x=n(p),k=x?w.count(x):w.count();k.onsuccess=ue($=>m($.target.result)),k.onerror=Oe(_)})}}}(o)),a={};return s.forEach(o=>a[o.name]=o),{stack:"dbcore",transaction:r.transaction.bind(r),table(o){if(!a[o])throw new Error(`Table '${o}' not found`);return a[o]},MIN_KEY:-1/0,MAX_KEY:Ht(e),schema:i}}function ar({_novip:r},e){const t=e.db,n=function(i,l,{IDBKeyRange:s,indexedDB:a},o){return{dbcore:function(u,f){return f.reduce((h,{create:d})=>({...h,...d(h)}),u)}(Ul(l,s,o),i.dbcore)}}(r._middlewares,t,r._deps,e);r.core=n.dbcore,r.tables.forEach(i=>{const l=i.name;r.core.schema.tables.some(s=>s.name===l)&&(i.core=r.core.table(l),r[l]instanceof r.Table&&(r[l].core=i.core))})}function Sn({_novip:r},e,t,n){t.forEach(i=>{const l=n[i];e.forEach(s=>{const a=kr(s,i);(!a||"value"in a&&a.value===void 0)&&(s===r.Transaction.prototype||s instanceof r.Transaction?Qe(s,i,{get(){return this.table(i)},set(o){ss(this,i,{value:o,writable:!0,configurable:!0,enumerable:!0})}}):s[i]=new r.Table(i,l))})})}function ur({_novip:r},e){e.forEach(t=>{for(let n in t)t[n]instanceof r.Table&&delete t[n]})}function Ql(r,e){return r._cfg.version-e._cfg.version}function Hl(r,e,t,n){const i=r._dbSchema,l=r._createTransaction("readwrite",r._storeNames,i);l.create(t),l._completion.catch(n);const s=l._reject.bind(l),a=N.transless||N;et(()=>{N.trans=l,N.transless=a,e===0?(pe(i).forEach(o=>{Mn(t,o,i[o].primKey,i[o].indexes)}),ar(r,t),F.follow(()=>r.on.populate.fire(l)).catch(s)):function({_novip:o},c,u,f){const h=[],d=o._versions;let p=o._dbSchema=fr(o,o.idbdb,f),m=!1;const _=d.filter(w=>w._cfg.version>=c);function g(){return h.length?F.resolve(h.shift()(u.idbtrans)).then(g):F.resolve()}return _.forEach(w=>{h.push(()=>{const x=p,k=w._cfg.dbschema;hr(o,x,f),hr(o,k,f),p=o._dbSchema=k;const $=Ds(x,k);$.add.forEach(E=>{Mn(f,E[0],E[1].primKey,E[1].indexes)}),$.change.forEach(E=>{if(E.recreate)throw new q.Upgrade("Not yet support for changing primary key");{const D=f.objectStore(E.name);E.add.forEach(S=>cr(D,S)),E.change.forEach(S=>{D.deleteIndex(S.name),cr(D,S)}),E.del.forEach(S=>D.deleteIndex(S))}});const C=w._cfg.contentUpgrade;if(C&&w._cfg.version>c){ar(o,f),u._memoizedTables={},m=!0;let E=us(k);$.del.forEach(O=>{E[O]=x[O]}),ur(o,[o.Transaction.prototype]),Sn(o,[o.Transaction.prototype],pe(E),E),u.schema=E;const D=xr(C);let S;D&&Ct();const L=F.follow(()=>{if(S=C(u),S&&D){var O=We.bind(null,null);S.then(O,O)}});return S&&typeof S.then=="function"?F.resolve(S):L.then(()=>S)}}),h.push(x=>{(!m||!jl)&&function(k,$){[].slice.call($.db.objectStoreNames).forEach(C=>k[C]==null&&$.db.deleteObjectStore(C))}(w._cfg.dbschema,x),ur(o,[o.Transaction.prototype]),Sn(o,[o.Transaction.prototype],o._storeNames,o._dbSchema),u.schema=o._dbSchema})}),g().then(()=>{var w,x;x=f,pe(w=p).forEach(k=>{x.db.objectStoreNames.contains(k)||Mn(x,k,w[k].primKey,w[k].indexes)})})}(r,e,l,t).catch(s)})}function Ds(r,e){const t={del:[],add:[],change:[]};let n;for(n in r)e[n]||t.del.push(n);for(n in e){const i=r[n],l=e[n];if(i){const s={name:n,def:l,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(l.primKey.keyPath||"")||i.primKey.auto!==l.primKey.auto&&!Dn)s.recreate=!0,t.change.push(s);else{const a=i.idxByName,o=l.idxByName;let c;for(c in a)o[c]||s.del.push(c);for(c in o){const u=a[c],f=o[c];u?u.src!==f.src&&s.change.push(f):s.add.push(f)}(s.del.length>0||s.add.length>0||s.change.length>0)&&t.change.push(s)}}else t.add.push([n,l])}return t}function Mn(r,e,t,n){const i=r.db.createObjectStore(e,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return n.forEach(l=>cr(i,l)),i}function cr(r,e){r.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function fr(r,e,t){const n={};return wn(e.objectStoreNames,0).forEach(i=>{const l=t.objectStore(i);let s=l.keyPath;const a=lr(Ts(s),s||"",!1,!1,!!l.autoIncrement,s&&typeof s!="string",!0),o=[];for(let u=0;u<l.indexNames.length;++u){const f=l.index(l.indexNames[u]);s=f.keyPath;var c=lr(f.name,s,!!f.unique,!!f.multiEntry,!1,s&&typeof s!="string",!1);o.push(c)}n[i]=As(i,a,o)}),n}function hr({_novip:r},e,t){const n=t.db.objectStoreNames;for(let i=0;i<n.length;++i){const l=n[i],s=t.objectStore(l);r._hasGetAll="getAll"in s;for(let a=0;a<s.indexNames.length;++a){const o=s.indexNames[a],c=s.index(o).keyPath,u=typeof c=="string"?c:"["+wn(c).join("+")+"]";if(e[l]){const f=e[l].idxByName[u];f&&(f.name=o,delete e[l].idxByName[u],e[l].idxByName[o]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&oe.WorkerGlobalScope&&oe instanceof oe.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}class Wl{_parseStoresSpec(e,t){pe(e).forEach(n=>{if(e[n]!==null){var i=e[n].split(",").map((s,a)=>{const o=(s=s.trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(o)?o.match(/^\[(.*)\]$/)[1].split("+"):o;return lr(o,c||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),we(c),a===0)}),l=i.shift();if(l.multi)throw new q.Schema("Primary key cannot be multi-valued");i.forEach(s=>{if(s.auto)throw new q.Schema("Only primary key can be marked as autoIncrement (++)");if(!s.keyPath)throw new q.Schema("Index must have a name and cannot be an empty string")}),t[n]=As(n,l,i)}})}stores(e){const t=this.db;this._cfg.storesSource=this._cfg.storesSource?xe(this._cfg.storesSource,e):e;const n=t._versions,i={};let l={};return n.forEach(s=>{xe(i,s._cfg.storesSource),l=s._cfg.dbschema={},s._parseStoresSpec(i,l)}),t._dbSchema=l,ur(t,[t._allTables,t,t.Transaction.prototype]),Sn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],pe(l),l),t._storeNames=pe(l),this}upgrade(e){return this._cfg.contentUpgrade=Sr(this._cfg.contentUpgrade||ie,e),this}}function Tr(r,e){let t=r._dbNamesDB;return t||(t=r._dbNamesDB=new ut(Rn,{addons:[],indexedDB:r,IDBKeyRange:e}),t.version(1).stores({dbnames:"name"})),t.table("dbnames")}function Ar(r){return r&&typeof r.databases=="function"}function dr(r){return et(function(){return N.letThrough=!0,r()})}function Vl(){var r;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var t=function(){return indexedDB.databases().finally(e)};r=setInterval(t,100),t()}).finally(function(){return clearInterval(r)}):Promise.resolve()}function Gl(r){const e=r._state,{indexedDB:t}=r._deps;if(e.isBeingOpened||r.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?ge(e.dbOpenError):r);Ne&&(e.openCanceller._stackHolder=pt()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const n=e.openCanceller;function i(){if(e.openCanceller!==n)throw new q.DatabaseClosed("db.open() was cancelled")}let l=e.dbReadyResolve,s=null,a=!1;const o=()=>new F((c,u)=>{if(i(),!t)throw new q.MissingAPI;const f=r.name,h=e.autoSchema?t.open(f):t.open(f,Math.round(10*r.verno));if(!h)throw new q.MissingAPI;h.onerror=Oe(u),h.onblocked=ue(r._fireOnBlocked),h.onupgradeneeded=ue(d=>{if(s=h.transaction,e.autoSchema&&!r._options.allowEmptyDB){h.onerror=Ut,s.abort(),h.result.close();const m=t.deleteDatabase(f);m.onsuccess=m.onerror=ue(()=>{u(new q.NoSuchDatabase(`Database ${f} doesnt exist`))})}else{s.onerror=Oe(u);var p=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;a=p<1,r._novip.idbdb=h.result,Hl(r,p/10,s,u)}},u),h.onsuccess=ue(()=>{s=null;const d=r._novip.idbdb=h.result,p=wn(d.objectStoreNames);if(p.length>0)try{const _=d.transaction((m=p).length===1?m[0]:m,"readonly");e.autoSchema?function({_novip:g},w,x){g.verno=w.version/10;const k=g._dbSchema=fr(0,w,x);g._storeNames=wn(w.objectStoreNames,0),Sn(g,[g._allTables],pe(k),k)}(r,d,_):(hr(r,r._dbSchema,_),function(g,w){const x=Ds(fr(0,g.idbdb,w),g._dbSchema);return!(x.add.length||x.change.some(k=>k.add.length||k.change.length))}(r,_)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),ar(r,_)}catch{}var m;Ft.push(r),d.onversionchange=ue(_=>{e.vcFired=!0,r.on("versionchange").fire(_)}),d.onclose=ue(_=>{r.on("close").fire(_)}),a&&function({indexedDB:_,IDBKeyRange:g},w){!Ar(_)&&w!==Rn&&Tr(_,g).put({name:w}).catch(ie)}(r._deps,f),c()},u)}).catch(c=>c&&c.name==="UnknownError"&&e.PR1398_maxLoop>0?(e.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),o()):F.reject(c));return F.race([n,(typeof navigator>"u"?F.resolve():Vl()).then(o)]).then(()=>(i(),e.onReadyBeingFired=[],F.resolve(dr(()=>r.on.ready.fire(r.vip))).then(function c(){if(e.onReadyBeingFired.length>0){let u=e.onReadyBeingFired.reduce(Sr,ie);return e.onReadyBeingFired=[],F.resolve(dr(()=>u(r.vip))).then(c)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>r).catch(c=>{e.dbOpenError=c;try{s&&s.abort()}catch{}return n===e.openCanceller&&r._close(),ge(c)}).finally(()=>{e.openComplete=!0,l()})}function pr(r){var e=l=>r.next(l),t=i(e),n=i(l=>r.throw(l));function i(l){return s=>{var a=l(s),o=a.value;return a.done?o:o&&typeof o.then=="function"?o.then(t,n):we(o)?Promise.all(o).then(t,n):t(o)}}return i(e)()}function Zl(r,e,t){var n=arguments.length;if(n<2)throw new q.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];return t=i.pop(),[r,cs(i),t]}function Rs(r,e,t,n,i){return F.resolve().then(()=>{const l=N.transless||N,s=r._createTransaction(e,t,r._dbSchema,n),a={trans:s,transless:l};if(n)s.idbtrans=n.idbtrans;else try{s.create(),r._state.PR1398_maxLoop=3}catch(f){return f.name===Er.InvalidState&&r.isOpen()&&--r._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),r._close(),r.open().then(()=>Rs(r,e,t,null,i))):ge(f)}const o=xr(i);let c;o&&Ct();const u=F.follow(()=>{if(c=i.call(s,s),c)if(o){var f=We.bind(null,null);c.then(f,f)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=pr(c))},a);return(c&&typeof c.then=="function"?F.resolve(c).then(f=>s.active?f:ge(new q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):u.then(()=>c)).then(f=>(n&&s._resolve(),s._completion.then(()=>f))).catch(f=>(s._reject(f),ge(f)))})}function on(r,e,t){const n=we(r)?r.slice():[r];for(let i=0;i<t;++i)n.push(e);return n}const Yl={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(r){return{...r,table(e){const t=r.table(e),{schema:n}=t,i={},l=[];function s(u,f,h){const d=Bt(u),p=i[d]=i[d]||[],m=u==null?0:typeof u=="string"?1:u.length,_=f>0,g={...h,isVirtual:_,keyTail:f,keyLength:m,extractKey:or(u),unique:!_&&h.unique};return p.push(g),g.isPrimaryKey||l.push(g),m>1&&s(m===2?u[0]:u.slice(0,m-1),f+1,h),p.sort((w,x)=>w.keyTail-x.keyTail),g}const a=s(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[a];for(const u of n.indexes)s(u.keyPath,0,u);function o(u){const f=u.query.index;return f.isVirtual?{...u,query:{index:f,range:(h=u.query.range,d=f.keyTail,{type:h.type===1?2:h.type,lower:on(h.lower,h.lowerOpen?r.MAX_KEY:r.MIN_KEY,d),lowerOpen:!0,upper:on(h.upper,h.upperOpen?r.MIN_KEY:r.MAX_KEY,d),upperOpen:!0})}}:u;var h,d}return{...t,schema:{...n,primaryKey:a,indexes:l,getIndexByKeyPath:function(u){const f=i[Bt(u)];return f&&f[0]}},count:u=>t.count(o(u)),query:u=>t.query(o(u)),openCursor(u){const{keyTail:f,isVirtual:h,keyLength:d}=u.query.index;return h?t.openCursor(o(u)).then(p=>p&&function(m){return Object.create(m,{continue:{value:function(g){g!=null?m.continue(on(g,u.reverse?r.MAX_KEY:r.MIN_KEY,f)):u.unique?m.continue(m.key.slice(0,d).concat(u.reverse?r.MIN_KEY:r.MAX_KEY,f)):m.continue()}},continuePrimaryKey:{value(g,w){m.continuePrimaryKey(on(g,r.MAX_KEY,f),w)}},primaryKey:{get:()=>m.primaryKey},key:{get(){const g=m.key;return d===1?g[0]:g.slice(0,d)}},value:{get:()=>m.value}})}(p)):t.openCursor(u)}}}}}};function Dr(r,e,t,n){return t=t||{},n=n||"",pe(r).forEach(i=>{if(Pe(e,i)){var l=r[i],s=e[i];if(typeof l=="object"&&typeof s=="object"&&l&&s){const a=Wn(l);a!==Wn(s)?t[n+i]=e[i]:a==="Object"?Dr(l,s,t,n+i+"."):l!==s&&(t[n+i]=e[i])}else l!==s&&(t[n+i]=e[i])}else t[n+i]=void 0}),pe(e).forEach(i=>{Pe(r,i)||(t[n+i]=e[i])}),t}const Jl={stack:"dbcore",name:"HooksMiddleware",level:2,create:r=>({...r,table(e){const t=r.table(e),{primaryKey:n}=t.schema;return{...t,mutate(l){const s=N.trans,{deleting:a,creating:o,updating:c}=s.table(e).hook;switch(l.type){case"add":if(o.fire===ie)break;return s._promise("readwrite",()=>u(l),!0);case"put":if(o.fire===ie&&c.fire===ie)break;return s._promise("readwrite",()=>u(l),!0);case"delete":if(a.fire===ie)break;return s._promise("readwrite",()=>u(l),!0);case"deleteRange":if(a.fire===ie)break;return s._promise("readwrite",()=>function(h){return f(h.trans,h.range,1e4)}(l),!0)}return t.mutate(l);function u(h){const d=N.trans,p=h.keys||function(m,_){return _.type==="delete"?_.keys:_.keys||_.values.map(m.extractKey)}(n,h);if(!p)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?{...h,keys:p}:{...h}).type!=="delete"&&(h.values=[...h.values]),h.keys&&(h.keys=[...h.keys]),function(m,_,g){return _.type==="add"?Promise.resolve([]):m.getMany({trans:_.trans,keys:g,cache:"immutable"})}(t,h,p).then(m=>{const _=p.map((g,w)=>{const x=m[w],k={onerror:null,onsuccess:null};if(h.type==="delete")a.fire.call(k,g,x,d);else if(h.type==="add"||x===void 0){const $=o.fire.call(k,g,h.values[w],d);g==null&&$!=null&&(g=$,h.keys[w]=g,n.outbound||Ae(h.values[w],n.keyPath,g))}else{const $=Dr(x,h.values[w]),C=c.fire.call(k,$,g,x,d);if(C){const E=h.values[w];Object.keys(C).forEach(D=>{Pe(E,D)?E[D]=C[D]:Ae(E,D,C[D])})}}return k});return t.mutate(h).then(({failures:g,results:w,numFailures:x,lastResult:k})=>{for(let $=0;$<p.length;++$){const C=w?w[$]:p[$],E=_[$];C==null?E.onerror&&E.onerror(g[$]):E.onsuccess&&E.onsuccess(h.type==="put"&&m[$]?h.values[$]:C)}return{failures:g,results:w,numFailures:x,lastResult:k}}).catch(g=>(_.forEach(w=>w.onerror&&w.onerror(g)),Promise.reject(g)))})}function f(h,d,p){return t.query({trans:h,values:!1,query:{index:n,range:d},limit:p}).then(({result:m})=>u({type:"delete",keys:m,trans:h}).then(_=>_.numFailures>0?Promise.reject(_.failures[0]):m.length<p?{failures:[],numFailures:0,lastResult:void 0}:f(h,{...d,lower:m[m.length-1],lowerOpen:!0},p)))}}}}})};function Os(r,e,t){try{if(!e||e.keys.length<r.length)return null;const n=[];for(let i=0,l=0;i<e.keys.length&&l<r.length;++i)ke(e.keys[i],r[l])===0&&(n.push(t?Vt(e.values[i]):e.values[i]),++l);return n.length===r.length?n:null}catch{return null}}const Xl={stack:"dbcore",level:-1,create:r=>({table:e=>{const t=r.table(e);return{...t,getMany:n=>{if(!n.cache)return t.getMany(n);const i=Os(n.keys,n.trans._cache,n.cache==="clone");return i?F.resolve(i):t.getMany(n).then(l=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?Vt(l):l},l))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),t.mutate(n))}}})};function Rr(r){return!("from"in r)}const Me=function(r,e){if(!this){const t=new Me;return r&&"d"in r&&xe(t,r),t}xe(this,arguments.length?{d:1,from:r,to:arguments.length>1?e:r}:{d:0})};function Wt(r,e,t){const n=ke(e,t);if(isNaN(n))return;if(n>0)throw RangeError();if(Rr(r))return xe(r,{from:e,to:t,d:1});const i=r.l,l=r.r;if(ke(t,r.from)<0)return i?Wt(i,e,t):r.l={from:e,to:t,d:1,l:null,r:null},oi(r);if(ke(e,r.to)>0)return l?Wt(l,e,t):r.r={from:e,to:t,d:1,l:null,r:null},oi(r);ke(e,r.from)<0&&(r.from=e,r.l=null,r.d=l?l.d+1:1),ke(t,r.to)>0&&(r.to=t,r.r=null,r.d=r.l?r.l.d+1:1);const s=!r.r;i&&!r.l&&Cn(r,i),l&&s&&Cn(r,l)}function Cn(r,e){Rr(e)||function t(n,{from:i,to:l,l:s,r:a}){Wt(n,i,l),s&&t(n,s),a&&t(n,a)}(r,e)}function eo(r,e){const t=gr(e);let n=t.next();if(n.done)return!1;let i=n.value;const l=gr(r);let s=l.next(i.from),a=s.value;for(;!n.done&&!s.done;){if(ke(a.from,i.to)<=0&&ke(a.to,i.from)>=0)return!0;ke(i.from,a.from)<0?i=(n=t.next(a.from)).value:a=(s=l.next(i.from)).value}return!1}function gr(r){let e=Rr(r)?null:{s:0,n:r};return{next(t){const n=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,n)for(;e.n.l&&ke(t,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!n||ke(t,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function oi(r){var e,t;const n=(((e=r.r)===null||e===void 0?void 0:e.d)||0)-(((t=r.l)===null||t===void 0?void 0:t.d)||0),i=n>1?"r":n<-1?"l":"";if(i){const l=i==="r"?"l":"r",s={...r},a=r[i];r.from=a.from,r.to=a.to,r[i]=a[i],s[i]=a[l],r[l]=s,s.d=ai(s)}r.d=ai(r)}function ai({r,l:e}){return(r?e?Math.max(r.d,e.d):r.d:e?e.d:0)+1}$t(Me.prototype,{add(r){return Cn(this,r),this},addKey(r){return Wt(this,r,r),this},addKeys(r){return r.forEach(e=>Wt(this,e,e)),this},[Vn](){return gr(this)}});const to={stack:"dbcore",level:0,create:r=>{const e=r.schema.name,t=new Me(r.MIN_KEY,r.MAX_KEY);return{...r,table:n=>{const i=r.table(n),{schema:l}=i,{primaryKey:s}=l,{extractKey:a,outbound:o}=s,c={...i,mutate:h=>{const d=h.trans,p=d.mutatedParts||(d.mutatedParts={}),m=C=>{const E=`idb://${e}/${n}/${C}`;return p[E]||(p[E]=new Me)},_=m(""),g=m(":dels"),{type:w}=h;let[x,k]=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[];const $=h.trans._cache;return i.mutate(h).then(C=>{if(we(x)){w!=="delete"&&(x=C.results),_.addKeys(x);const E=Os(x,$);E||w==="add"||g.addKeys(x),(E||k)&&function(D,S,L,O){function M(Z){const Y=D(Z.name||"");function ce(V){return V!=null?Z.extractKey(V):null}const ae=V=>Z.multiEntry&&we(V)?V.forEach(X=>Y.addKey(X)):Y.addKey(V);(L||O).forEach((V,X)=>{const me=L&&ce(L[X]),$e=O&&ce(O[X]);ke(me,$e)!==0&&(me!=null&&ae(me),$e!=null&&ae($e))})}S.indexes.forEach(M)}(m,l,E,k)}else if(x){const E={from:x.lower,to:x.upper};g.add(E),_.add(E)}else _.add(t),g.add(t),l.indexes.forEach(E=>m(E.name).add(t));return C})}},u=({query:{index:h,range:d}})=>{var p,m;return[h,new Me((p=d.lower)!==null&&p!==void 0?p:r.MIN_KEY,(m=d.upper)!==null&&m!==void 0?m:r.MAX_KEY)]},f={get:h=>[s,new Me(h.key)],getMany:h=>[s,new Me().addKeys(h.keys)],count:u,query:u,openCursor:u};return pe(f).forEach(h=>{c[h]=function(d){const{subscr:p}=N;if(p){const m=k=>{const $=`idb://${e}/${n}/${k}`;return p[$]||(p[$]=new Me)},_=m(""),g=m(":dels"),[w,x]=f[h](d);if(m(w.name||"").add(x),!w.isPrimaryKey){if(h!=="count"){const k=h==="query"&&o&&d.values&&i.query({...d,values:!1});return i[h].apply(this,arguments).then($=>{if(h==="query"){if(o&&d.values)return k.then(({result:E})=>(_.addKeys(E),$));const C=d.values?$.result.map(a):$.result;d.values?_.addKeys(C):g.addKeys(C)}else if(h==="openCursor"){const C=$,E=d.values;return C&&Object.create(C,{key:{get:()=>(g.addKey(C.primaryKey),C.key)},primaryKey:{get(){const D=C.primaryKey;return g.addKey(D),D}},value:{get:()=>(E&&_.addKey(C.primaryKey),C.value)}})}return $})}g.add(t)}}return i[h].apply(this,arguments)}}),c}}}};class ut{constructor(e,t){this._middlewares={},this.verno=0;const n=ut.dependencies;this._options=t={addons:ut.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};const{addons:i}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const l={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ie,dbReadyPromise:null,cancelOpen:ie,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var s;l.dbReadyPromise=new F(a=>{l.dbReadyResolve=a}),l.openCanceller=new F((a,o)=>{l.cancelOpen=o}),this._state=l,this.name=e,this.on=Lt(this,"populate","blocked","versionchange","close",{ready:[Sr,ie]}),this.on.ready.subscribe=ls(this.on.ready.subscribe,a=>(o,c)=>{ut.vip(()=>{const u=this._state;if(u.openComplete)u.dbOpenError||F.resolve().then(o),c&&a(o);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(o),c&&a(o);else{a(o);const f=this;c||a(function h(){f.on.ready.unsubscribe(o),f.on.ready.unsubscribe(h)})}})}),this.Collection=(s=this,At(Bl.prototype,function(a,o){this.db=s;let c=Cs,u=null;if(o)try{c=o()}catch(p){u=p}const f=a._ctx,h=f.table,d=h.hook.reading.fire;this._ctx={table:h,index:f.index,isPrimKey:!f.index||h.schema.primKey.keyPath&&f.index===h.schema.primKey.name,range:c,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:f.or,valueMapper:d!==Mt?d:null}})),this.Table=function(a){return At(Ll.prototype,function(o,c,u){this.db=a,this._tx=u,this.name=o,this.schema=c,this.hook=a._allTables[o]?a._allTables[o].hook:Lt(null,{creating:[El,ie],reading:[$l,Mt],updating:[Cl,ie],deleting:[Sl,ie]})})}(this),this.Transaction=function(a){return At(Ml.prototype,function(o,c,u,f,h){this.db=a,this.mode=o,this.storeNames=c,this.schema=u,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=Lt(this,"complete","error","abort"),this.parent=h||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new F((d,p)=>{this._resolve=d,this._reject=p}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},d=>{var p=this.active;return this.active=!1,this.on.error.fire(d),this.parent?this.parent._reject(d):p&&this.idbtrans&&this.idbtrans.abort(),ge(d)})})}(this),this.Version=function(a){return At(Wl.prototype,function(o){this.db=a,this._cfg={version:o,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(a){return At(Is.prototype,function(o,c,u){this.db=a,this._ctx={table:o,index:c===":id"?null:c,or:u};const f=a._deps.indexedDB;if(!f)throw new q.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(h,d)=>f.cmp(d,h),this._max=(h,d)=>f.cmp(h,d)>0?h:d,this._min=(h,d)=>f.cmp(h,d)<0?h:d,this._IDBKeyRange=a._deps.IDBKeyRange})}(this),this.on("versionchange",a=>{a.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",a=>{!a.newVersion||a.newVersion<a.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${a.oldVersion/10}`)}),this._maxKey=Ht(t.IDBKeyRange),this._createTransaction=(a,o,c,u)=>new this.Transaction(a,o,c,this._options.chromeTransactionDurability,u),this._fireOnBlocked=a=>{this.on("blocked").fire(a),Ft.filter(o=>o.name===this.name&&o!==this&&!o._state.vcFired).map(o=>o.on("versionchange").fire(a))},this.use(Yl),this.use(Jl),this.use(to),this.use(Xl),this.vip=Object.create(this,{_vip:{value:!0}}),i.forEach(a=>a(this))}version(e){if(isNaN(e)||e<.1)throw new q.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const t=this._versions;var n=t.filter(i=>i._cfg.version===e)[0];return n||(n=new this.Version(e),t.push(n),t.sort(Ql),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||N.letThrough||this._vip)?e():new F((t,n)=>{if(this._state.openComplete)return n(new q.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new q.DatabaseClosed);this.open().catch(ie)}this._state.dbReadyPromise.then(t,n)}).then(e)}use({stack:e,create:t,level:n,name:i}){i&&this.unuse({stack:e,name:i});const l=this._middlewares[e]||(this._middlewares[e]=[]);return l.push({stack:e,create:t,level:n??10,name:i}),l.sort((s,a)=>s.level-a.level),this}unuse({stack:e,name:t,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(i=>n?i.create!==n:!!t&&i.name!==t)),this}open(){return Gl(this)}_close(){const e=this._state,t=Ft.indexOf(this);if(t>=0&&Ft.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new F(n=>{e.dbReadyResolve=n}),e.openCanceller=new F((n,i)=>{e.cancelOpen=i})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new q.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,t=this._state;return new F((n,i)=>{const l=()=>{this.close();var s=this._deps.indexedDB.deleteDatabase(this.name);s.onsuccess=ue(()=>{(function({indexedDB:a,IDBKeyRange:o},c){!Ar(a)&&c!==Rn&&Tr(a,o).delete(c).catch(ie)})(this._deps,this.name),n()}),s.onerror=Oe(i),s.onblocked=this._fireOnBlocked};if(e)throw new q.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(l):l()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return pe(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Zl.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,n){let i=N.trans;i&&i.db===this&&e.indexOf("!")===-1||(i=null);const l=e.indexOf("?")!==-1;let s,a;e=e.replace("!","").replace("?","");try{if(a=t.map(c=>{var u=c instanceof this.Table?c.name:c;if(typeof u!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return u}),e=="r"||e===Ln)s=Ln;else{if(e!="rw"&&e!=Bn)throw new q.InvalidArgument("Invalid transaction mode: "+e);s=Bn}if(i){if(i.mode===Ln&&s===Bn){if(!l)throw new q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach(c=>{if(i&&i.storeNames.indexOf(c)===-1){if(!l)throw new q.SubTransaction("Table "+c+" not included in parent transaction.");i=null}}),l&&i&&!i.active&&(i=null)}}catch(c){return i?i._promise(null,(u,f)=>{f(c)}):ge(c)}const o=Rs.bind(null,this,s,a,i,n);return i?i._promise(s,o,"lock"):N.trans?Pt(N.transless,()=>this._whenReady(o)):this._whenReady(o)}table(e){if(!Pe(this._allTables,e))throw new q.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const no=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class ro{constructor(e){this._subscribe=e}subscribe(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})}[no](){return this}}function js(r,e){return pe(e).forEach(t=>{Cn(r[t]||(r[t]=new Me),e[t])}),r}function io(r){let e,t=!1;const n=new ro(i=>{const l=xr(r);let s=!1,a={},o={};const c={get closed(){return s},unsubscribe:()=>{s=!0,nt.storagemutated.unsubscribe(d)}};i.start&&i.start(c);let u=!1,f=!1;function h(){return pe(o).some(m=>a[m]&&eo(a[m],o[m]))}const d=m=>{js(a,m),h()&&p()},p=()=>{if(u||s)return;a={};const m={},_=function(g){l&&Ct();const w=()=>et(r,{subscr:g,trans:null}),x=N.trans?Pt(N.transless,w):w();return l&&x.then(We,We),x}(m);f||(nt(Qt,d),f=!0),u=!0,Promise.resolve(_).then(g=>{t=!0,e=g,u=!1,s||(h()?p():(a={},o=m,i.next&&i.next(g)))},g=>{u=!1,t=!1,i.error&&i.error(g),c.unsubscribe()})};return p(),c});return n.hasValue=()=>t,n.getValue=()=>e,n}let mr;try{mr={indexedDB:oe.indexedDB||oe.mozIndexedDB||oe.webkitIndexedDB||oe.msIndexedDB,IDBKeyRange:oe.IDBKeyRange||oe.webkitIDBKeyRange}}catch{mr={indexedDB:null,IDBKeyRange:null}}const it=ut;function mn(r){let e=Ue;try{Ue=!0,nt.storagemutated.fire(r)}finally{Ue=e}}$t(it,{...cn,delete:r=>new it(r,{addons:[]}).delete(),exists:r=>new it(r,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(r){try{return function({indexedDB:e,IDBKeyRange:t}){return Ar(e)?Promise.resolve(e.databases()).then(n=>n.map(i=>i.name).filter(i=>i!==Rn)):Tr(e,t).toCollection().primaryKeys()}(it.dependencies).then(r)}catch{return ge(new q.MissingAPI)}},defineClass:()=>function(r){xe(this,r)},ignoreTransaction:r=>N.trans?Pt(N.transless,r):r(),vip:dr,async:function(r){return function(){try{var e=pr(r.apply(this,arguments));return e&&typeof e.then=="function"?e:F.resolve(e)}catch(t){return ge(t)}}},spawn:function(r,e,t){try{var n=pr(r.apply(t,e||[]));return n&&typeof n.then=="function"?n:F.resolve(n)}catch(i){return ge(i)}},currentTransaction:{get:()=>N.trans||null},waitFor:function(r,e){const t=F.resolve(typeof r=="function"?it.ignoreTransaction(r):r).timeout(e||6e4);return N.trans?N.trans.waitFor(t):t},Promise:F,debug:{get:()=>Ne,set:r=>{hs(r,r==="dexie"?()=>!0:Ss)}},derive:wt,extend:xe,props:$t,override:ls,Events:Lt,on:nt,liveQuery:io,extendObservabilitySet:js,getByKeyPath:He,setByKeyPath:Ae,delByKeyPath:function(r,e){typeof e=="string"?Ae(r,e,void 0):"length"in e&&[].map.call(e,function(t){Ae(r,t,void 0)})},shallowClone:us,deepClone:Vt,getObjectDiff:Dr,cmp:ke,asap:os,minKey:sr,addons:[],connections:Ft,errnames:Er,dependencies:mr,semVer:ti,version:ti.split(".").map(r=>parseInt(r)).reduce((r,e,t)=>r+e/Math.pow(10,2*t))}),it.maxKey=Ht(it.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(nt(Qt,r=>{if(!Ue){let e;Dn?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Je,!0,!0,r)):e=new CustomEvent(Je,{detail:r}),Ue=!0,dispatchEvent(e),Ue=!1}}),addEventListener(Je,({detail:r})=>{Ue||mn(r)}));let Ue=!1;if(typeof BroadcastChannel<"u"){const r=new BroadcastChannel(Je);typeof r.unref=="function"&&r.unref(),nt(Qt,e=>{Ue||r.postMessage(e)}),r.onmessage=e=>{e.data&&mn(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){nt(Qt,e=>{try{Ue||(typeof localStorage<"u"&&localStorage.setItem(Je,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(t=>t.postMessage({type:Je,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===Je){const t=JSON.parse(e.newValue);t&&mn(t.changedParts)}});const r=self.document&&navigator.serviceWorker;r&&r.addEventListener("message",function({data:e}){e&&e.type===Je&&mn(e.changedParts)})}F.rejectionMapper=function(r,e){if(!r||r instanceof vt||r instanceof TypeError||r instanceof SyntaxError||!r.name||!Yr[r.name])return r;var t=new Yr[r.name](e||r.message,r);return"stack"in r&&Qe(t,"stack",{get:function(){return this.inner.stack}}),t},hs(Ne,Ss);var so=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lo(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Fs={exports:{}};(function(r){(function(e,t){r.exports?r.exports=t():e.log=t()})(so,function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],l={},s=null;function a(m,_){var g=m[_];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(m){return m==="debug"&&(m="log"),typeof console===t?!1:m==="trace"&&n?o:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):e}function u(){for(var m=this.getLevel(),_=0;_<i.length;_++){var g=i[_];this[g]=_<m?e:this.methodFactory(g,m,this.name)}if(this.log=this.debug,typeof console===t&&m<this.levels.SILENT)return"No console available for logging"}function f(m){return function(){typeof console!==t&&(u.call(this),this[m].apply(this,arguments))}}function h(m,_,g){return c(m)||f.apply(this,arguments)}function d(m,_){var g=this,w,x,k,$="loglevel";typeof m=="string"?$+=":"+m:typeof m=="symbol"&&($=void 0);function C(O){var M=(i[O]||"silent").toUpperCase();if(!(typeof window===t||!$)){try{window.localStorage[$]=M;return}catch{}try{window.document.cookie=encodeURIComponent($)+"="+M+";"}catch{}}}function E(){var O;if(!(typeof window===t||!$)){try{O=window.localStorage[$]}catch{}if(typeof O===t)try{var M=window.document.cookie,Z=encodeURIComponent($),Y=M.indexOf(Z+"=");Y!==-1&&(O=/^([^;]+)/.exec(M.slice(Y+Z.length+1))[1])}catch{}return g.levels[O]===void 0&&(O=void 0),O}}function D(){if(!(typeof window===t||!$)){try{window.localStorage.removeItem($)}catch{}try{window.document.cookie=encodeURIComponent($)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function S(O){var M=O;if(typeof M=="string"&&g.levels[M.toUpperCase()]!==void 0&&(M=g.levels[M.toUpperCase()]),typeof M=="number"&&M>=0&&M<=g.levels.SILENT)return M;throw new TypeError("log.setLevel() called with invalid level: "+O)}g.name=m,g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=_||h,g.getLevel=function(){return k??x??w},g.setLevel=function(O,M){return k=S(O),M!==!1&&C(k),u.call(g)},g.setDefaultLevel=function(O){x=S(O),E()||g.setLevel(O,!1)},g.resetLevel=function(){k=null,D(),u.call(g)},g.enableAll=function(O){g.setLevel(g.levels.TRACE,O)},g.disableAll=function(O){g.setLevel(g.levels.SILENT,O)},g.rebuild=function(){if(s!==g&&(w=S(s.getLevel())),u.call(g),s===g)for(var O in l)l[O].rebuild()},w=S(s?s.getLevel():"WARN");var L=E();L!=null&&(k=S(L)),u.call(g)}s=new d,s.getLogger=function(_){if(typeof _!="symbol"&&typeof _!="string"||_==="")throw new TypeError("You must supply a name when creating a logger.");var g=l[_];return g||(g=l[_]=new d(_,s.methodFactory)),g};var p=typeof window!==t?window.log:void 0;return s.noConflict=function(){return typeof window!==t&&window.log===s&&(window.log=p),s},s.getLoggers=function(){return l},s.default=s,s})})(Fs);var oo=Fs.exports;const an=lo(oo),Yt={apiClient:an.getLogger("apiClient"),dataLoader:an.getLogger("dataLoader"),database:an.getLogger("database"),api:an.getLogger("api")};Object.values(Yt).forEach(r=>{r.setLevel("warn")});const ye=Yt.database;class ao extends ut{constructor(){super("SocialApplianceDB");J(this,"entities");this.version(1).stores({entities:"id, slug, type, parentId, [type+parentId], _cachedAt"})}}const Te=new ao;async function ui(r){ye.info("Caching entity:",r.id,r.slug,"parentId:",r.parentId),await Te.entities.put({...r,_cachedAt:Date.now()})}async function zn(r){ye.info(`Caching ${r.length} entities`),r.forEach(n=>{ye.debug(`  - ${n.id} (slug: ${n.slug}, parentId: ${n.parentId})`)});const e=r.map(n=>({...n,_cachedAt:Date.now()}));await Te.entities.bulkPut(e),ye.info("Entities cached successfully");const t=await Te.entities.count();ye.debug(`Total entities in database: ${t}`)}async function ci(r){ye.debug("Getting entity by id:",r);const e=await Te.entities.get(r);return ye.debug("Found entity:",e?"yes":"no"),e}async function fi(r){ye.debug("Getting entity by slug:",r);const e=await Te.entities.where("slug").equals(r).first();if(ye.debug("Found entity:",e?e.id:"no"),!e){const t=await Te.entities.toArray();ye.debug("All slugs in database:",t.map(n=>n.slug))}return e}async function uo(r){ye.info("Querying entities with filters:",r);let e=Te.entities.toCollection();r.type&&r.parentId!==void 0?(ye.debug("Using compound index [type+parentId]"),e=Te.entities.where("[type+parentId]").equals([r.type,r.parentId])):r.type?(ye.debug("Filtering by type:",r.type),e=Te.entities.where("type").equals(r.type)):r.parentId!==void 0&&(ye.debug("Filtering by parentId:",r.parentId),e=Te.entities.where("parentId").equals(r.parentId)),r.offset&&(e=e.offset(r.offset)),r.limit&&(e=e.limit(r.limit));const t=await e.toArray();return ye.info(`Query returned ${t.length} entities`),t.length>0&&ye.debug("Results:",t.map(n=>({id:n.id,slug:n.slug,parentId:n.parentId}))),t}async function co(r,e){return r._cachedAt?Date.now()-r._cachedAt>e:!0}const fo="modulepreload",ho=function(r){return"/"+r},hi={},po=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(t.map(o=>{if(o=ho(o),o in hi)return;hi[o]=!0;const c=o.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":fo,c||(f.as="script"),f.crossOrigin="",f.href=o,a&&f.setAttribute("nonce",a),document.head.appendChild(f),c)return new Promise((h,d)=>{f.addEventListener("load",h),f.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})}))}function l(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&l(a.reason);return e().catch(l)})},be=Yt.dataLoader;async function go(r){const e=[];try{be.info(`Loading ${r}...`);const t=Date.now(),n=await po(()=>import(`${r}?t=${t}`),[]);be.debug("Module loaded successfully"),be.debug("Module keys:",Object.keys(n));for(const[i,l]of Object.entries(n)){if(i==="default"){be.debug("Skipping default export");continue}be.debug(`Processing export "${i}"`),be.debug(`  Type: ${typeof l}`),be.debug(`  Is array: ${Array.isArray(l)}`),Array.isArray(l)?(be.debug(`  Array with ${l.length} items`),l.forEach((s,a)=>{s&&typeof s=="object"&&s.id?(be.debug(`    [${a}] id: ${s.id}, slug: ${s.slug}, parentId: ${s.parentId}`),e.push(s)):be.warn(`    [${a}] Not a valid entity:`,s)})):l&&typeof l=="object"&&l.id?(be.debug(`  Single entity: id: ${l.id}, slug: ${l.slug}, parentId: ${l.parentId}`),e.push(l)):be.debug(`  Export "${i}" is not an entity or array of entities`)}return be.info(`Total entities collected: ${e.length}`),e.length>0?(be.debug("Entities summary:"),e.forEach((i,l)=>{be.debug(`  [${l}] id: ${i.id}, slug: ${i.slug}, parentId: ${i.parentId}, title: ${i.title}`)})):be.warn("No entities found in module"),e}catch(t){return be.error(`Failed to load ${r}:`,t),[]}}const re=Yt.apiClient;class mo{constructor(){J(this,"loadedInfoFiles",new Set);J(this,"loadingInfoFiles",new Map);J(this,"serverAvailable",null);J(this,"initPromise",null);J(this,"stubEntityIds",new Set)}async init(){return this.initPromise?(re.info("Init already in progress or complete, waiting..."),this.initPromise):(this.initPromise=this._init(),this.initPromise)}async _init(){const e=Ye(Tt);if(re.info("Initializing..."),re.debug("Config:",e),e.flushCacheOnStartup){re.info("Flushing cache on startup...");try{await Te.delete(),await Te.open(),re.info("Cache flushed successfully")}catch(t){re.error("Failed to flush cache:",t)}}if(e.loadStaticData){console.log("ApiClient: Loading root .info.js...");try{await this.loadInfoFileForPath("/"),console.log("ApiClient: Root .info.js loaded successfully")}catch(t){re.error("Failed to load root .info.js:",t)}}re.info("Initialization complete")}async checkServerAvailability(){const e=Ye(Tt);if(this.serverAvailable!==null)return this.serverAvailable;try{const t=await fetch(`${e.baseUrl}/health`,{method:"GET",signal:AbortSignal.timeout(5e3)});return this.serverAvailable=t.ok,re.info("Server availability check:",this.serverAvailable),this.serverAvailable}catch{return this.serverAvailable=!1,re.info("Server is unavailable"),!1}}async fetchFromServer(e,t={}){const i=`${Ye(Tt).baseUrl}${e}`;try{const l=await fetch(i,{...t,headers:{"Content-Type":"application/json",...t.headers}});if(!l.ok){let a=`HTTP ${l.status}`;try{a=(await l.json()).error||a}catch{a=l.statusText||a}const o=new Error(a);throw o.status=l.status,o}const s=await l.json();if(s==null){const a=new Error("Entity not found");throw a.status=404,a}return s}catch(l){throw re.info("Server request failed:",l.message),l}}async request(e,t={}){await this.init();const n=Ye(Tt),i=t.method||"GET";if(re.debug(`Request ${i} ${e}`),i==="GET")return this.getWithCache(e);if(n.serverless)throw new Error("Mutations not supported in serverless mode");if(!await this.checkServerAvailability())throw new Error("Server unavailable - mutations not supported in offline mode");try{const s=await this.fetchFromServer(e,t);return s&&typeof s=="object"&&(Array.isArray(s)?await zn(s):s.id&&await ui(s)),s}catch(s){throw re.error("Mutation failed:",s),s}}async getWithCache(e){const t=Ye(Tt),n=this.extractSlugFromPath(e);n&&(re.debug(`Attempting to load .info.js files for slug: ${n}`),await this.loadInfoFilesForPathHierarchy(n));const i=await this.getFromCache(e);if(i!=null){if(!(Array.isArray(i)?!1:await co(i,t.cacheDuration)))return re.debug(`Cache hit (fresh) for ${e}`),i;re.debug(`Cache hit (stale) for ${e}`)}else re.debug(`Cache miss for ${e}`);if(!t.serverless&&await this.checkServerAvailability())try{re.debug(`Fetching from server: ${e}`);const a=await this.fetchFromServer(e);return a&&typeof a=="object"&&(Array.isArray(a)?await zn(a):a.id&&await ui(a)),re.debug("Server fetch successful, cached result"),a}catch(a){re.debug(`Server fetch failed: ${a.message}`)}if(i!=null)return re.debug(`Returning stale cached data for ${e}`),i;const l=new Error(`Entity not found: ${e}`);throw l.status=404,l}async getFromCache(e){if(e==="/entities/slug")return await fi("/");if(e.startsWith("/entities/slug/")){const t="/"+e.substring(15);return await fi(t)}if(e.match(/^\/entities\/[^\/\?]+$/)){const t=e.substring(10);return await ci(t)}if(e.startsWith("/entities?")){const t=new URLSearchParams(e.split("?")[1]),n={};return t.get("type")&&(n.type=t.get("type")),t.get("parentId")&&(n.parentId=t.get("parentId")),n.limit=parseInt(t.get("limit")||"20"),n.offset=parseInt(t.get("offset")||"0"),re.debug("Querying cache with filters:",n),await uo(n)}return null}extractSlugFromPath(e){return e==="/entities/slug"?"/":e.startsWith("/entities/slug/")?"/"+e.substring(15):null}async loadInfoFilesForPathHierarchy(e){re.debug(`Loading .info.js files for path hierarchy: ${e}`);const t=[];if(t.push("/"),e!=="/"){const i=e.split("/").filter(s=>s);let l="";for(const s of i)l+="/"+s,t.push(l)}re.debug("Path hierarchy to load:",t);let n=!1;for(const i of t)await this.loadInfoFileForPath(i)&&(n=!0);return re.debug(`Finished loading path hierarchy. Any files loaded: ${n}`),n}async loadInfoFileForPath(e){const t=e==="/"?"/":e.endsWith("/")?e.slice(0,-1):e,n=t==="/"?"/.info.js":`${t}/.info.js`;if(this.loadedInfoFiles.has(n))return re.debug(`Already loaded ${n}`),!1;if(this.loadingInfoFiles.has(n))return re.debug(`Already loading ${n}, waiting...`),await this.loadingInfoFiles.get(n);const i=(async()=>{try{console.log(`ApiClient: Loading ${n}...`),this.loadedInfoFiles.add(n);const l=await go(n);if(l.length>0){console.log(`ApiClient: Loaded ${l.length} entities from ${n}`),l.forEach(a=>{console.log(`  - ${a.id} (${a.title||"untitled"})`)});const s=await this.ensureParentStubs(l);return await zn(s),!0}else return console.log(`ApiClient: No entities found in ${n}`),!1}catch(l){return re.debug(`Failed to load ${n}:`,l),!1}finally{this.loadingInfoFiles.delete(n)}})();return this.loadingInfoFiles.set(n,i),await i}async ensureParentStubs(e){const t=[...e],n=new Set(e.map(i=>i.id));for(const i of e)if(i.parentId&&!n.has(i.parentId)&&!await ci(i.parentId)&&!this.stubEntityIds.has(i.parentId)){re.debug(`Creating stub for parent: ${i.parentId}`);const s={id:i.parentId,type:"group",title:`[Loading: ${i.parentId}]`,content:"This entity is being loaded...",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),metadata:{isStub:!0}};this.stubEntityIds.add(i.parentId),t.push(s),n.add(i.parentId)}return t}}const Or=new mo,bo=Yt.api,Be={async request(r,e={}){return Or.request(r,e)},async createPost(r){return this.request("/posts",{method:"POST",body:JSON.stringify(r)})},async createGroup(r){return this.request("/groups",{method:"POST",body:JSON.stringify(r)})},async createUser(r){return this.request("/users",{method:"POST",body:JSON.stringify(r)})},async getEntityBySlug(r){try{if(r==="/")return await this.request("/entities/slug");const n=`/entities/slug/${r.split("/").filter(l=>l).map(l=>encodeURIComponent(l)).join("/")}`;return await this.request(n)}catch(e){throw bo.error(`Failed to get entity by slug "${r}":`,e),e}},async queryEntities(r){const e=new URLSearchParams;return Object.entries(r).forEach(([t,n])=>{n!=null&&e.append(t,n)}),this.request(`/entities?${e}`)},async updateEntity(r,e){return this.request(`/entities/${r}`,{method:"PUT",body:JSON.stringify(e)})},async deleteEntity(r){return this.request(`/entities/${r}`,{method:"DELETE"})}};function jr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let gt=jr();function Ls(r){gt=r}const Bs=/[&<>"']/,yo=new RegExp(Bs.source,"g"),Ks=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,_o=new RegExp(Ks.source,"g"),wo={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},di=r=>wo[r];function Ce(r,e){if(e){if(Bs.test(r))return r.replace(yo,di)}else if(Ks.test(r))return r.replace(_o,di);return r}const vo=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function ko(r){return r.replace(vo,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const xo=/(^|[^\[])\^/g;function ne(r,e){r=typeof r=="string"?r:r.source,e=e||"";const t={replace:(n,i)=>(i=typeof i=="object"&&"source"in i?i.source:i,i=i.replace(xo,"$1"),r=r.replace(n,i),t),getRegex:()=>new RegExp(r,e)};return t}function pi(r){try{r=encodeURI(r).replace(/%25/g,"%")}catch{return null}return r}const Pn={exec:()=>null};function gi(r,e){const t=r.replace(/\|/g,(l,s,a)=>{let o=!1,c=s;for(;--c>=0&&a[c]==="\\";)o=!o;return o?"|":" |"}),n=t.split(/ \|/);let i=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}function un(r,e,t){const n=r.length;if(n===0)return"";let i=0;for(;i<n&&r.charAt(n-i-1)===e;)i++;return r.slice(0,n-i)}function $o(r,e){if(r.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<r.length;n++)if(r[n]==="\\")n++;else if(r[n]===e[0])t++;else if(r[n]===e[1]&&(t--,t<0))return n;return-1}function mi(r,e,t,n){const i=e.href,l=e.title?Ce(e.title):null,s=r[1].replace(/\\([\[\]])/g,"$1");if(r[0].charAt(0)!=="!"){n.state.inLink=!0;const a={type:"link",raw:t,href:i,title:l,text:s,tokens:n.inlineTokens(s)};return n.state.inLink=!1,a}return{type:"image",raw:t,href:i,title:l,text:Ce(s)}}function Eo(r,e){const t=r.match(/^(\s+)(?:```)/);if(t===null)return e;const n=t[1];return e.split(`
`).map(i=>{const l=i.match(/^\s+/);if(l===null)return i;const[s]=l;return s.length>=n.length?i.slice(n.length):i}).join(`
`)}class In{constructor(e){J(this,"options");J(this,"rules");J(this,"lexer");this.options=e||gt}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:un(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],i=Eo(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const i=un(n,"#");(this.options.pedantic||!i||/ $/.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const n=un(t[0].replace(/^ *>[ \t]?/gm,""),`
`),i=this.lexer.state.top;this.lexer.state.top=!0;const l=this.lexer.blockTokens(n);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:l,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const i=n.length>1,l={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");const s=new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a="",o="",c=!1;for(;e;){let u=!1;if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;a=t[0],e=e.substring(a.length);let f=t[2].split(`
`,1)[0].replace(/^\t+/,g=>" ".repeat(3*g.length)),h=e.split(`
`,1)[0],d=0;this.options.pedantic?(d=2,o=f.trimStart()):(d=t[2].search(/[^ ]/),d=d>4?1:d,o=f.slice(d),d+=t[1].length);let p=!1;if(!f&&/^ *$/.test(h)&&(a+=h+`
`,e=e.substring(h.length+1),u=!0),!u){const g=new RegExp(`^ {0,${Math.min(3,d-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),w=new RegExp(`^ {0,${Math.min(3,d-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),x=new RegExp(`^ {0,${Math.min(3,d-1)}}(?:\`\`\`|~~~)`),k=new RegExp(`^ {0,${Math.min(3,d-1)}}#`);for(;e;){const $=e.split(`
`,1)[0];if(h=$,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),x.test(h)||k.test(h)||g.test(h)||w.test(e))break;if(h.search(/[^ ]/)>=d||!h.trim())o+=`
`+h.slice(d);else{if(p||f.search(/[^ ]/)>=4||x.test(f)||k.test(f)||w.test(f))break;o+=`
`+h}!p&&!h.trim()&&(p=!0),a+=$+`
`,e=e.substring($.length+1),f=h.slice(d)}}l.loose||(c?l.loose=!0:/\n *\n *$/.test(a)&&(c=!0));let m=null,_;this.options.gfm&&(m=/^\[[ xX]\] /.exec(o),m&&(_=m[0]!=="[ ] ",o=o.replace(/^\[[ xX]\] +/,""))),l.items.push({type:"list_item",raw:a,task:!!m,checked:_,loose:!1,text:o,tokens:[]}),l.raw+=a}l.items[l.items.length-1].raw=a.trimEnd(),l.items[l.items.length-1].text=o.trimEnd(),l.raw=l.raw.trimEnd();for(let u=0;u<l.items.length;u++)if(this.lexer.state.top=!1,l.items[u].tokens=this.lexer.blockTokens(l.items[u].text,[]),!l.loose){const f=l.items[u].tokens.filter(d=>d.type==="space"),h=f.length>0&&f.some(d=>/\n.*\n/.test(d.raw));l.loose=h}if(l.loose)for(let u=0;u<l.items.length;u++)l.items[u].loose=!0;return l}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",l=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:l}}}table(e){const t=this.rules.block.table.exec(e);if(t){if(!/[:|]/.test(t[2]))return;const n={type:"table",raw:t[0],header:gi(t[1]).map(i=>({text:i,tokens:[]})),align:t[2].replace(/^\||\| *$/g,"").split("|"),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){let i=n.align.length,l,s,a,o;for(l=0;l<i;l++){const c=n.align[l];c&&(/^ *-+: *$/.test(c)?n.align[l]="right":/^ *:-+: *$/.test(c)?n.align[l]="center":/^ *:-+ *$/.test(c)?n.align[l]="left":n.align[l]=null)}for(i=n.rows.length,l=0;l<i;l++)n.rows[l]=gi(n.rows[l],n.header.length).map(c=>({text:c,tokens:[]}));for(i=n.header.length,s=0;s<i;s++)n.header[s].tokens=this.lexer.inline(n.header[s].text);for(i=n.rows.length,s=0;s<i;s++)for(o=n.rows[s],a=0;a<o.length;a++)o[a].tokens=this.lexer.inline(o[a].text);return n}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Ce(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const s=un(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{const s=$o(t[2],"()");if(s>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let i=t[2],l="";if(this.options.pedantic){const s=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);s&&(i=s[1],l=s[3])}else l=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(n)?i=i.slice(1):i=i.slice(1,-1)),mi(t,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:l&&l.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(/\s+/g," ");if(i=t[i.toLowerCase()],!i){const l=n[0].charAt(0);return{type:"text",raw:l,text:l}}return mi(n,i,n[0],this.lexer)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrong.lDelim.exec(e);if(!i||i[3]&&n.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const s=[...i[0]].length-1;let a,o,c=s,u=0;const f=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(f.lastIndex=0,t=t.slice(-1*e.length+s);(i=f.exec(t))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(o=[...a].length,i[3]||i[4]){c+=o;continue}else if((i[5]||i[6])&&s%3&&!((s+o)%3)){u+=o;continue}if(c-=o,c>0)continue;o=Math.min(o,o+c+u);const h=[...i[0]][0].length,d=e.slice(0,s+i.index+h+o);if(Math.min(s,o)%2){const m=d.slice(1,-1);return{type:"em",raw:d,text:m,tokens:this.lexer.inlineTokens(m)}}const p=d.slice(2,-2);return{type:"strong",raw:d,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const i=/[^ ]/.test(n),l=/^ /.test(n)&&/ $/.test(n);return i&&l&&(n=n.substring(1,n.length-1)),n=Ce(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,i;return t[2]==="@"?(n=Ce(t[1]),i="mailto:"+n):(n=Ce(t[1]),i=n),{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,i;if(t[2]==="@")n=Ce(t[0]),i="mailto:"+n;else{let l;do l=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])[0];while(l!==t[0]);n=Ce(t[0]),t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let n;return this.lexer.state.inRawBlock?n=t[0]:n=Ce(t[0]),{type:"text",raw:t[0],text:n}}}}const B={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Pn,lheading:/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};B._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;B._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;B.def=ne(B.def).replace("label",B._label).replace("title",B._title).getRegex();B.bullet=/(?:[*+-]|\d{1,9}[.)])/;B.listItemStart=ne(/^( *)(bull) */).replace("bull",B.bullet).getRegex();B.list=ne(B.list).replace(/bull/g,B.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+B.def.source+")").getRegex();B._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";B._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;B.html=ne(B.html,"i").replace("comment",B._comment).replace("tag",B._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();B.lheading=ne(B.lheading).replace(/bull/g,B.bullet).getRegex();B.paragraph=ne(B._paragraph).replace("hr",B.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",B._tag).getRegex();B.blockquote=ne(B.blockquote).replace("paragraph",B.paragraph).getRegex();B.normal={...B};B.gfm={...B.normal,table:"^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};B.gfm.table=ne(B.gfm.table).replace("hr",B.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",B._tag).getRegex();B.gfm.paragraph=ne(B._paragraph).replace("hr",B.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",B.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",B._tag).getRegex();B.pedantic={...B.normal,html:ne(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",B._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Pn,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ne(B.normal._paragraph).replace("hr",B.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",B.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const j={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Pn,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Pn,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};j._punctuation="\\p{P}$+<=>`^|~";j.punctuation=ne(j.punctuation,"u").replace(/punctuation/g,j._punctuation).getRegex();j.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;j.anyPunctuation=/\\[punct]/g;j._escapes=/\\([punct])/g;j._comment=ne(B._comment).replace("(?:-->|$)","-->").getRegex();j.emStrong.lDelim=ne(j.emStrong.lDelim,"u").replace(/punct/g,j._punctuation).getRegex();j.emStrong.rDelimAst=ne(j.emStrong.rDelimAst,"gu").replace(/punct/g,j._punctuation).getRegex();j.emStrong.rDelimUnd=ne(j.emStrong.rDelimUnd,"gu").replace(/punct/g,j._punctuation).getRegex();j.anyPunctuation=ne(j.anyPunctuation,"gu").replace(/punct/g,j._punctuation).getRegex();j._escapes=ne(j._escapes,"gu").replace(/punct/g,j._punctuation).getRegex();j._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;j._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;j.autolink=ne(j.autolink).replace("scheme",j._scheme).replace("email",j._email).getRegex();j._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;j.tag=ne(j.tag).replace("comment",j._comment).replace("attribute",j._attribute).getRegex();j._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;j._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;j._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;j.link=ne(j.link).replace("label",j._label).replace("href",j._href).replace("title",j._title).getRegex();j.reflink=ne(j.reflink).replace("label",j._label).replace("ref",B._label).getRegex();j.nolink=ne(j.nolink).replace("ref",B._label).getRegex();j.reflinkSearch=ne(j.reflinkSearch,"g").replace("reflink",j.reflink).replace("nolink",j.nolink).getRegex();j.normal={...j};j.pedantic={...j.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:ne(/^!?\[(label)\]\((.*?)\)/).replace("label",j._label).getRegex(),reflink:ne(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",j._label).getRegex()};j.gfm={...j.normal,escape:ne(j.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};j.gfm.url=ne(j.gfm.url,"i").replace("email",j.gfm._extended_email).getRegex();j.breaks={...j.gfm,br:ne(j.br).replace("{2,}","*").getRegex(),text:ne(j.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};class je{constructor(e){J(this,"tokens");J(this,"options");J(this,"state");J(this,"tokenizer");J(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||gt,this.options.tokenizer=this.options.tokenizer||new In,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:B.normal,inline:j.normal};this.options.pedantic?(t.block=B.pedantic,t.inline=j.pedantic):this.options.gfm&&(t.block=B.gfm,this.options.breaks?t.inline=j.breaks:t.inline=j.gfm),this.tokenizer.rules=t}static get rules(){return{block:B,inline:j}}static lex(e,t){return new je(t).lex(e)}static lexInline(e,t){return new je(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,o,c)=>o+"    ".repeat(c.length));let n,i,l,s;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+n.raw,i.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(l=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const o=e.slice(1);let c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},o),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(l=e.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(l))){i=t[t.length-1],s&&i.type==="paragraph"?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n),s=l.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,i,l,s=e,a,o,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,a.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(o||(c=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(n=u.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&n.type==="text"&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),i=t[t.length-1],i&&n.type==="text"&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,s,c)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}if(l=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const f=e.slice(1);let h;this.options.extensions.startInline.forEach(d=>{h=d.call({lexer:this},f),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(l=e.substring(0,u+1))}if(n=this.tokenizer.inlineText(l)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(c=n.raw.slice(-1)),o=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}}class Tn{constructor(e){J(this,"options");this.options=e||gt}code(e,t,n){var l;const i=(l=(t||"").match(/^\S*/))==null?void 0:l[0];return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+Ce(i)+'">'+(n?e:Ce(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:Ce(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,n){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,n){const i=t?"ol":"ul",l=t&&n!==1?' start="'+n+'"':"";return"<"+i+l+`>
`+e+"</"+i+`>
`}listitem(e,t,n){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){const i=pi(e);if(i===null)return n;e=i;let l='<a href="'+e+'"';return t&&(l+=' title="'+t+'"'),l+=">"+n+"</a>",l}image(e,t,n){const i=pi(e);if(i===null)return n;e=i;let l=`<img src="${e}" alt="${n}"`;return t&&(l+=` title="${t}"`),l+=">",l}text(e){return e}}class Fr{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class Fe{constructor(e){J(this,"options");J(this,"renderer");J(this,"textRenderer");this.options=e||gt,this.options.renderer=this.options.renderer||new Tn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Fr}static parse(e,t){return new Fe(t).parse(e)}static parseInline(e,t){return new Fe(t).parseInline(e)}parse(e,t=!0){let n="";for(let i=0;i<e.length;i++){const l=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[l.type]){const s=l,a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(s.type)){n+=a||"";continue}}switch(l.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{const s=l;n+=this.renderer.heading(this.parseInline(s.tokens),s.depth,ko(this.parseInline(s.tokens,this.textRenderer)));continue}case"code":{const s=l;n+=this.renderer.code(s.text,s.lang,!!s.escaped);continue}case"table":{const s=l;let a="",o="";for(let u=0;u<s.header.length;u++)o+=this.renderer.tablecell(this.parseInline(s.header[u].tokens),{header:!0,align:s.align[u]});a+=this.renderer.tablerow(o);let c="";for(let u=0;u<s.rows.length;u++){const f=s.rows[u];o="";for(let h=0;h<f.length;h++)o+=this.renderer.tablecell(this.parseInline(f[h].tokens),{header:!1,align:s.align[h]});c+=this.renderer.tablerow(o)}n+=this.renderer.table(a,c);continue}case"blockquote":{const s=l,a=this.parse(s.tokens);n+=this.renderer.blockquote(a);continue}case"list":{const s=l,a=s.ordered,o=s.start,c=s.loose;let u="";for(let f=0;f<s.items.length;f++){const h=s.items[f],d=h.checked,p=h.task;let m="";if(h.task){const _=this.renderer.checkbox(!!d);c?h.tokens.length>0&&h.tokens[0].type==="paragraph"?(h.tokens[0].text=_+" "+h.tokens[0].text,h.tokens[0].tokens&&h.tokens[0].tokens.length>0&&h.tokens[0].tokens[0].type==="text"&&(h.tokens[0].tokens[0].text=_+" "+h.tokens[0].tokens[0].text)):h.tokens.unshift({type:"text",text:_+" "}):m+=_+" "}m+=this.parse(h.tokens,c),u+=this.renderer.listitem(m,p,!!d)}n+=this.renderer.list(u,a,o);continue}case"html":{const s=l;n+=this.renderer.html(s.text,s.block);continue}case"paragraph":{const s=l;n+=this.renderer.paragraph(this.parseInline(s.tokens));continue}case"text":{let s=l,a=s.tokens?this.parseInline(s.tokens):s.text;for(;i+1<e.length&&e[i+1].type==="text";)s=e[++i],a+=`
`+(s.tokens?this.parseInline(s.tokens):s.text);n+=t?this.renderer.paragraph(a):a;continue}default:{const s='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(s),"";throw new Error(s)}}}return n}parseInline(e,t){t=t||this.renderer;let n="";for(let i=0;i<e.length;i++){const l=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[l.type]){const s=this.options.extensions.renderers[l.type].call({parser:this},l);if(s!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){n+=s||"";continue}}switch(l.type){case"escape":{const s=l;n+=t.text(s.text);break}case"html":{const s=l;n+=t.html(s.text);break}case"link":{const s=l;n+=t.link(s.href,s.title,this.parseInline(s.tokens,t));break}case"image":{const s=l;n+=t.image(s.href,s.title,s.text);break}case"strong":{const s=l;n+=t.strong(this.parseInline(s.tokens,t));break}case"em":{const s=l;n+=t.em(this.parseInline(s.tokens,t));break}case"codespan":{const s=l;n+=t.codespan(s.text);break}case"br":{n+=t.br();break}case"del":{const s=l;n+=t.del(this.parseInline(s.tokens,t));break}case"text":{const s=l;n+=t.text(s.text);break}default:{const s='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(s),"";throw new Error(s)}}}return n}}class Kt{constructor(e){J(this,"options");this.options=e||gt}preprocess(e){return e}postprocess(e){return e}}J(Kt,"passThroughHooks",new Set(["preprocess","postprocess"]));var dt,br,Ns;class So{constructor(...e){Nr(this,dt);J(this,"defaults",jr());J(this,"options",this.setOptions);J(this,"parse",Jt(this,dt,br).call(this,je.lex,Fe.parse));J(this,"parseInline",Jt(this,dt,br).call(this,je.lexInline,Fe.parseInline));J(this,"Parser",Fe);J(this,"Renderer",Tn);J(this,"TextRenderer",Fr);J(this,"Lexer",je);J(this,"Tokenizer",In);J(this,"Hooks",Kt);this.use(...e)}walkTokens(e,t){var i,l;let n=[];for(const s of e)switch(n=n.concat(t.call(this,s)),s.type){case"table":{const a=s;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const c of o)n=n.concat(this.walkTokens(c.tokens,t));break}case"list":{const a=s;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=s;(l=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&l[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{n=n.concat(this.walkTokens(a[o],t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(l=>{if(!l.name)throw new Error("extension name required");if("renderer"in l){const s=t.renderers[l.name];s?t.renderers[l.name]=function(...a){let o=l.renderer.apply(this,a);return o===!1&&(o=s.apply(this,a)),o}:t.renderers[l.name]=l.renderer}if("tokenizer"in l){if(!l.level||l.level!=="block"&&l.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=t[l.level];s?s.unshift(l.tokenizer):t[l.level]=[l.tokenizer],l.start&&(l.level==="block"?t.startBlock?t.startBlock.push(l.start):t.startBlock=[l.start]:l.level==="inline"&&(t.startInline?t.startInline.push(l.start):t.startInline=[l.start]))}"childTokens"in l&&l.childTokens&&(t.childTokens[l.name]=l.childTokens)}),i.extensions=t),n.renderer){const l=this.defaults.renderer||new Tn(this.defaults);for(const s in n.renderer){const a=n.renderer[s],o=s,c=l[o];l[o]=(...u)=>{let f=a.apply(l,u);return f===!1&&(f=c.apply(l,u)),f||""}}i.renderer=l}if(n.tokenizer){const l=this.defaults.tokenizer||new In(this.defaults);for(const s in n.tokenizer){const a=n.tokenizer[s],o=s,c=l[o];l[o]=(...u)=>{let f=a.apply(l,u);return f===!1&&(f=c.apply(l,u)),f}}i.tokenizer=l}if(n.hooks){const l=this.defaults.hooks||new Kt;for(const s in n.hooks){const a=n.hooks[s],o=s,c=l[o];Kt.passThroughHooks.has(s)?l[o]=u=>{if(this.defaults.async)return Promise.resolve(a.call(l,u)).then(h=>c.call(l,h));const f=a.call(l,u);return c.call(l,f)}:l[o]=(...u)=>{let f=a.apply(l,u);return f===!1&&(f=c.apply(l,u)),f}}i.hooks=l}if(n.walkTokens){const l=this.defaults.walkTokens,s=n.walkTokens;i.walkTokens=function(a){let o=[];return o.push(s.call(this,a)),l&&(o=o.concat(l.call(this,a))),o}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return je.lex(e,t??this.defaults)}parser(e,t){return Fe.parse(e,t??this.defaults)}}dt=new WeakSet,br=function(e,t){return(n,i)=>{const l={...i},s={...this.defaults,...l};this.defaults.async===!0&&l.async===!1&&(s.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),s.async=!0);const a=Jt(this,dt,Ns).call(this,!!s.silent,!!s.async);if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(s.hooks&&(s.hooks.options=s),s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(n):n).then(o=>e(o,s)).then(o=>s.walkTokens?Promise.all(this.walkTokens(o,s.walkTokens)).then(()=>o):o).then(o=>t(o,s)).then(o=>s.hooks?s.hooks.postprocess(o):o).catch(a);try{s.hooks&&(n=s.hooks.preprocess(n));const o=e(n,s);s.walkTokens&&this.walkTokens(o,s.walkTokens);let c=t(o,s);return s.hooks&&(c=s.hooks.postprocess(c)),c}catch(o){return a(o)}}},Ns=function(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+Ce(n.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(n);throw n}};const ht=new So;function te(r,e){return ht.parse(r,e)}te.options=te.setOptions=function(r){return ht.setOptions(r),te.defaults=ht.defaults,Ls(te.defaults),te};te.getDefaults=jr;te.defaults=gt;te.use=function(...r){return ht.use(...r),te.defaults=ht.defaults,Ls(te.defaults),te};te.walkTokens=function(r,e){return ht.walkTokens(r,e)};te.parseInline=ht.parseInline;te.Parser=Fe;te.parser=Fe.parse;te.Renderer=Tn;te.TextRenderer=Fr;te.Lexer=je;te.lexer=je.lex;te.Tokenizer=In;te.Hooks=Kt;te.parse=te;te.options;te.setOptions;te.use;te.walkTokens;te.parseInline;Fe.parse;je.lex;te.setOptions({breaks:!0,gfm:!0,headerIds:!1,mangle:!1});function Et(r){if(!r)return"";try{return te.parse(r)}catch(e){return console.error("Failed to parse markdown:",e),r.replace(/</g,"&lt;").replace(/>/g,"&gt;")}}function bi(r){let e,t,n;return{c(){e=v("img"),Xe(e.src,t=r[0].depiction)||y(e,"src",t),y(e,"alt",n=r[0].title||"Post image"),y(e,"class","w-full max-w-3xl mb-6 rounded")},m(i,l){T(i,e,l)},p(i,l){l&1&&!Xe(e.src,t=i[0].depiction)&&y(e,"src",t),l&1&&n!==(n=i[0].title||"Post image")&&y(e,"alt",n)},d(i){i&&I(e)}}}function yi(r){let e,t=Et(r[0].content)+"";return{c(){e=v("div"),y(e,"class","prose prose-invert max-w-none")},m(n,i){T(n,e,i),e.innerHTML=t},p(n,i){i&1&&t!==(t=Et(n[0].content)+"")&&(e.innerHTML=t)},d(n){n&&I(e)}}}function Co(r){let e;return{c(){e=K("← Back to home")},m(t,n){T(t,e,n)},d(t){t&&I(e)}}}function Po(r){let e,t,n,i=(r[0].title||r[0].slug||"Untitled")+"",l,s,a,o,c,u,f,h=new Date(r[0].createdAt).toLocaleString()+"",d,p,m,_,g=new Date(r[0].updatedAt).toLocaleString()+"",w,x,k,$,C=r[0].depiction&&bi(r),E=r[0].content&&yi(r);return k=new Re({props:{to:"/",className:"text-xs text-white/60 hover:text-white underline",$$slots:{default:[Co]},$$scope:{ctx:r}}}),{c(){e=v("div"),t=v("div"),n=v("h1"),l=K(i),s=R(),C&&C.c(),a=R(),E&&E.c(),o=R(),c=v("div"),u=v("div"),f=K("Created: "),d=K(h),p=R(),m=v("div"),_=K("Updated: "),w=K(g),x=R(),Q(k.$$.fragment),y(n,"class","text-2xl mb-4"),y(c,"class","mt-8 text-xs text-white/40 border-t border-white/10 pt-4"),y(t,"class","mb-8")},m(D,S){T(D,e,S),b(e,t),b(t,n),b(n,l),b(t,s),C&&C.m(t,null),b(t,a),E&&E.m(t,null),b(t,o),b(t,c),b(c,u),b(u,f),b(u,d),b(c,p),b(c,m),b(m,_),b(m,w),b(e,x),U(k,e,null),$=!0},p(D,[S]){(!$||S&1)&&i!==(i=(D[0].title||D[0].slug||"Untitled")+"")&&G(l,i),D[0].depiction?C?C.p(D,S):(C=bi(D),C.c(),C.m(t,a)):C&&(C.d(1),C=null),D[0].content?E?E.p(D,S):(E=yi(D),E.c(),E.m(t,o)):E&&(E.d(1),E=null),(!$||S&1)&&h!==(h=new Date(D[0].createdAt).toLocaleString()+"")&&G(d,h),(!$||S&1)&&g!==(g=new Date(D[0].updatedAt).toLocaleString()+"")&&G(w,g);const L={};S&2&&(L.$$scope={dirty:S,ctx:D}),k.$set(L)},i(D){$||(P(k.$$.fragment,D),$=!0)},o(D){A(k.$$.fragment,D),$=!1},d(D){D&&I(e),C&&C.d(),E&&E.d(),z(k)}}}function Io(r,e,t){let{entity:n}=e;return r.$$set=i=>{"entity"in i&&t(0,n=i.entity)},[n]}class To extends fe{constructor(e){super(),he(this,e,Io,Po,de,{entity:0})}}function Ao(r){let e,t,n,i,l,s,a,o,c,u,f,h,d;return{c(){e=v("form"),t=v("div"),n=v("input"),i=R(),l=v("div"),s=v("textarea"),a=R(),o=v("div"),c=v("button"),c.textContent="Post",u=R(),f=v("button"),f.textContent="Cancel",y(n,"type","text"),y(n,"placeholder","Title"),y(n,"class","w-full bg-black border-b border-white/20 pb-1 text-sm focus:outline-none focus:border-white"),y(s,"placeholder","Content (optional)"),y(s,"rows","4"),y(s,"class","w-full bg-black border border-white/20 p-2 text-sm focus:outline-none focus:border-white resize-none"),y(c,"type","submit"),y(c,"class","text-xs uppercase tracking-wider border border-white/20 px-3 py-1 hover:bg-white hover:text-black transition-colors"),y(f,"type","button"),y(f,"class","text-xs uppercase tracking-wider text-white/60 hover:text-white"),y(o,"class","flex gap-2"),y(e,"class","border border-white/20 p-4 space-y-3")},m(p,m){T(p,e,m),b(e,t),b(t,n),W(n,r[0]),b(e,i),b(e,l),b(l,s),W(s,r[1]),b(e,a),b(e,o),b(o,c),b(o,u),b(o,f),h||(d=[ee(n,"input",r[4]),ee(s,"input",r[5]),ee(f,"click",r[3]),ee(e,"submit",r[2])],h=!0)},p(p,[m]){m&1&&n.value!==p[0]&&W(n,p[0]),m&2&&W(s,p[1])},i:H,o:H,d(p){p&&I(e),h=!1,St(d)}}}function Do(r,e,t){let{title:n=""}=e,{content:i=""}=e;const l=Ke();function s(u){u.preventDefault(),l("submit",{title:n,content:i})}function a(){l("cancel")}function o(){n=this.value,t(0,n)}function c(){i=this.value,t(1,i)}return r.$$set=u=>{"title"in u&&t(0,n=u.title),"content"in u&&t(1,i=u.content)},[n,i,s,a,o,c]}class Ro extends fe{constructor(e){super(),he(this,e,Do,Ao,de,{title:0,content:1})}}function _i(r){let e,t=Et(r[0].content)+"";return{c(){e=v("div"),y(e,"class","text-sm text-white/60 prose-content")},m(n,i){T(n,e,i),e.innerHTML=t},p(n,i){i&1&&t!==(t=Et(n[0].content)+"")&&(e.innerHTML=t)},d(n){n&&I(e)}}}function wi(r){let e,t,n,i=r[3].features.allowCreate&&r[4]&&!r[2]&&vi(r),l=r[2]&&ki(r);return{c(){e=v("div"),i&&i.c(),t=R(),l&&l.c(),y(e,"class","mb-6")},m(s,a){T(s,e,a),i&&i.m(e,null),b(e,t),l&&l.m(e,null),n=!0},p(s,a){s[3].features.allowCreate&&s[4]&&!s[2]?i?i.p(s,a):(i=vi(s),i.c(),i.m(e,t)):i&&(i.d(1),i=null),s[2]?l?(l.p(s,a),a&4&&P(l,1)):(l=ki(s),l.c(),P(l,1),l.m(e,null)):l&&(se(),A(l,1,1,()=>{l=null}),le())},i(s){n||(P(l),n=!0)},o(s){A(l),n=!1},d(s){s&&I(e),i&&i.d(),l&&l.d()}}}function vi(r){let e,t,n;return{c(){e=v("button"),e.textContent="New Post",y(e,"class","text-xs uppercase tracking-wider border border-white/20 px-3 py-1 hover:bg-white hover:text-black transition-colors")},m(i,l){T(i,e,l),t||(n=ee(e,"click",r[6]),t=!0)},p:H,d(i){i&&I(e),t=!1,n()}}}function ki(r){let e,t;return e=new Ro({}),e.$on("submit",r[5]),e.$on("cancel",r[7]),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p:H,i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function Oo(r){let e,t,n=(r[0].title||r[0].slug||"Untitled")+"",i,l,s,a,o,c,u,f,h=r[0].content&&_i(r),d=r[0].type==="group"&&r[1]&&wi(r);return{c(){e=v("div"),t=v("h1"),i=K(n),l=R(),h&&h.c(),s=R(),d&&d.c(),a=R(),o=v("hr"),c=R(),u=v("br"),y(t,"class","text-lg mb-2"),y(e,"class","mb-8")},m(p,m){T(p,e,m),b(e,t),b(t,i),b(e,l),h&&h.m(e,null),T(p,s,m),d&&d.m(p,m),T(p,a,m),T(p,o,m),T(p,c,m),T(p,u,m),f=!0},p(p,[m]){(!f||m&1)&&n!==(n=(p[0].title||p[0].slug||"Untitled")+"")&&G(i,n),p[0].content?h?h.p(p,m):(h=_i(p),h.c(),h.m(e,null)):h&&(h.d(1),h=null),p[0].type==="group"&&p[1]?d?(d.p(p,m),m&3&&P(d,1)):(d=wi(p),d.c(),P(d,1),d.m(a.parentNode,a)):d&&(se(),A(d,1,1,()=>{d=null}),le())},i(p){f||(P(d),f=!0)},o(p){A(d),f=!1},d(p){p&&(I(e),I(s),I(a),I(o),I(c),I(u)),h&&h.d(),d&&d.d(p)}}}function jo(r,e,t){let n,i;Le(r,De,h=>t(3,n=h)),Le(r,xt,h=>t(4,i=h));let{entity:l}=e,{showNewPostButton:s=!0}=e;const a=Ke();let o=!1;function c(h){a("createPost",h.detail),t(2,o=!1)}const u=()=>t(2,o=!0),f=()=>t(2,o=!1);return r.$$set=h=>{"entity"in h&&t(0,l=h.entity),"showNewPostButton"in h&&t(1,s=h.showNewPostButton)},[l,s,o,n,i,c,u,f]}class On extends fe{constructor(e){super(),he(this,e,jo,Oo,de,{entity:0,showNewPostButton:1})}}function xi(r,e,t){const n=r.slice();return n[4]=e[t],n}function Fo(r){let e;return{c(){e=v("div"),e.textContent="No content in this group yet",y(e,"class","text-xs text-white/60")},m(t,n){T(t,e,n)},p:H,i:H,o:H,d(t){t&&I(e)}}}function Lo(r){let e,t,n=ve(r[1]),i=[];for(let s=0;s<n.length;s+=1)i[s]=Si(xi(r,n,s));const l=s=>A(i[s],1,1,()=>{i[s]=null});return{c(){e=v("div");for(let s=0;s<i.length;s+=1)i[s].c();y(e,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4")},m(s,a){T(s,e,a);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null);t=!0},p(s,a){if(a&2){n=ve(s[1]);let o;for(o=0;o<n.length;o+=1){const c=xi(s,n,o);i[o]?(i[o].p(c,a),P(i[o],1)):(i[o]=Si(c),i[o].c(),P(i[o],1),i[o].m(e,null))}for(se(),o=n.length;o<i.length;o+=1)l(o);le()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)P(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)A(i[a]);t=!1},d(s){s&&I(e),rt(i,s)}}}function $i(r){let e,t,n;return{c(){e=v("img"),Xe(e.src,t=r[4].depiction)||y(e,"src",t),y(e,"alt",n=r[4].title||"Image"),y(e,"class","w-full h-48 object-cover")},m(i,l){T(i,e,l)},p(i,l){l&2&&!Xe(e.src,t=i[4].depiction)&&y(e,"src",t),l&2&&n!==(n=i[4].title||"Image")&&y(e,"alt",n)},d(i){i&&I(e)}}}function Ei(r){let e,t=r[4].content+"",n;return{c(){e=v("p"),n=K(t),y(e,"class","text-xs text-white/60 line-clamp-3")},m(i,l){T(i,e,l),b(e,n)},p(i,l){l&2&&t!==(t=i[4].content+"")&&G(n,t)},d(i){i&&I(e)}}}function Bo(r){let e,t,n,i=(r[4].title||r[4].slug||"Untitled")+"",l,s,a,o=r[4].depiction&&$i(r),c=r[4].content&&Ei(r);return{c(){o&&o.c(),e=R(),t=v("div"),n=v("h3"),l=K(i),s=R(),c&&c.c(),a=R(),y(n,"class","text-sm font-medium mb-2"),y(t,"class","p-4")},m(u,f){o&&o.m(u,f),T(u,e,f),T(u,t,f),b(t,n),b(n,l),b(t,s),c&&c.m(t,null),T(u,a,f)},p(u,f){u[4].depiction?o?o.p(u,f):(o=$i(u),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),f&2&&i!==(i=(u[4].title||u[4].slug||"Untitled")+"")&&G(l,i),u[4].content?c?c.p(u,f):(c=Ei(u),c.c(),c.m(t,null)):c&&(c.d(1),c=null)},d(u){u&&(I(e),I(t),I(a)),o&&o.d(u),c&&c.d()}}}function Si(r){let e,t;return e=new Re({props:{to:r[4].slug||`/${r[4].id}`,className:"block border border-white/20 hover:border-white/40 transition-colors overflow-hidden",$$slots:{default:[Bo]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&2&&(l.to=n[4].slug||`/${n[4].id}`),i&130&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function Ko(r){let e,t,n,i,l,s;e=new On({props:{entity:r[0]}}),e.$on("createPost",r[2]);const a=[Lo,Fo],o=[];function c(u,f){return u[1].length>0?0:u[0].type==="group"?1:-1}return~(n=c(r))&&(i=o[n]=a[n](r)),{c(){Q(e.$$.fragment),t=R(),i&&i.c(),l=Ie()},m(u,f){U(e,u,f),T(u,t,f),~n&&o[n].m(u,f),T(u,l,f),s=!0},p(u,[f]){const h={};f&1&&(h.entity=u[0]),e.$set(h);let d=n;n=c(u),n===d?~n&&o[n].p(u,f):(i&&(se(),A(o[d],1,1,()=>{o[d]=null}),le()),~n?(i=o[n],i?i.p(u,f):(i=o[n]=a[n](u),i.c()),P(i,1),i.m(l.parentNode,l)):i=null)},i(u){s||(P(e.$$.fragment,u),P(i),s=!0)},o(u){A(e.$$.fragment,u),A(i),s=!1},d(u){u&&(I(t),I(l)),z(e,u),~n&&o[n].d(u)}}}function No(r,e,t){let{entity:n}=e,{children:i=[]}=e;const l=Ke();function s(a){l("createPost",a.detail)}return r.$$set=a=>{"entity"in a&&t(0,n=a.entity),"children"in a&&t(1,i=a.children)},[n,i,s]}class qo extends fe{constructor(e){super(),he(this,e,No,Ko,de,{entity:0,children:1})}}function Ci(r,e,t){const n=r.slice();return n[5]=e[t],n}function Mo(r){let e;return{c(){e=v("div"),e.textContent="No content in this group yet",y(e,"class","text-xs text-white/60")},m(t,n){T(t,e,n)},p:H,i:H,o:H,d(t){t&&I(e)}}}function zo(r){let e,t,n=ve(r[1]),i=[];for(let s=0;s<n.length;s+=1)i[s]=Ii(Ci(r,n,s));const l=s=>A(i[s],1,1,()=>{i[s]=null});return{c(){e=v("div");for(let s=0;s<i.length;s+=1)i[s].c();y(e,"class","space-y-2")},m(s,a){T(s,e,a);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null);t=!0},p(s,a){if(a&10){n=ve(s[1]);let o;for(o=0;o<n.length;o+=1){const c=Ci(s,n,o);i[o]?(i[o].p(c,a),P(i[o],1)):(i[o]=Ii(c),i[o].c(),P(i[o],1),i[o].m(e,null))}for(se(),o=n.length;o<i.length;o+=1)l(o);le()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)P(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)A(i[a]);t=!1},d(s){s&&I(e),rt(i,s)}}}function Pi(r){let e,t=r[3](r[5].content)+"",n;return{c(){e=v("span"),n=K(t),y(e,"class","text-xs text-white/60 ml-2")},m(i,l){T(i,e,l),b(e,n)},p(i,l){l&2&&t!==(t=i[3](i[5].content)+"")&&G(n,t)},d(i){i&&I(e)}}}function Uo(r){let e,t,n,i=(r[5].title||r[5].slug||"Untitled")+"",l,s,a,o,c=Ti(r[5].updatedAt)+"",u,f,h=r[5].content&&Pi(r);return{c(){e=v("div"),t=v("div"),n=v("h3"),l=K(i),s=R(),h&&h.c(),a=R(),o=v("span"),u=K(c),f=R(),y(n,"class","text-sm font-medium inline"),y(t,"class","flex-grow"),y(o,"class","text-xs text-white/40"),y(e,"class","flex items-baseline gap-3")},m(d,p){T(d,e,p),b(e,t),b(t,n),b(n,l),b(t,s),h&&h.m(t,null),b(e,a),b(e,o),b(o,u),T(d,f,p)},p(d,p){p&2&&i!==(i=(d[5].title||d[5].slug||"Untitled")+"")&&G(l,i),d[5].content?h?h.p(d,p):(h=Pi(d),h.c(),h.m(t,null)):h&&(h.d(1),h=null),p&2&&c!==(c=Ti(d[5].updatedAt)+"")&&G(u,c)},d(d){d&&(I(e),I(f)),h&&h.d()}}}function Ii(r){let e,t;return e=new Re({props:{to:r[5].slug||`/${r[5].id}`,className:"block border-b border-white/10 pb-2 hover:border-white/30 transition-colors",$$slots:{default:[Uo]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&2&&(l.to=n[5].slug||`/${n[5].id}`),i&258&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function Qo(r){let e,t,n,i,l,s;e=new On({props:{entity:r[0]}}),e.$on("createPost",r[2]);const a=[zo,Mo],o=[];function c(u,f){return u[1].length>0?0:u[0].type==="group"?1:-1}return~(n=c(r))&&(i=o[n]=a[n](r)),{c(){Q(e.$$.fragment),t=R(),i&&i.c(),l=Ie()},m(u,f){U(e,u,f),T(u,t,f),~n&&o[n].m(u,f),T(u,l,f),s=!0},p(u,[f]){const h={};f&1&&(h.entity=u[0]),e.$set(h);let d=n;n=c(u),n===d?~n&&o[n].p(u,f):(i&&(se(),A(o[d],1,1,()=>{o[d]=null}),le()),~n?(i=o[n],i?i.p(u,f):(i=o[n]=a[n](u),i.c()),P(i,1),i.m(l.parentNode,l)):i=null)},i(u){s||(P(e.$$.fragment,u),P(i),s=!0)},o(u){A(e.$$.fragment,u),A(i),s=!1},d(u){u&&(I(t),I(l)),z(e,u),~n&&o[n].d(u)}}}function Ho(r){const e=document.createElement("div");return e.innerHTML=r,e.textContent||e.innerText||""}function Ti(r){const t=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"2-digit"}),[n,i]=t.split(",");return i+" "+n}function Wo(r,e,t){let{entity:n}=e,{children:i=[]}=e;const l=Ke();function s(o){l("createPost",o.detail)}function a(o){const c=Et(o),u=Ho(c);return u.substring(0,100)+(u.length>100?"...":"")}return r.$$set=o=>{"entity"in o&&t(0,n=o.entity),"children"in o&&t(1,i=o.children)},[n,i,s,a]}class Vo extends fe{constructor(e){super(),he(this,e,Wo,Qo,de,{entity:0,children:1})}}function Ai(r,e,t){const n=r.slice();return n[5]=e[t],n}function Go(r){let e;return{c(){e=v("div"),e.textContent="No content in this group yet",y(e,"class","text-xs text-white/60")},m(t,n){T(t,e,n)},p:H,i:H,o:H,d(t){t&&I(e)}}}function Zo(r){let e,t,n=ve(r[1]),i=[];for(let s=0;s<n.length;s+=1)i[s]=Oi(Ai(r,n,s));const l=s=>A(i[s],1,1,()=>{i[s]=null});return{c(){e=v("div");for(let s=0;s<i.length;s+=1)i[s].c();y(e,"class","space-y-6")},m(s,a){T(s,e,a);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null);t=!0},p(s,a){if(a&10){n=ve(s[1]);let o;for(o=0;o<n.length;o+=1){const c=Ai(s,n,o);i[o]?(i[o].p(c,a),P(i[o],1)):(i[o]=Oi(c),i[o].c(),P(i[o],1),i[o].m(e,null))}for(se(),o=n.length;o<i.length;o+=1)l(o);le()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)P(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)A(i[a]);t=!1},d(s){s&&I(e),rt(i,s)}}}function Di(r){let e,t,n;return{c(){e=v("img"),Xe(e.src,t=r[5].depiction)||y(e,"src",t),y(e,"alt",n=r[5].title||"Image"),y(e,"class","w-full h-64 object-cover")},m(i,l){T(i,e,l)},p(i,l){l&2&&!Xe(e.src,t=i[5].depiction)&&y(e,"src",t),l&2&&n!==(n=i[5].title||"Image")&&y(e,"alt",n)},d(i){i&&I(e)}}}function Ri(r){let e,t=r[3](r[5].content)+"",n;return{c(){e=v("p"),n=K(t),y(e,"class","text-sm text-white/70 leading-relaxed")},m(i,l){T(i,e,l),b(e,n)},p(i,l){l&2&&t!==(t=i[3](i[5].content)+"")&&G(n,t)},d(i){i&&I(e)}}}function Yo(r){let e,t,n,i,l,s=r[5].type+"",a,o,c,u=(r[5].title||r[5].slug||"Untitled")+"",f,h,d,p=new Date(r[5].createdAt).toLocaleDateString()+"",m,_,g,w,x,k=new Date(r[5].updatedAt).toLocaleString()+"",$,C,E=r[5].depiction&&Di(r),D=r[5].content&&Ri(r);return{c(){E&&E.c(),e=R(),t=v("div"),n=v("div"),i=v("div"),l=v("span"),a=K(s),o=R(),c=v("h3"),f=K(u),h=R(),d=v("span"),m=K(p),_=R(),D&&D.c(),g=R(),w=v("div"),x=K("Last updated: "),$=K(k),C=R(),y(l,"class","text-xs text-white/60 uppercase tracking-wider"),y(c,"class","text-lg font-medium mt-1"),y(d,"class","text-xs text-white/40"),y(n,"class","flex items-start justify-between mb-3"),y(w,"class","mt-4 text-xs text-white/40"),y(t,"class","p-6")},m(S,L){E&&E.m(S,L),T(S,e,L),T(S,t,L),b(t,n),b(n,i),b(i,l),b(l,a),b(i,o),b(i,c),b(c,f),b(n,h),b(n,d),b(d,m),b(t,_),D&&D.m(t,null),b(t,g),b(t,w),b(w,x),b(w,$),T(S,C,L)},p(S,L){S[5].depiction?E?E.p(S,L):(E=Di(S),E.c(),E.m(e.parentNode,e)):E&&(E.d(1),E=null),L&2&&s!==(s=S[5].type+"")&&G(a,s),L&2&&u!==(u=(S[5].title||S[5].slug||"Untitled")+"")&&G(f,u),L&2&&p!==(p=new Date(S[5].createdAt).toLocaleDateString()+"")&&G(m,p),S[5].content?D?D.p(S,L):(D=Ri(S),D.c(),D.m(t,g)):D&&(D.d(1),D=null),L&2&&k!==(k=new Date(S[5].updatedAt).toLocaleString()+"")&&G($,k)},d(S){S&&(I(e),I(t),I(C)),E&&E.d(S),D&&D.d()}}}function Oi(r){let e,t;return e=new Re({props:{to:r[5].slug||`/${r[5].id}`,className:"block bg-white/5 rounded-lg overflow-hidden hover:bg-white/10 transition-colors",$$slots:{default:[Yo]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&2&&(l.to=n[5].slug||`/${n[5].id}`),i&258&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function Jo(r){let e,t,n,i,l,s;e=new On({props:{entity:r[0]}}),e.$on("createPost",r[2]);const a=[Zo,Go],o=[];function c(u,f){return u[1].length>0?0:u[0].type==="group"?1:-1}return~(n=c(r))&&(i=o[n]=a[n](r)),{c(){Q(e.$$.fragment),t=R(),i&&i.c(),l=Ie()},m(u,f){U(e,u,f),T(u,t,f),~n&&o[n].m(u,f),T(u,l,f),s=!0},p(u,[f]){const h={};f&1&&(h.entity=u[0]),e.$set(h);let d=n;n=c(u),n===d?~n&&o[n].p(u,f):(i&&(se(),A(o[d],1,1,()=>{o[d]=null}),le()),~n?(i=o[n],i?i.p(u,f):(i=o[n]=a[n](u),i.c()),P(i,1),i.m(l.parentNode,l)):i=null)},i(u){s||(P(e.$$.fragment,u),P(i),s=!0)},o(u){A(e.$$.fragment,u),A(i),s=!1},d(u){u&&(I(t),I(l)),z(e,u),~n&&o[n].d(u)}}}function Xo(r){const e=document.createElement("div");return e.innerHTML=r,e.textContent||e.innerText||""}function ea(r,e,t){let{entity:n}=e,{children:i=[]}=e;const l=Ke();function s(o){l("createPost",o.detail)}function a(o,c=200){const u=Et(o),f=Xo(u);return f.substring(0,c)+(f.length>c?"...":"")}return r.$$set=o=>{"entity"in o&&t(0,n=o.entity),"children"in o&&t(1,i=o.children)},[n,i,s,a]}class ta extends fe{constructor(e){super(),he(this,e,ea,Jo,de,{entity:0,children:1})}}function ji(r,e,t){const n=r.slice();return n[4]=e[t],n}function na(r){let e;return{c(){e=v("div"),e.textContent="No content in this group yet",y(e,"class","text-xs text-white/60")},m(t,n){T(t,e,n)},p:H,i:H,o:H,d(t){t&&I(e)}}}function ra(r){let e,t,n=ve(r[1]),i=[];for(let s=0;s<n.length;s+=1)i[s]=Ki(ji(r,n,s));const l=s=>A(i[s],1,1,()=>{i[s]=null});return{c(){e=v("div");for(let s=0;s<i.length;s+=1)i[s].c();y(e,"class","space-y-4")},m(s,a){T(s,e,a);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null);t=!0},p(s,a){if(a&2){n=ve(s[1]);let o;for(o=0;o<n.length;o+=1){const c=ji(s,n,o);i[o]?(i[o].p(c,a),P(i[o],1)):(i[o]=Ki(c),i[o].c(),P(i[o],1),i[o].m(e,null))}for(se(),o=n.length;o<i.length;o+=1)l(o);le()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)P(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)A(i[a]);t=!1},d(s){s&&I(e),rt(i,s)}}}function ia(r){let e,t,n,i,l;t=new Re({props:{to:r[4].slug||`/${r[4].id}`,className:"hover:underline",$$slots:{default:[la]},$$scope:{ctx:r}}});let s=r[4].content&&Fi(r);return{c(){e=v("div"),Q(t.$$.fragment),n=R(),s&&s.c(),i=R(),y(e,"class","border-b border-white/10 pb-4")},m(a,o){T(a,e,o),U(t,e,null),b(e,n),s&&s.m(e,null),b(e,i),l=!0},p(a,o){const c={};o&2&&(c.to=a[4].slug||`/${a[4].id}`),o&130&&(c.$$scope={dirty:o,ctx:a}),t.$set(c),a[4].content?s?s.p(a,o):(s=Fi(a),s.c(),s.m(e,i)):s&&(s.d(1),s=null)},i(a){l||(P(t.$$.fragment,a),l=!0)},o(a){A(t.$$.fragment,a),l=!1},d(a){a&&I(e),z(t),s&&s.d()}}}function sa(r){let e,t,n,i;return t=new Re({props:{to:r[4].slug||`/${r[4].id}`,className:"block hover:opacity-80 transition-opacity",$$slots:{default:[oa]},$$scope:{ctx:r}}}),{c(){e=v("div"),Q(t.$$.fragment),n=R(),y(e,"class","border-b border-white/10 pb-4")},m(l,s){T(l,e,s),U(t,e,null),b(e,n),i=!0},p(l,s){const a={};s&2&&(a.to=l[4].slug||`/${l[4].id}`),s&130&&(a.$$scope={dirty:s,ctx:l}),t.$set(a)},i(l){i||(P(t.$$.fragment,l),i=!0)},o(l){A(t.$$.fragment,l),i=!1},d(l){l&&I(e),z(t)}}}function la(r){let e,t,n,i=r[4].type+"",l,s,a,o,c=(r[4].title||r[4].slug||"Untitled")+"",u;return{c(){e=v("div"),t=v("span"),n=K("["),l=K(i),s=K("]"),a=R(),o=v("span"),u=K(c),y(t,"class","text-xs text-white/60"),y(o,"class","text-sm font-medium"),y(e,"class","flex items-baseline gap-2")},m(f,h){T(f,e,h),b(e,t),b(t,n),b(t,l),b(t,s),b(e,a),b(e,o),b(o,u)},p(f,h){h&2&&i!==(i=f[4].type+"")&&G(l,i),h&2&&c!==(c=(f[4].title||f[4].slug||"Untitled")+"")&&G(u,c)},d(f){f&&I(e)}}}function Fi(r){let e,t=r[4].content+"",n;return{c(){e=v("p"),n=K(t),y(e,"class","text-xs text-white/60 mt-1 line-clamp-2")},m(i,l){T(i,e,l),b(e,n)},p(i,l){l&2&&t!==(t=i[4].content+"")&&G(n,t)},d(i){i&&I(e)}}}function Li(r){let e,t,n;return{c(){e=v("img"),Xe(e.src,t=r[4].depiction)||y(e,"src",t),y(e,"alt",n=r[4].title||"Post image"),y(e,"class","w-24 h-24 object-cover flex-shrink-0")},m(i,l){T(i,e,l)},p(i,l){l&2&&!Xe(e.src,t=i[4].depiction)&&y(e,"src",t),l&2&&n!==(n=i[4].title||"Post image")&&y(e,"alt",n)},d(i){i&&I(e)}}}function Bi(r){let e,t=r[4].content+"",n;return{c(){e=v("p"),n=K(t),y(e,"class","text-xs text-white/60 line-clamp-2")},m(i,l){T(i,e,l),b(e,n)},p(i,l){l&2&&t!==(t=i[4].content+"")&&G(n,t)},d(i){i&&I(e)}}}function oa(r){let e,t,n,i,l=(r[4].title||"Untitled")+"",s,a,o,c,u=new Date(r[4].createdAt).toLocaleDateString()+"",f,h=r[4].depiction&&Li(r),d=r[4].content&&Bi(r);return{c(){e=v("div"),h&&h.c(),t=R(),n=v("div"),i=v("h3"),s=K(l),a=R(),d&&d.c(),o=R(),c=v("div"),f=K(u),y(i,"class","text-sm font-medium mb-1"),y(c,"class","text-xs text-white/40 mt-2"),y(n,"class","flex-1"),y(e,"class","flex gap-4")},m(p,m){T(p,e,m),h&&h.m(e,null),b(e,t),b(e,n),b(n,i),b(i,s),b(n,a),d&&d.m(n,null),b(n,o),b(n,c),b(c,f)},p(p,m){p[4].depiction?h?h.p(p,m):(h=Li(p),h.c(),h.m(e,t)):h&&(h.d(1),h=null),m&2&&l!==(l=(p[4].title||"Untitled")+"")&&G(s,l),p[4].content?d?d.p(p,m):(d=Bi(p),d.c(),d.m(n,o)):d&&(d.d(1),d=null),m&2&&u!==(u=new Date(p[4].createdAt).toLocaleDateString()+"")&&G(f,u)},d(p){p&&I(e),h&&h.d(),d&&d.d()}}}function Ki(r){let e,t,n,i;const l=[sa,ia],s=[];function a(o,c){return o[4].type==="post"?0:1}return e=a(r),t=s[e]=l[e](r),{c(){t.c(),n=Ie()},m(o,c){s[e].m(o,c),T(o,n,c),i=!0},p(o,c){let u=e;e=a(o),e===u?s[e].p(o,c):(se(),A(s[u],1,1,()=>{s[u]=null}),le(),t=s[e],t?t.p(o,c):(t=s[e]=l[e](o),t.c()),P(t,1),t.m(n.parentNode,n))},i(o){i||(P(t),i=!0)},o(o){A(t),i=!1},d(o){o&&I(n),s[e].d(o)}}}function aa(r){let e,t,n,i,l,s;e=new On({props:{entity:r[0]}}),e.$on("createPost",r[2]);const a=[ra,na],o=[];function c(u,f){return u[1].length>0?0:u[0].type==="group"?1:-1}return~(n=c(r))&&(i=o[n]=a[n](r)),{c(){Q(e.$$.fragment),t=R(),i&&i.c(),l=Ie()},m(u,f){U(e,u,f),T(u,t,f),~n&&o[n].m(u,f),T(u,l,f),s=!0},p(u,[f]){const h={};f&1&&(h.entity=u[0]),e.$set(h);let d=n;n=c(u),n===d?~n&&o[n].p(u,f):(i&&(se(),A(o[d],1,1,()=>{o[d]=null}),le()),~n?(i=o[n],i?i.p(u,f):(i=o[n]=a[n](u),i.c()),P(i,1),i.m(l.parentNode,l)):i=null)},i(u){s||(P(e.$$.fragment,u),P(i),s=!0)},o(u){A(e.$$.fragment,u),A(i),s=!1},d(u){u&&(I(t),I(l)),z(e,u),~n&&o[n].d(u)}}}function ua(r,e,t){let{entity:n}=e,{children:i=[]}=e;const l=Ke();function s(a){l("createPost",a.detail)}return r.$$set=a=>{"entity"in a&&t(0,n=a.entity),"children"in a&&t(1,i=a.children)},[n,i,s]}class ca extends fe{constructor(e){super(),he(this,e,ua,aa,de,{entity:0,children:1})}}function fa(r){let e,t;return e=new ca({props:{entity:r[0],children:r[1]}}),e.$on("createPost",r[4]),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1&&(l.entity=n[0]),i&2&&(l.children=n[1]),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function ha(r){let e,t;return e=new Vo({props:{entity:r[0],children:r[1]}}),e.$on("createPost",r[4]),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1&&(l.entity=n[0]),i&2&&(l.children=n[1]),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function da(r){let e,t;return e=new ta({props:{entity:r[0],children:r[1]}}),e.$on("createPost",r[4]),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1&&(l.entity=n[0]),i&2&&(l.children=n[1]),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function pa(r){let e,t;return e=new qo({props:{entity:r[0],children:r[1]}}),e.$on("createPost",r[4]),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1&&(l.entity=n[0]),i&2&&(l.children=n[1]),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function ga(r){let e,t;return e=new To({props:{entity:r[0]}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1&&(l.entity=n[0]),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function ma(r){let e,t,n,i,l;return i=new Re({props:{to:"/",className:"text-xs text-white/60 hover:text-white underline",$$slots:{default:[_a]},$$scope:{ctx:r}}}),{c(){e=v("div"),t=v("div"),t.textContent="Page not found",n=R(),Q(i.$$.fragment),y(t,"class","text-sm text-white/60"),y(e,"class","space-y-4")},m(s,a){T(s,e,a),b(e,t),b(e,n),U(i,e,null),l=!0},p(s,a){const o={};a&16384&&(o.$$scope={dirty:a,ctx:s}),i.$set(o)},i(s){l||(P(i.$$.fragment,s),l=!0)},o(s){A(i.$$.fragment,s),l=!1},d(s){s&&I(e),z(i)}}}function ba(r){let e,t,n,i,l,s;return l=new Re({props:{to:"/",className:"text-xs text-white/60 hover:text-white underline",$$slots:{default:[wa]},$$scope:{ctx:r}}}),{c(){e=v("div"),t=v("div"),n=K(r[3]),i=R(),Q(l.$$.fragment),y(t,"class","text-sm text-red-400"),y(e,"class","space-y-4")},m(a,o){T(a,e,o),b(e,t),b(t,n),b(e,i),U(l,e,null),s=!0},p(a,o){(!s||o&8)&&G(n,a[3]);const c={};o&16384&&(c.$$scope={dirty:o,ctx:a}),l.$set(c)},i(a){s||(P(l.$$.fragment,a),s=!0)},o(a){A(l.$$.fragment,a),s=!1},d(a){a&&I(e),z(l)}}}function ya(r){let e;return{c(){e=v("div"),e.textContent="Loading...",y(e,"class","text-xs text-white/60")},m(t,n){T(t,e,n)},p:H,i:H,o:H,d(t){t&&I(e)}}}function _a(r){let e;return{c(){e=K("← Back to home")},m(t,n){T(t,e,n)},d(t){t&&I(e)}}}function wa(r){let e;return{c(){e=K("← Back to home")},m(t,n){T(t,e,n)},d(t){t&&I(e)}}}function va(r){let e,t,n,i;const l=[ya,ba,ma,ga,pa,da,ha,fa],s=[];function a(o,c){return o[2]?0:o[3]?1:o[0]?o[0].type==="post"?3:o[0].view==="grid"?4:o[0].view==="cards"?5:o[0].view==="list"?6:7:2}return e=a(r),t=s[e]=l[e](r),{c(){t.c(),n=Ie()},m(o,c){s[e].m(o,c),T(o,n,c),i=!0},p(o,[c]){let u=e;e=a(o),e===u?s[e].p(o,c):(se(),A(s[u],1,1,()=>{s[u]=null}),le(),t=s[e],t?t.p(o,c):(t=s[e]=l[e](o),t.c()),P(t,1),t.m(n.parentNode,n))},i(o){i||(P(t),i=!0)},o(o){A(t),i=!1},d(o){o&&I(n),s[e].d(o)}}}function ka(r,e,t){let n,i,l;Le(r,xt,g=>t(12,i=g)),Le(r,De,g=>t(11,l=g));let{path:s="/"}=e,{wildcard:a=""}=e,o=n==="query"?s:a||"/",c=null,u=[],f=!0,h=null,d=null,p=!1;async function m(g){var w,x;if(d!==g){t(9,p=!0),t(8,d=g),t(2,f=!0),t(3,h=null),t(0,c=null),t(1,u=[]);try{const k=g.startsWith("/")?g:`/${g}`,$=await Be.getEntityBySlug(k);if(!$)throw new Error(`Entity not found: ${k}`);if(t(0,c=$),c.type==="group")try{const C=await Be.queryEntities({parentId:c.id,limit:100});t(1,u=(C||[]).sort((E,D)=>{const S=new Date(E.updatedAt).getTime();return new Date(D.updatedAt).getTime()-S}))}catch(C){console.error("EntityView: Failed to load children:",C),t(1,u=[])}}catch(k){console.error("EntityView: Failed to load entity:",k),k.status===404||(w=k.message)!=null&&w.includes("not found")||(x=k.message)!=null&&x.includes("Entity not found")?t(3,h=`Page not found: ${g}`):k.status===403?t(3,h="You do not have permission to view this page"):k.message==="Failed to fetch"||k.code==="ECONNREFUSED"?t(3,h="Server unavailable"):t(3,h=k.message||"Failed to load page"),t(0,c=null),t(1,u=[])}finally{t(2,f=!1),t(8,d=null)}}}async function _(g){const{title:w,content:x}=g.detail;if(!(!i||!c||!w.trim()))try{await Be.createPost({title:w.trim(),content:x.trim(),parentId:c.id,sponsorId:i.id,auth:i.id}),await m(o)}catch(k){console.error("Failed to create post:",k)}}return r.$$set=g=>{"path"in g&&t(5,s=g.path),"wildcard"in g&&t(6,a=g.wildcard)},r.$$.update=()=>{var g;if(r.$$.dirty&2048&&t(10,n=((g=l.routing)==null?void 0:g.mode)||"query"),r.$$.dirty&2017){const w=n==="query"?s:a||"/";w!==o?(t(7,o=w),t(9,p=!1),m(o)):o&&!d&&!c&&!p&&m(o)}},[c,u,f,h,_,s,a,o,d,p,n,l]}class Nt extends fe{constructor(e){super(),he(this,e,ka,va,de,{path:5,wildcard:6})}}function xa(r){let e,t,n,i,l,s,a,o,c,u,f,h;return{c(){e=v("div"),t=v("h1"),t.textContent="Login",n=R(),i=v("form"),l=v("div"),s=v("label"),s.textContent="Username",a=R(),o=v("input"),c=R(),u=v("button"),u.textContent="Enter",y(t,"class","text-xs uppercase tracking-wider mb-8"),y(s,"for","username"),y(s,"class","block text-xs text-white/60 mb-1"),y(o,"id","username"),y(o,"type","text"),y(o,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm focus:outline-none focus:border-white"),y(o,"placeholder","enter username"),y(u,"type","submit"),y(u,"class","border border-white/20 px-4 py-1 text-xs uppercase tracking-wider hover:bg-white hover:text-black transition-colors"),y(i,"class","space-y-4"),y(e,"class","max-w-sm")},m(d,p){T(d,e,p),b(e,t),b(e,n),b(e,i),b(i,l),b(l,s),b(l,a),b(l,o),W(o,r[0]),b(i,c),b(i,u),f||(h=[ee(o,"input",r[2]),ee(i,"submit",r[1])],f=!0)},p(d,[p]){p&1&&o.value!==d[0]&&W(o,d[0])},i:H,o:H,d(d){d&&I(e),f=!1,St(h)}}}function $a(r,e,t){let n="";async function i(s){s.preventDefault(),n.trim()&&(await xt.login(n.trim()),_n("/"))}function l(){n=this.value,t(0,n)}return[n,i,l]}class qs extends fe{constructor(e){super(),he(this,e,$a,xa,de,{})}}function Ea(r){let e,t,n,i,l;return{c(){e=v("button"),t=K(r[1]),y(e,"class",n="pb-2 text-xs uppercase tracking-wider "+(r[0]?"border-b border-white":"text-white/60 hover:text-white"))},m(s,a){T(s,e,a),b(e,t),i||(l=ee(e,"click",r[2]),i=!0)},p(s,[a]){a&2&&G(t,s[1]),a&1&&n!==(n="pb-2 text-xs uppercase tracking-wider "+(s[0]?"border-b border-white":"text-white/60 hover:text-white"))&&y(e,"class",n)},i:H,o:H,d(s){s&&I(e),i=!1,l()}}}function Sa(r,e,t){let{active:n=!1}=e,{label:i}=e;function l(s){Zs.call(this,r,s)}return r.$$set=s=>{"active"in s&&t(0,n=s.active),"label"in s&&t(1,i=s.label)},[n,i,l]}class Un extends fe{constructor(e){super(),he(this,e,Sa,Ea,de,{active:0,label:1})}}function Ca(r){const e=new Map,t=new Set,n=[];return r.forEach(i=>{e.set(i.id,{...i,children:[]})}),r.forEach(i=>{const l=e.get(i.id);if(i.parentId){const s=e.get(i.parentId);s?s.children.push(l):t.has(i.id)||(t.add(i.id),n.push(l))}else t.has(i.id)||(t.add(i.id),n.push(l))}),n.sort((i,l)=>{const s=i.slug||i.id,a=l.slug||l.id;return s.localeCompare(a)}),n}function Pa(r){let e,t,n,i,l,s,a,o,c,u,f,h,d,p,m;return{c(){e=v("div"),t=v("input"),n=R(),i=v("select"),l=v("option"),l.textContent="All Types",s=v("option"),s.textContent="Post",a=v("option"),a.textContent="Group",o=v("option"),o.textContent="Party",c=v("option"),c.textContent="Place",u=v("option"),u.textContent="Thing",f=v("option"),f.textContent="Agent",h=R(),d=v("button"),d.textContent="Search",y(t,"type","text"),y(t,"placeholder","Search by slug..."),y(t,"class","bg-black border border-white/20 px-2 py-1 text-xs"),l.__value="",W(l,l.__value),s.__value="post",W(s,s.__value),a.__value="group",W(a,a.__value),o.__value="party",W(o,o.__value),c.__value="place",W(c,c.__value),u.__value="thing",W(u,u.__value),f.__value="agent",W(f,f.__value),y(i,"class","bg-black border border-white/20 px-2 py-1 text-xs"),r[1]===void 0&&ts(()=>r[6].call(i)),y(d,"class","border border-white/20 px-3 py-1 text-xs uppercase tracking-wider hover:bg-white hover:text-black"),y(e,"class","flex gap-4 mb-4")},m(_,g){T(_,e,g),b(e,t),W(t,r[0]),b(e,n),b(e,i),b(i,l),b(i,s),b(i,a),b(i,o),b(i,c),b(i,u),b(i,f),bn(i,r[1],!0),b(e,h),b(e,d),p||(m=[ee(t,"input",r[4]),ee(t,"keydown",r[5]),ee(i,"change",r[6]),ee(i,"change",r[3]),ee(d,"click",r[2])],p=!0)},p(_,[g]){g&1&&t.value!==_[0]&&W(t,_[0]),g&2&&bn(i,_[1])},i:H,o:H,d(_){_&&I(e),p=!1,St(m)}}}function Ia(r,e,t){let{searchQuery:n=""}=e,{typeFilter:i=""}=e;const l=Ke();function s(){l("search")}function a(){l("typeChange")}function o(){n=this.value,t(0,n)}const c=f=>f.key==="Enter"&&s();function u(){i=ns(this),t(1,i)}return r.$$set=f=>{"searchQuery"in f&&t(0,n=f.searchQuery),"typeFilter"in f&&t(1,i=f.typeFilter)},[n,i,s,a,o,c,u]}class Ta extends fe{constructor(e){super(),he(this,e,Ia,Pa,de,{searchQuery:0,typeFilter:1})}}function Ni(r){let e,t,n=r[0].title+"",i;return{c(){e=v("div"),t=K("Title: "),i=K(n),y(e,"class","text-white/80")},m(l,s){T(l,e,s),b(e,t),b(e,i)},p(l,s){s&1&&n!==(n=l[0].title+"")&&G(i,n)},d(l){l&&I(e)}}}function qi(r){let e,t,n=r[0].parentId+"",i;return{c(){e=v("div"),t=K("Parent: "),i=K(n),y(e,"class","text-white/60 text-xs")},m(l,s){T(l,e,s),b(e,t),b(e,i)},p(l,s){s&1&&n!==(n=l[0].parentId+"")&&G(i,n)},d(l){l&&I(e)}}}function Aa(r){let e,t,n,i,l,s=r[0].type+"",a,o,c,u,f=(r[0].slug||r[0].id)+"",h,d,p,m,_,g,w=r[0].id+"",x,k,$,C,E=new Date(r[0].createdAt).toLocaleString()+"",D,S,L,O,M,Z,Y,ce,ae=r[0].title&&Ni(r),V=r[3]&&r[0].parentId&&qi(r);return{c(){e=v("div"),t=v("div"),n=v("div"),i=v("span"),l=K("["),a=K(s),o=K("]"),c=R(),u=v("span"),h=K(f),d=R(),ae&&ae.c(),p=R(),V&&V.c(),m=R(),_=v("div"),g=K("ID: "),x=K(w),k=R(),$=v("div"),C=K("Created: "),D=K(E),S=R(),L=v("div"),O=v("button"),O.textContent="Edit",M=R(),Z=v("button"),Z.textContent="Delete",y(i,"class","text-white/60"),y(u,"class","font-mono"),y(n,"class","flex items-baseline gap-2 mb-1"),y(_,"class","text-white/60 text-xs mt-1"),y($,"class","text-white/60 text-xs"),y(t,"class","flex-1"),y(O,"class","text-blue-500 hover:text-blue-400"),y(Z,"class","text-red-500 hover:text-red-400"),y(L,"class","flex gap-2"),y(e,"class","flex justify-between items-start")},m(X,me){T(X,e,me),b(e,t),b(t,n),b(n,i),b(i,l),b(i,a),b(i,o),b(n,c),b(n,u),b(u,h),b(t,d),ae&&ae.m(t,null),b(t,p),V&&V.m(t,null),b(t,m),b(t,_),b(_,g),b(_,x),b(t,k),b(t,$),b($,C),b($,D),b(e,S),b(e,L),b(L,O),b(L,M),b(L,Z),Y||(ce=[ee(O,"click",r[4]),ee(Z,"click",r[5])],Y=!0)},p(X,[me]){me&1&&s!==(s=X[0].type+"")&&G(a,s),me&1&&f!==(f=(X[0].slug||X[0].id)+"")&&G(h,f),X[0].title?ae?ae.p(X,me):(ae=Ni(X),ae.c(),ae.m(t,p)):ae&&(ae.d(1),ae=null),X[3]&&X[0].parentId?V?V.p(X,me):(V=qi(X),V.c(),V.m(t,m)):V&&(V.d(1),V=null),me&1&&w!==(w=X[0].id+"")&&G(x,w),me&1&&E!==(E=new Date(X[0].createdAt).toLocaleString()+"")&&G(D,E)},i:H,o:H,d(X){X&&I(e),ae&&ae.d(),V&&V.d(),Y=!1,St(ce)}}}function Da(r,e,t){let{entity:n}=e,{onEdit:i}=e,{onDelete:l}=e,{showParent:s=!0}=e;const a=()=>i(n),o=()=>l(n.id);return r.$$set=c=>{"entity"in c&&t(0,n=c.entity),"onEdit"in c&&t(1,i=c.onEdit),"onDelete"in c&&t(2,l=c.onDelete),"showParent"in c&&t(3,s=c.showParent)},[n,i,l,s,a,o]}class Ms extends fe{constructor(e){super(),he(this,e,Da,Aa,de,{entity:0,onEdit:1,onDelete:2,showParent:3})}}function Mi(r,e,t){const n=r.slice();return n[9]=e[t],n}function zi(r){let e,t=r[2]?"▼":"▶",n,i,l;return{c(){e=v("button"),n=K(t),y(e,"class","text-white/60 hover:text-white mt-1")},m(s,a){T(s,e,a),b(e,n),i||(l=ee(e,"click",r[8]),i=!0)},p(s,a){a&4&&t!==(t=s[2]?"▼":"▶")&&G(n,t)},d(s){s&&I(e),i=!1,l()}}}function Ui(r){let e,t,n=ve(r[0].children),i=[];for(let s=0;s<n.length;s+=1)i[s]=Qi(Mi(r,n,s));const l=s=>A(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ie()},m(s,a){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(s,a);T(s,e,a),t=!0},p(s,a){if(a&123){n=ve(s[0].children);let o;for(o=0;o<n.length;o+=1){const c=Mi(s,n,o);i[o]?(i[o].p(c,a),P(i[o],1)):(i[o]=Qi(c),i[o].c(),P(i[o],1),i[o].m(e.parentNode,e))}for(se(),o=n.length;o<i.length;o+=1)l(o);le()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)P(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)A(i[a]);t=!1},d(s){s&&I(e),rt(i,s)}}}function Qi(r){let e,t;return e=new zs({props:{entity:r[9],level:r[1]+1,expanded:r[3].has(r[9].id),expandedNodes:r[3],onToggle:r[4],onEdit:r[5],onDelete:r[6]}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1&&(l.entity=n[9]),i&2&&(l.level=n[1]+1),i&9&&(l.expanded=n[3].has(n[9].id)),i&8&&(l.expandedNodes=n[3]),i&16&&(l.onToggle=n[4]),i&32&&(l.onEdit=n[5]),i&64&&(l.onDelete=n[6]),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function Ra(r){let e,t,n,i,l,s,a,o,c=r[7]&&zi(r);s=new Ms({props:{entity:r[0],onEdit:r[5],onDelete:r[6],showParent:!1}});let u=r[7]&&r[2]&&Ui(r);return{c(){e=v("div"),t=v("div"),n=v("div"),c&&c.c(),i=R(),l=v("div"),Q(s.$$.fragment),a=R(),u&&u.c(),y(l,"class","flex-1"),y(n,"class","flex items-start gap-2"),y(t,"class","border border-white/20 p-3 text-xs hover:bg-white/5"),qr(t,"margin-left",r[1]*20+"px")},m(f,h){T(f,e,h),b(e,t),b(t,n),c&&c.m(n,null),b(n,i),b(n,l),U(s,l,null),b(e,a),u&&u.m(e,null),o=!0},p(f,[h]){f[7]?c?c.p(f,h):(c=zi(f),c.c(),c.m(n,i)):c&&(c.d(1),c=null);const d={};h&1&&(d.entity=f[0]),h&32&&(d.onEdit=f[5]),h&64&&(d.onDelete=f[6]),s.$set(d),(!o||h&2)&&qr(t,"margin-left",f[1]*20+"px"),f[7]&&f[2]?u?(u.p(f,h),h&132&&P(u,1)):(u=Ui(f),u.c(),P(u,1),u.m(e,null)):u&&(se(),A(u,1,1,()=>{u=null}),le())},i(f){o||(P(s.$$.fragment,f),P(u),o=!0)},o(f){A(s.$$.fragment,f),A(u),o=!1},d(f){f&&I(e),c&&c.d(),z(s),u&&u.d()}}}function Oa(r,e,t){let n,{entity:i}=e,{level:l=0}=e,{expanded:s=!1}=e,{expandedNodes:a}=e,{onToggle:o}=e,{onEdit:c}=e,{onDelete:u}=e;const f=()=>o(i.id);return r.$$set=h=>{"entity"in h&&t(0,i=h.entity),"level"in h&&t(1,l=h.level),"expanded"in h&&t(2,s=h.expanded),"expandedNodes"in h&&t(3,a=h.expandedNodes),"onToggle"in h&&t(4,o=h.onToggle),"onEdit"in h&&t(5,c=h.onEdit),"onDelete"in h&&t(6,u=h.onDelete)},r.$$.update=()=>{r.$$.dirty&1&&t(7,n=i.children&&i.children.length>0)},[i,l,s,a,o,c,u,n,f]}class zs extends fe{constructor(e){super(),he(this,e,Oa,Ra,de,{entity:0,level:1,expanded:2,expandedNodes:3,onToggle:4,onEdit:5,onDelete:6})}}function ja(r){let e,t,n,i,l,s,a,o,c,u,f,h,d,p,m,_,g,w,x,k,$,C,E,D,S,L;return{c(){e=v("div"),t=v("div"),n=v("h3"),n.textContent="Edit Entity",i=R(),l=v("div"),s=v("div"),a=v("label"),a.textContent="Slug",o=R(),c=v("input"),u=R(),f=v("div"),h=v("label"),h.textContent="Title",d=R(),p=v("input"),m=R(),_=v("div"),g=v("label"),g.textContent="Content",w=R(),x=v("textarea"),k=R(),$=v("div"),C=v("button"),C.textContent="Save",E=R(),D=v("button"),D.textContent="Cancel",y(n,"class","text-xs uppercase tracking-wider mb-4"),y(a,"for","edit-entity-slug"),y(a,"class","block text-xs text-white/60 mb-1"),y(c,"id","edit-entity-slug"),y(c,"type","text"),y(c,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),y(h,"for","edit-entity-title"),y(h,"class","block text-xs text-white/60 mb-1"),y(p,"id","edit-entity-title"),y(p,"type","text"),y(p,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),y(g,"for","edit-entity-content"),y(g,"class","block text-xs text-white/60 mb-1"),y(x,"id","edit-entity-content"),y(x,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),y(x,"rows","4"),y(C,"class","border border-white/20 px-3 py-1 text-xs uppercase tracking-wider hover:bg-white hover:text-black"),y(D,"class","text-xs uppercase tracking-wider text-white/60 hover:text-white"),y($,"class","flex gap-2"),y(l,"class","space-y-4"),y(t,"class","bg-black border border-white/20 p-6 max-w-md w-full"),y(e,"class","fixed inset-0 bg-black/80 flex items-center justify-center p-4")},m(O,M){T(O,e,M),b(e,t),b(t,n),b(t,i),b(t,l),b(l,s),b(s,a),b(s,o),b(s,c),W(c,r[0]),b(l,u),b(l,f),b(f,h),b(f,d),b(f,p),W(p,r[1]),b(l,m),b(l,_),b(_,g),b(_,w),b(_,x),W(x,r[2]),b(l,k),b(l,$),b($,C),b($,E),b($,D),S||(L=[ee(c,"input",r[6]),ee(p,"input",r[7]),ee(x,"input",r[8]),ee(C,"click",r[3]),ee(D,"click",r[4])],S=!0)},p(O,[M]){M&1&&c.value!==O[0]&&W(c,O[0]),M&2&&p.value!==O[1]&&W(p,O[1]),M&4&&W(x,O[2])},i:H,o:H,d(O){O&&I(e),S=!1,St(L)}}}function Fa(r,e,t){let{entity:n}=e;const i=Ke();let l=n.slug||"",s=n.title||"",a=n.content||"";function o(){i("save",{...n,slug:l,title:s,content:a})}function c(){i("cancel")}function u(){l=this.value,t(0,l)}function f(){s=this.value,t(1,s)}function h(){a=this.value,t(2,a)}return r.$$set=d=>{"entity"in d&&t(5,n=d.entity)},[l,s,a,o,c,n,u,f,h]}class La extends fe{constructor(e){super(),he(this,e,Fa,ja,de,{entity:5})}}function Hi(r,e,t){const n=r.slice();return n[16]=e[t],n}function Wi(r,e,t){const n=r.slice();return n[16]=e[t],n}function Ba(r){let e,t,n=r[1].length+"",i,l,s,a,o,c;const u=[qa,Na],f=[];function h(d,p){return d[4]||d[5]?0:1}return a=h(r),o=f[a]=u[a](r),{c(){e=v("div"),t=K("Total entities: "),i=K(n),l=R(),s=v("div"),o.c(),y(e,"class","text-xs text-white/40 mb-4"),y(s,"class","space-y-1")},m(d,p){T(d,e,p),b(e,t),b(e,i),T(d,l,p),T(d,s,p),f[a].m(s,null),c=!0},p(d,p){(!c||p&2)&&n!==(n=d[1].length+"")&&G(i,n);let m=a;a=h(d),a===m?f[a].p(d,p):(se(),A(f[m],1,1,()=>{f[m]=null}),le(),o=f[a],o?o.p(d,p):(o=f[a]=u[a](d),o.c()),P(o,1),o.m(s,null))},i(d){c||(P(o),c=!0)},o(d){A(o),c=!1},d(d){d&&(I(e),I(l),I(s)),f[a].d()}}}function Ka(r){let e;return{c(){e=v("div"),e.textContent="Loading...",y(e,"class","text-xs text-white/60")},m(t,n){T(t,e,n)},p:H,i:H,o:H,d(t){t&&I(e)}}}function Na(r){let e,t,n=ve(r[2]),i=[];for(let s=0;s<n.length;s+=1)i[s]=Vi(Hi(r,n,s));const l=s=>A(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ie()},m(s,a){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(s,a);T(s,e,a),t=!0},p(s,a){if(a&964){n=ve(s[2]);let o;for(o=0;o<n.length;o+=1){const c=Hi(s,n,o);i[o]?(i[o].p(c,a),P(i[o],1)):(i[o]=Vi(c),i[o].c(),P(i[o],1),i[o].m(e.parentNode,e))}for(se(),o=n.length;o<i.length;o+=1)l(o);le()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)P(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)A(i[a]);t=!1},d(s){s&&I(e),rt(i,s)}}}function qa(r){let e,t,n=ve(r[1]),i=[];for(let s=0;s<n.length;s+=1)i[s]=Gi(Wi(r,n,s));const l=s=>A(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ie()},m(s,a){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(s,a);T(s,e,a),t=!0},p(s,a){if(a&578){n=ve(s[1]);let o;for(o=0;o<n.length;o+=1){const c=Wi(s,n,o);i[o]?(i[o].p(c,a),P(i[o],1)):(i[o]=Gi(c),i[o].c(),P(i[o],1),i[o].m(e.parentNode,e))}for(se(),o=n.length;o<i.length;o+=1)l(o);le()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)P(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)A(i[a]);t=!1},d(s){s&&I(e),rt(i,s)}}}function Vi(r){let e,t;return e=new zs({props:{entity:r[16],expanded:r[7].has(r[16].id),expandedNodes:r[7],onToggle:r[8],onEdit:r[14],onDelete:r[9]}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&4&&(l.entity=n[16]),i&132&&(l.expanded=n[7].has(n[16].id)),i&128&&(l.expandedNodes=n[7]),i&64&&(l.onEdit=n[14]),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function Gi(r){let e,t,n,i;return t=new Ms({props:{entity:r[16],onEdit:r[13],onDelete:r[9]}}),{c(){e=v("div"),Q(t.$$.fragment),n=R(),y(e,"class","border border-white/20 p-3 text-xs")},m(l,s){T(l,e,s),U(t,e,null),b(e,n),i=!0},p(l,s){const a={};s&2&&(a.entity=l[16]),s&64&&(a.onEdit=l[13]),t.$set(a)},i(l){i||(P(t.$$.fragment,l),i=!0)},o(l){A(t.$$.fragment,l),i=!1},d(l){l&&I(e),z(t)}}}function Zi(r){let e,t;return e=new La({props:{entity:r[6]}}),e.$on("save",r[10]),e.$on("cancel",r[15]),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&64&&(l.entity=n[6]),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function Ma(r){let e,t,n,i,l,s,a,o,c;function u(g){r[11](g)}function f(g){r[12](g)}let h={};r[4]!==void 0&&(h.searchQuery=r[4]),r[5]!==void 0&&(h.typeFilter=r[5]),t=new Ta({props:h}),yn.push(()=>Mr(t,"searchQuery",u)),yn.push(()=>Mr(t,"typeFilter",f)),t.$on("search",r[0]),t.$on("typeChange",r[0]);const d=[Ka,Ba],p=[];function m(g,w){return g[3]?0:1}s=m(r),a=p[s]=d[s](r);let _=r[6]&&Zi(r);return{c(){e=v("div"),Q(t.$$.fragment),l=R(),a.c(),o=R(),_&&_.c()},m(g,w){T(g,e,w),U(t,e,null),b(e,l),p[s].m(e,null),b(e,o),_&&_.m(e,null),c=!0},p(g,[w]){const x={};!n&&w&16&&(n=!0,x.searchQuery=g[4],zr(()=>n=!1)),!i&&w&32&&(i=!0,x.typeFilter=g[5],zr(()=>i=!1)),t.$set(x);let k=s;s=m(g),s===k?p[s].p(g,w):(se(),A(p[k],1,1,()=>{p[k]=null}),le(),a=p[s],a?a.p(g,w):(a=p[s]=d[s](g),a.c()),P(a,1),a.m(e,o)),g[6]?_?(_.p(g,w),w&64&&P(_,1)):(_=Zi(g),_.c(),P(_,1),_.m(e,null)):_&&(se(),A(_,1,1,()=>{_=null}),le())},i(g){c||(P(t.$$.fragment,g),P(a),P(_),c=!0)},o(g){A(t.$$.fragment,g),A(a),A(_),c=!1},d(g){g&&I(e),z(t),p[s].d(),_&&_.d()}}}function za(r,e,t){let n=[],i=[],l=!1,s="",a="",o=null,c=new Set;rs(async()=>{console.log("EntitiesTab: Waiting for API client initialization..."),await Or.init(),console.log("EntitiesTab: API client initialized, loading entities..."),await u()});async function u(){t(3,l=!0);try{console.log("EntitiesTab: Loading entities with filters:",{typeFilter:a,searchQuery:s});const x={limit:1e3};a&&(x.type=a),s&&(x.slugPrefix=s);const k=await Be.queryEntities(x);console.log("EntitiesTab: Received entities:",k),t(1,n=k||[]),console.log("EntitiesTab: Total entities:",n.length);const $=Array.from(new Map(n.map(C=>[C.id,C])).values());console.log("EntitiesTab: Unique entities after dedup:",$.length),t(2,i=Ca($)),console.log("EntitiesTab: Tree built with",i.length,"root nodes")}catch(x){console.error("EntitiesTab: Failed to load entities:",x),t(1,n=[]),t(2,i=[])}finally{t(3,l=!1)}}function f(x){c.has(x)?c.delete(x):c.add(x),t(7,c)}async function h(x){if(confirm("Are you sure you want to delete this entity?"))try{await Be.deleteEntity(x),await u()}catch(k){console.error("Failed to delete entity:",k),alert("Failed to delete entity")}}async function d(x){const k=x.detail;try{await Be.updateEntity(k.id,{title:k.title,content:k.content,slug:k.slug}),t(6,o=null),await u()}catch($){console.error("Failed to update entity:",$),alert("Failed to update entity")}}function p(x){s=x,t(4,s)}function m(x){a=x,t(5,a)}return[u,n,i,l,s,a,o,c,f,h,d,p,m,x=>t(6,o=x),x=>t(6,o=x),()=>t(6,o=null)]}class Ua extends fe{constructor(e){super(),he(this,e,za,Ma,de,{loadEntities:0})}get loadEntities(){return this.$$.ctx[0]}}function Qa(r){let e,t,n,i,l,s,a,o,c,u,f,h,d,p,m,_,g,w,x,k,$,C,E,D,S,L,O,M,Z,Y,ce,ae,V,X,me,$e,Lr,It,jn,Br;return{c(){e=v("form"),t=v("div"),n=v("label"),n.textContent="Type",i=R(),l=v("select"),s=v("option"),s.textContent="Post",a=v("option"),a.textContent="Group",o=v("option"),o.textContent="Party (User)",c=v("option"),c.textContent="Place",u=v("option"),u.textContent="Thing",f=v("option"),f.textContent="Agent",h=R(),d=v("div"),p=v("label"),p.textContent="Slug (optional)",m=R(),_=v("input"),g=R(),w=v("div"),x=v("label"),x.textContent="Title",k=R(),$=v("input"),C=R(),E=v("div"),D=v("label"),D.textContent="Content",S=R(),L=v("textarea"),O=R(),M=v("div"),Z=v("label"),Z.textContent="Parent ID (optional)",Y=R(),ce=v("input"),ae=R(),V=v("div"),X=v("label"),X.textContent="Sponsor ID (optional)",me=R(),$e=v("input"),Lr=R(),It=v("button"),It.textContent="Create Entity",y(n,"for","entity-type"),y(n,"class","block text-xs text-white/60 mb-1"),s.__value="post",W(s,s.__value),a.__value="group",W(a,a.__value),o.__value="party",W(o,o.__value),c.__value="place",W(c,c.__value),u.__value="thing",W(u,u.__value),f.__value="agent",W(f,f.__value),y(l,"id","entity-type"),y(l,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),r[0]===void 0&&ts(()=>r[7].call(l)),y(p,"for","entity-slug"),y(p,"class","block text-xs text-white/60 mb-1"),y(_,"id","entity-slug"),y(_,"type","text"),y(_,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),y(_,"placeholder","unique-identifier"),y(x,"for","entity-title"),y(x,"class","block text-xs text-white/60 mb-1"),y($,"id","entity-title"),y($,"type","text"),y($,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),$.required=!0,y(D,"for","entity-content"),y(D,"class","block text-xs text-white/60 mb-1"),y(L,"id","entity-content"),y(L,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),y(L,"rows","4"),y(Z,"for","entity-parent-id"),y(Z,"class","block text-xs text-white/60 mb-1"),y(ce,"id","entity-parent-id"),y(ce,"type","text"),y(ce,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),y(ce,"placeholder","parent-entity-id"),y(X,"for","entity-sponsor-id"),y(X,"class","block text-xs text-white/60 mb-1"),y($e,"id","entity-sponsor-id"),y($e,"type","text"),y($e,"class","w-full bg-black border border-white/20 px-2 py-1 text-sm"),y($e,"placeholder","sponsor-entity-id"),y(It,"type","submit"),y(It,"class","border border-white/20 px-4 py-1 text-xs uppercase tracking-wider hover:bg-white hover:text-black"),y(e,"class","max-w-md space-y-4")},m(Ee,Ve){T(Ee,e,Ve),b(e,t),b(t,n),b(t,i),b(t,l),b(l,s),b(l,a),b(l,o),b(l,c),b(l,u),b(l,f),bn(l,r[0],!0),b(e,h),b(e,d),b(d,p),b(d,m),b(d,_),W(_,r[1]),b(e,g),b(e,w),b(w,x),b(w,k),b(w,$),W($,r[2]),b(e,C),b(e,E),b(E,D),b(E,S),b(E,L),W(L,r[3]),b(e,O),b(e,M),b(M,Z),b(M,Y),b(M,ce),W(ce,r[4]),b(e,ae),b(e,V),b(V,X),b(V,me),b(V,$e),W($e,r[5]),b(e,Lr),b(e,It),jn||(Br=[ee(l,"change",r[7]),ee(_,"input",r[8]),ee($,"input",r[9]),ee(L,"input",r[10]),ee(ce,"input",r[11]),ee($e,"input",r[12]),ee(e,"submit",r[6])],jn=!0)},p(Ee,[Ve]){Ve&1&&bn(l,Ee[0]),Ve&2&&_.value!==Ee[1]&&W(_,Ee[1]),Ve&4&&$.value!==Ee[2]&&W($,Ee[2]),Ve&8&&W(L,Ee[3]),Ve&16&&ce.value!==Ee[4]&&W(ce,Ee[4]),Ve&32&&$e.value!==Ee[5]&&W($e,Ee[5])},i:H,o:H,d(Ee){Ee&&I(e),jn=!1,St(Br)}}}function Ha(r,e,t){let{type:n="post"}=e,{slug:i=""}=e,{title:l=""}=e,{content:s=""}=e,{parentId:a=""}=e,{sponsorId:o=""}=e;const c=Ke();function u(g){g.preventDefault(),c("submit",{type:n,slug:i,title:l,content:s,parentId:a,sponsorId:o})}function f(){n=ns(this),t(0,n)}function h(){i=this.value,t(1,i)}function d(){l=this.value,t(2,l)}function p(){s=this.value,t(3,s)}function m(){a=this.value,t(4,a)}function _(){o=this.value,t(5,o)}return r.$$set=g=>{"type"in g&&t(0,n=g.type),"slug"in g&&t(1,i=g.slug),"title"in g&&t(2,l=g.title),"content"in g&&t(3,s=g.content),"parentId"in g&&t(4,a=g.parentId),"sponsorId"in g&&t(5,o=g.sponsorId)},[n,i,l,s,a,o,u,f,h,d,p,m,_]}class Wa extends fe{constructor(e){super(),he(this,e,Ha,Qa,de,{type:0,slug:1,title:2,content:3,parentId:4,sponsorId:5})}}function Va(r){let e,t;return e=new Wa({}),e.$on("submit",r[0]),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p:H,i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function Ga(r,e,t){let n;Le(r,xt,s=>t(1,n=s));const i=Ke();async function l(s){const a=s.detail;try{const o={title:a.title,content:a.content,auth:n==null?void 0:n.id};a.slug&&(o.slug=a.slug),a.parentId&&(o.parentId=a.parentId),a.sponsorId&&(o.sponsorId=a.sponsorId),a.type==="group"?await Be.createGroup(o):a.type==="party"?await Be.createUser(o):await Be.createPost(o),i("created")}catch(o){console.error("Failed to create entity:",o),alert("Failed to create entity: "+o.message)}}return[l]}class Za extends fe{constructor(e){super(),he(this,e,Ga,Va,de,{})}}function Yi(r,e,t){const n=r.slice();return n[3]=e[t][0],n[4]=e[t][1],n}function Ya(r){let e,t,n,i,l,s=r[1].totalEntities+"",a,o,c,u,f,h,d=ve(Object.entries(r[1].byType)),p=[];for(let m=0;m<d.length;m+=1)p[m]=Ji(Yi(r,d,m));return{c(){e=v("div"),t=v("div"),n=v("h3"),n.textContent="Total Entities",i=R(),l=v("div"),a=K(s),o=R(),c=v("div"),u=v("h3"),u.textContent="By Type",f=R(),h=v("div");for(let m=0;m<p.length;m+=1)p[m].c();y(n,"class","text-xs uppercase tracking-wider mb-2"),y(l,"class","text-2xl"),y(t,"class","border border-white/20 p-4"),y(u,"class","text-xs uppercase tracking-wider mb-2"),y(h,"class","space-y-1"),y(c,"class","border border-white/20 p-4"),y(e,"class","space-y-4")},m(m,_){T(m,e,_),b(e,t),b(t,n),b(t,i),b(t,l),b(l,a),b(e,o),b(e,c),b(c,u),b(c,f),b(c,h);for(let g=0;g<p.length;g+=1)p[g]&&p[g].m(h,null)},p(m,_){if(_&2&&s!==(s=m[1].totalEntities+"")&&G(a,s),_&2){d=ve(Object.entries(m[1].byType));let g;for(g=0;g<d.length;g+=1){const w=Yi(m,d,g);p[g]?p[g].p(w,_):(p[g]=Ji(w),p[g].c(),p[g].m(h,null))}for(;g<p.length;g+=1)p[g].d(1);p.length=d.length}},d(m){m&&I(e),rt(p,m)}}}function Ja(r){let e;return{c(){e=v("div"),e.textContent="Loading...",y(e,"class","text-xs text-white/60")},m(t,n){T(t,e,n)},p:H,d(t){t&&I(e)}}}function Ji(r){let e,t,n=r[3]+"",i,l,s,a=r[4]+"",o,c;return{c(){e=v("div"),t=v("span"),i=K(n),l=R(),s=v("span"),o=K(a),c=R(),y(t,"class","text-white/60"),y(e,"class","flex justify-between text-sm")},m(u,f){T(u,e,f),b(e,t),b(t,i),b(e,l),b(e,s),b(s,o),b(e,c)},p(u,f){f&2&&n!==(n=u[3]+"")&&G(i,n),f&2&&a!==(a=u[4]+"")&&G(o,a)},d(u){u&&I(e)}}}function Xa(r){let e;function t(l,s){if(l[0])return Ja;if(l[1])return Ya}let n=t(r),i=n&&n(r);return{c(){e=v("div"),i&&i.c()},m(l,s){T(l,e,s),i&&i.m(e,null)},p(l,[s]){n===(n=t(l))&&i?i.p(l,s):(i&&i.d(1),i=n&&n(l),i&&(i.c(),i.m(e,null)))},i:H,o:H,d(l){l&&I(e),i&&i.d()}}}function eu(r,e,t){let n=!1,i=null;async function l(){t(0,n=!0);try{const s=await Be.queryEntities({limit:1e3}),a={};s.forEach(o=>{a[o.type]=(a[o.type]||0)+1}),t(1,i={totalEntities:s.length,byType:a})}catch(s){console.error("Failed to load stats:",s)}finally{t(0,n=!1)}}return[n,i,l]}class tu extends fe{constructor(e){super(),he(this,e,eu,Xa,de,{loadStats:2})}get loadStats(){return this.$$.ctx[2]}}function nu(r){let e,t,n={};return e=new tu({props:n}),r[10](e),{c(){Q(e.$$.fragment)},m(i,l){U(e,i,l),t=!0},p(i,l){const s={};e.$set(s)},i(i){t||(P(e.$$.fragment,i),t=!0)},o(i){A(e.$$.fragment,i),t=!1},d(i){r[10](null),z(e,i)}}}function ru(r){let e,t;return e=new Za({}),e.$on("created",r[5]),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p:H,i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function iu(r){let e,t,n={};return e=new Ua({props:n}),r[9](e),{c(){Q(e.$$.fragment)},m(i,l){U(e,i,l),t=!0},p(i,l){const s={};e.$set(s)},i(i){t||(P(e.$$.fragment,i),t=!0)},o(i){A(e.$$.fragment,i),t=!1},d(i){r[9](null),z(e,i)}}}function su(r){let e,t,n,i,l,s,a,o,c,u,f,h,d,p,m,_;o=new Un({props:{active:r[0]==="entities",label:"Entities"}}),o.$on("click",r[6]),u=new Un({props:{active:r[0]==="create",label:"Create"}}),u.$on("click",r[7]),h=new Un({props:{active:r[0]==="stats",label:"Stats"}}),h.$on("click",r[8]);const g=[iu,ru,nu],w=[];function x(k,$){return k[0]==="entities"?0:k[0]==="create"?1:k[0]==="stats"?2:-1}return~(p=x(r))&&(m=w[p]=g[p](r)),{c(){e=v("div"),t=v("div"),n=v("h1"),n.textContent="Admin Panel",i=R(),l=v("div"),l.textContent=`Build: ${r[4]} (${r[3]})`,s=R(),a=v("div"),Q(o.$$.fragment),c=R(),Q(u.$$.fragment),f=R(),Q(h.$$.fragment),d=R(),m&&m.c(),y(n,"class","text-xs uppercase tracking-wider"),y(l,"class","text-xs text-white/40"),y(t,"class","flex items-baseline justify-between mb-6"),y(a,"class","flex gap-4 mb-6 border-b border-white/20")},m(k,$){T(k,e,$),b(e,t),b(t,n),b(t,i),b(t,l),b(e,s),b(e,a),U(o,a,null),b(a,c),U(u,a,null),b(a,f),U(h,a,null),b(e,d),~p&&w[p].m(e,null),_=!0},p(k,[$]){const C={};$&1&&(C.active=k[0]==="entities"),o.$set(C);const E={};$&1&&(E.active=k[0]==="create"),u.$set(E);const D={};$&1&&(D.active=k[0]==="stats"),h.$set(D);let S=p;p=x(k),p===S?~p&&w[p].p(k,$):(m&&(se(),A(w[S],1,1,()=>{w[S]=null}),le()),~p?(m=w[p],m?m.p(k,$):(m=w[p]=g[p](k),m.c()),P(m,1),m.m(e,null)):m=null)},i(k){_||(P(o.$$.fragment,k),P(u.$$.fragment,k),P(h.$$.fragment,k),P(m),_=!0)},o(k){A(o.$$.fragment,k),A(u.$$.fragment,k),A(h.$$.fragment,k),A(m),_=!1},d(k){k&&I(e),z(o),z(u),z(h),~p&&w[p].d()}}}function lu(r,e,t){let n="entities",i,l;const s="2025-10-04T07:59:30.633Z",a="mgbzfm89";function o(){t(0,n="entities")}const c=()=>t(0,n="entities"),u=()=>t(0,n="create"),f=()=>t(0,n="stats");function h(p){yn[p?"unshift":"push"](()=>{i=p,t(1,i)})}function d(p){yn[p?"unshift":"push"](()=>{l=p,t(2,l)})}return r.$$.update=()=>{r.$$.dirty&7&&(n==="entities"&&i?i.loadEntities():n==="stats"&&l&&l.loadStats())},[n,i,l,s,a,o,c,u,f,h,d]}class Us extends fe{constructor(e){super(),he(this,e,lu,su,de,{})}}function ou(r){let e,t;return e=new Ys({props:{url:r[0],basePath:r[4],$$slots:{default:[cu]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1&&(l.url=n[0]),i&16&&(l.basePath=n[4]),i&1024&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function au(r){let e,t;return e=new is({props:{$$slots:{default:[fu]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1030&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function uu(r){let e,t,n,i,l,s,a,o;return e=new Xt({props:{path:"/login",component:qs}}),n=new Xt({props:{path:"/admin",component:Us}}),l=new Xt({props:{path:"/",component:Nt}}),a=new Xt({props:{path:"/*wildcard",component:Nt}}),{c(){Q(e.$$.fragment),t=R(),Q(n.$$.fragment),i=R(),Q(l.$$.fragment),s=R(),Q(a.$$.fragment)},m(c,u){U(e,c,u),T(c,t,u),U(n,c,u),T(c,i,u),U(l,c,u),T(c,s,u),U(a,c,u),o=!0},p:H,i(c){o||(P(e.$$.fragment,c),P(n.$$.fragment,c),P(l.$$.fragment,c),P(a.$$.fragment,c),o=!0)},o(c){A(e.$$.fragment,c),A(n.$$.fragment,c),A(l.$$.fragment,c),A(a.$$.fragment,c),o=!1},d(c){c&&(I(t),I(i),I(s)),z(e,c),z(n,c),z(l,c),z(a,c)}}}function cu(r){let e,t;return e=new is({props:{$$slots:{default:[uu]},$$scope:{ctx:r}}}),{c(){Q(e.$$.fragment)},m(n,i){U(e,n,i),t=!0},p(n,i){const l={};i&1024&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function fu(r){let e,t,n;const i=[r[2]];var l=r[1];function s(a,o){let c={};for(let u=0;u<i.length;u+=1)c=Wr(c,i[u]);return o!==void 0&&o&4&&(c=Wr(c,Qr(i,[Hr(a[2])]))),{props:c}}return l&&(e=Ur(l,s(r))),{c(){e&&Q(e.$$.fragment),t=Ie()},m(a,o){e&&U(e,a,o),T(a,t,o),n=!0},p(a,o){if(o&2&&l!==(l=a[1])){if(e){se();const c=e;A(c.$$.fragment,1,0,()=>{z(c,1)}),le()}l?(e=Ur(l,s(a,o)),Q(e.$$.fragment),P(e.$$.fragment,1),U(e,t.parentNode,t)):e=null}else if(l){const c=o&4?Qr(i,[Hr(a[2])]):{};e.$set(c)}},i(a){n||(e&&P(e.$$.fragment,a),n=!0)},o(a){e&&A(e.$$.fragment,a),n=!1},d(a){a&&I(t),e&&z(e,a)}}}function hu(r){let e,t,n,i;const l=[au,ou],s=[];function a(o,c){return o[3]==="query"?0:1}return e=a(r),t=s[e]=l[e](r),{c(){t.c(),n=Ie()},m(o,c){s[e].m(o,c),T(o,n,c),i=!0},p(o,[c]){let u=e;e=a(o),e===u?s[e].p(o,c):(se(),A(s[u],1,1,()=>{s[u]=null}),le(),t=s[e],t?t.p(o,c):(t=s[e]=l[e](o),t.c()),P(t,1),t.m(n.parentNode,n))},i(o){i||(P(t),i=!0)},o(o){A(t),i=!1},d(o){o&&I(n),s[e].d(o)}}}function du(r,e,t){let n,i,l,s,a,o,c;Le(r,De,d=>t(8,c=d));let{url:u=""}=e,f=Gr();function h(){const d=Gr();t(5,f=d)}return rs(()=>{if(n==="query")return window.addEventListener("popstate",h),window.addEventListener("navigate",h),()=>{window.removeEventListener("popstate",h),window.removeEventListener("navigate",h)}}),r.$$set=d=>{"url"in d&&t(0,u=d.url)},r.$$.update=()=>{var d,p;r.$$.dirty&256&&t(3,n=((d=c.routing)==null?void 0:d.mode)||"query"),r.$$.dirty&256&&t(4,i=((p=c.routing)==null?void 0:p.basePath)||""),r.$$.dirty&32&&t(7,l=f.startsWith("__INVALID__")),r.$$.dirty&160&&t(6,s=l?f.substring(11):f),r.$$.dirty&192&&t(1,a=l?Nt:s==="/login"?qs:s==="/admin"?Us:Nt),r.$$.dirty&194&&t(2,o=a===Nt?{path:s}:{})},[u,a,o,n,i,f,s,l,c]}class pu extends fe{constructor(e){super(),he(this,e,du,hu,de,{url:0})}}async function gu(){return await Or.init(),new pu({target:document.getElementById("app")})}gu();
